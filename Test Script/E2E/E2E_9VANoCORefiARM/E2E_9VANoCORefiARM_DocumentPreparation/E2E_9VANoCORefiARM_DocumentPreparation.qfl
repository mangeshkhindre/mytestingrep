''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'@defgroup E2E_9VANoCORefiARM_DocumentPreparation
'This is the function group for VANoCORefiARM_DocumentPreparation
' List of Functions here
'@code
'     Function DisclosureTrackingWeb_LoanCenter_AcceptAndeSign(strLoanNumber, strRowID)
' @endcode
'@{
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'This function returns the directory path to the RuntimeProp File
'@code
'    DisclosureTrackingWeb_LoanCenter_AcceptAndeSign(strLoanNumber, strRowID)
'@endcode
'Param strLoanNumber
'Param strRowID

Function DisclosureTrackingWeb_LoanCenter_AcceptAndeSign(strLoanNumber, strRowID)
	
    Dim objWebPage, objData, strBorrowerName, strAuthCode
    
    FRM_Logger_ReportInfoEvent "Accept consent and eSign docs", "eSign docs using Row Id '"&strRowID&"' in the eFolder_Tab datasheet", null
    k=""
    If (GUI_Object_IsExist(Browser("name:=.*Ellie Mae.*", "index:=0").Page("title:=.*Ellie Mae.*", "index:=0"))) Then 
		Set objWebPage = Browser("name:=.*Ellie Mae.*", "index:=0").Page("title:=.*Ellie Mae.*", "index:=0")
	End If
	
    If (GUI_Object_IsExist(Browser("name:=.*Mortgage.*", "index:=0").Page("title:=.*Mortgage.*", "index:=0"))) Then 
		Set objWebPage = Browser("name:=.*Mortgage.*", "index:=0").Page("title:=.*Mortgage.*", "index:=0")
	End If
    Set objData = FRM_DS_GetTestData("eFolder_Tab", "SendeDisclosures", strRowID)
    
    strBorrowerName = FRM_DS_GetValue(objData, "BorrowerName")
    
    If BIZ_DisclosureTrackingWeb_OpenLoanDetails(strBorrowerName, strLoanNumber) Then
       GUI_Link_Click objWebPage.Link("name:=eSign", "index:=0")
    	If objWebPage.Link("name:=I Agree", "index:=0").Exist(3) Then
		   GUI_Link_Click objWebPage.Link("name:=I Agree", "index:=0")
		End If	
        
		GUI_Object_WaitTillExist objWebPage.WebEdit("html id:=passwordTextBox")  
    	strAuthCode = FRM_DS_GetValue(objData, "BorrowerCode")
        
		If objWebPage.WebEdit("html id:=passwordTextBox").Exist(120) Then
		   GUI_WebEdit_Set objWebPage.WebEdit("html id:=passwordTextBox"), strAuthCode
		End If	
		GUI_Link_Click objWebPage.Link("html id:=NextButton_linkButton")
	
		If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next").Exist(60) Then  
		   Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next").Click
		End If
		wait g_TinyWaitSmall
		If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next","index:=1").Exist(60) Then  
		   Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next","index:=1").Click
		End if
		wait g_TinyWaitSmall
		If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Sign").Exist(60) Then  
		   Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Sign").Click
		End if
		Wait g_TinyWaitSmall
		If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=SignRequired - Sign Here").Exist(60) Then  
		   Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=SignRequired - Sign Here").Click
		End If
		Wait g_TinyWaitSmall
		If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Finish","index:=2").Exist(60) Then  
		   Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Finish","index:=2").Click
		End if 
	End If	
    
Set objWebPage = Nothing  
Set objData    = Nothing

End Function



'@}