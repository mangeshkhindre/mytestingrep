''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'@defgroup E2E_9VANoCORefiARM_Submittal
'This is the function group for VANoCORefiARM_Submittal
' List of Functions here
'@code
'   Function AttachNBrowseDocument(FileName)
'   Function DisclosureTrackingWeb_LoanCenter_AcceptAndeSign(strLoanNumber, strRowID)
' @endcode
'@{
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'This function is used to attach document for the documents
'@code
'    AttachNBrowseDocument(FileName)
'@endcode
'Param FileName

Function AttachNBrowseDocument(FileName)

Dim objMain, objList, objDocumentDetailsDialog, intRowCount, intRowNumber, strTitleofDocument

    Set objMain                  = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MainScreen").SwfWindow("swfname:=LoanPage")
    Set objList                  = objMain.SwfObject("swfname:=gridViewDocs")
    Set objDocumentDetailsDialog = SwfWindow("swfname:=DocumentDetailsDialog") 
    
    intRowCount = GUI_List_GetNumberofRows(objList)
    
    For intRowNumber = 0 To intRowCount-1 Step 1
	    objList.Object.Items.item(intRowNumber).Subitems.item(1).Checked = True
        GUI_List_ClickOnCellData objList, intRowNumber, 1, False, False, False, "Double"
        GUI_Object_WaitTillExistX SwfWindow("swfname:=DocumentDetailsDialog").SwfObject("swfname:=btnAttachBrowse"),200
        
        strTitleofDocument = GUI_Object_GetPropertyValue(SwfWindow("swfname:=DocumentDetailsDialog"), "text")
	    GUI_SwfObject_Click SwfWindow("swfname:=DocumentDetailsDialog").SwfObject("swfname:=btnAttachBrowse")
	    GUI_SwfEdit_Set SwfWindow("swfname:=DocumentDetailsDialog").Dialog("text:=Browse and Attach").WinEdit("attachedtext:=File &name:","nativeclass:=Edit"), FRM_RT_DataDirPath()
     	GUI_SwfButton_Click SwfWindow("swfname:=DocumentDetailsDialog").Dialog("text:=Browse and Attach").WinButton("text:=&Open")
	    
        Wait g_TinyWaitSmall
	    GUI_SwfEdit_Set SwfWindow("swfname:=DocumentDetailsDialog").Dialog("text:=Browse and Attach").WinEdit("attachedtext:=File &name:","nativeclass:=Edit"), FileName
     	GUI_SwfButton_Click SwfWindow("swfname:=DocumentDetailsDialog").Dialog("text:=Browse and Attach").WinButton("text:=&Open")
        GUI_Object_IsExistX objDocumentDetailsDialog.SwfCheckBox("swfname:=chkRequested"), 240
        GUI_SwfButton_Click objDocumentDetailsDialog.SwfButton("swfname:=btnClose")
        FRM_Logger_ReportPassEvent "Attach Document", strTitleofDocument & " is attached to document", Null
    Next	
    
    Set objMain                  = Nothing
    Set objList                  = Nothing
    Set objDocumentDetailsDialog = Nothing
    
End Function



'This function returns the directory path to the RuntimeProp File
'@code
'    DisclosureTrackingWeb_LoanCenter_AcceptAndeSign(strLoanNumber, strRowID)
'@endcode
'Param strLoanNumber
'Param strRowID

Function DisclosureTrackingWeb_LoanCenter_AcceptAndeSign(strLoanNumber, strRowID)

Dim objWebPage, objData, strBorrowerName, strAuthCode
    
    FRM_Logger_ReportInfoEvent "Accept consent and eSign docs", "eSign docs using Row Id '"&strRowID&"' in the eFolder_Tab datasheet", null
    k=""
    If (GUI_Object_IsExist(Browser("name:=.*Ellie Mae.*", "index:=0").Page("title:=.*Ellie Mae.*", "index:=0"))) Then 
        Set objWebPage = Browser("name:=.*Ellie Mae.*", "index:=0").Page("title:=.*Ellie Mae.*", "index:=0")
    End If
    If (GUI_Object_IsExist(Browser("name:=.*Mortgage.*", "index:=0").Page("title:=.*Mortgage.*", "index:=0"))) Then 
        Set objWebPage = Browser("name:=.*Mortgage.*", "index:=0").Page("title:=.*Mortgage.*", "index:=0")
    End If
    Set objData = FRM_DS_GetTestData("eFolder_Tab", "SendeDisclosures", strRowID)
    
    strBorrowerName = FRM_DS_GetValue(objData, "BorrowerName")
    If BIZ_DisclosureTrackingWeb_OpenLoanDetails(strBorrowerName, strLoanNumber) Then
        GUI_Link_Click objWebPage.Link("name:=eSign", "index:=0")
 
        If objWebPage.Link("name:=I Agree", "index:=0").Exist(3) Then
            GUI_Link_Click objWebPage.Link("name:=I Agree", "index:=0")
        End If    
        GUI_Object_WaitTillExist objWebPage.WebEdit("html id:=passwordTextBox")  
    
        strAuthCode = FRM_DS_GetValue(objData, "BorrowerCode")
        
        If  objWebPage.WebEdit("html id:=passwordTextBox").Exist(120) Then
            GUI_WebEdit_Set objWebPage.WebEdit("html id:=passwordTextBox"), strAuthCode
        End If    
        GUI_Link_Click objWebPage.Link("html id:=NextButton_linkButton")
    
        If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next").Exist(60) Then  
           Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next").Click
        End if
        wait g_TinyWaitSmall
        
        If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next","index:=1").Exist(60) Then  
           Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Next","index:=1").Click
        End if
        wait g_TinyWaitSmall
        
        If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Sign").Exist(60) Then  
           Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Sign").Click
        End if
        Wait g_TinyWaitSmall
        
        If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=SignRequired - Sign Here").Exist(60) Then  
            Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=SignRequired - Sign Here").Click
        End If
        Wait g_TinyWaitSmall
        
        If Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Finish","index:=2").Exist(60) Then  
           Browser("name:=DocuSign", "index:=0").Page("title:=DocuSign", "index:=0").WebButton("html tag:=BUTTON","type:=button","name:=Finish","index:=2").Click
        End if 
        
    End If  

Set objWebPage = Nothing  
Set objData    = Nothing

End Function



'@}