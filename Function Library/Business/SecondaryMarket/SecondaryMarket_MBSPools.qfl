''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'@defgroup BIZ_SecondaryMarket
'@code
'   Function BIZ_SecondaryMarket_Trades_MBSPool_PreRequiste()
'   Function BIZ_SecondaryMarket_Trades_MBSpool(strpooltype)
'   Function BIZ_SecondaryMarket_Trades_PricingDetails(strMbsType)
'   Function BIZ_SecondaryMarket_Trades_SelectLoans(strpooltype)
'   Function BIZ_SecondaryMarket_Trades_UpdateSelectedLoans()
'   Function Function BIZ_SecondaryMarket_Trades_Loans_SecondaryRegistration(strPoolName, strPoolType)
'   Function BIZ_SecondaryMarket_Trades_Loans_Remove()
'	Function BIZ_SecondaryMarket_Nav_Tradedetails(strColValue,initFieldIndexval)
'	Function BIZ_SecondaryMarket_CorrespondentLoanTradeCreation(strRow)
'	Function BIZ_SecondaryMarket_Trades_Loans_RemoveCorrespondentLoan()
'	Function BIZ_SecondaryMarket_Trades_CorrespondentLoans_SecondaryRegistration(strPoolName, strPoolType)
'	Function BIZ_SecondaryMarket_Trades_CreateCorrespondentMasterCommitment(strRowID)
'   Function BIZ_SecondaryMarket_LockSettings(strLockType, strLockStatus)
'@endcode
'@{
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

Function BIZ_SecondaryMarket_Nav_Pooldetails(strTradeName,initFieldIndexval)

    Dim objLoanList
    
    Set objLoanList = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen").SwfObject("swfname:=gvTradeList")
    
    If GUI_Object_IsExistX(objLoanList, 60) then
		SwfWindow("swfname:=MainForm").SwfEdit("swfname:=txtBox","index:="&initFieldIndexval).Set strTradeName
		UTIL_Win_SendKey "{ENTER}"
		intRow = GUI_List_GetRowIndex(objLoanList, "Pool ID", strTradeName)
		If intRow>=0 Then
			GUI_List_ActOnRow objLoanList, intRow+1, True, False, False, "Double"
			FRM_Logger_ReportPassEvent "Pool Details","Pool Secutity Exists in Page", Null
		Else
			FRM_Logger_ReportFailEvent "Pool Details","Pool Secutity Exists not in Page", Null
		End If
	End If
	
	Set objLoanList=nothing
	
End Function
'This function is used to Pre Requiste for MBS Pools
'@code
'    Function BIZ_SecondaryMarket_Trades_MBSPool_PreRequiste(strpooltype)
'@endcode
'@param strpooltype

Function BIZ_SecondaryMarket_Trades_MBSPool_PreRequiste
	
	FRM_Logger_ReportInfoEvent "Start Fannie Mae PE MBS Pool","Prequiste - BIZ_SecondaryMarket_Trades_MBSPool_PreRequiste", Null
	
	Dim objMainFormWnd
	Set objMainFormWnd = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer")
	
	BIZ_Nav_OpenMenuItem "Encompass;Settings..."
	BIZ_Nav_HierarchyTree "Secondary Setup", "Trade Management Setup"
	GUI_Object_WaitTillVisible objMainFormWnd.SwfObject("swfname:=stdIconBtnNewTradeDescription")
	BIZ_SecondaryMarket_AutoLockCheck_OnorOff objMainFormWnd.SwfCheckBox("swfname:=ckboxEnableTrade"), True
	BIZ_Nav_OpenMenuItem "Encompass;Settings..."
	BIZ_Nav_HierarchyTree "Secondary Setup", "Trade Management Setup"
	GUI_Object_WaitTillVisible objMainFormWnd.SwfObject("swfname:=stdIconBtnNewTradeDescription")
	BIZ_SecondaryMarket_AutoLockCheck_OnorOff objMainFormWnd.SwfCheckBox("swfname:=ckboxEnableMbsPool"), True
	
	Set objMainFormWnd = Nothing
	
End Function



'This function is used to Pre Requiste for MBS Pools
'@code
'   Function BIZ_SecondaryMarket_Trades_CorrespondentLoanTrade_PreRequiste(strpooltype)
'@endcode
'@param strpooltype

Function BIZ_SecondaryMarket_Trades_CorrespondentLoanTrade_PreRequiste
	
	FRM_Logger_ReportInfoEvent "Start Fannie Mae PE MBS Pool","Prequiste - BIZ_SecondaryMarket_Trades_CorrespondentLoanTrade_PreRequiste", Null
	
	Dim objMainFormWnd
	Set objMainFormWnd = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer")
	
	BIZ_Nav_OpenMenuItem "Encompass;Settings..."
	BIZ_Nav_HierarchyTree "Secondary Setup", "Trade Management Setup"
	GUI_Object_WaitTillVisible objMainFormWnd.SwfCheckBox("swfname:=ckboxEnableCorTrade")
	BIZ_SecondaryMarket_AutoLockCheck_OnorOff objMainFormWnd.SwfCheckBox("swfname:=ckboxEnableCorTrade"), True
	BIZ_Nav_OpenMenuItem "Encompass;Settings..."
	BIZ_Nav_HierarchyTree "Secondary Setup", "Trade Management Setup"
	GUI_Object_WaitTillVisible objMainFormWnd.SwfCheckBox("swfname:=ckboxEnableCorMaster")
	BIZ_SecondaryMarket_AutoLockCheck_OnorOff objMainFormWnd.SwfCheckBox("swfname:=ckboxEnableCorMaster"), True
	
	Set objMainFormWnd = Nothing
	
End Function
	

	
'This function is used to Navigate to Trades Sub Section
'@code
'   Function BIZ_SecondaryMarket_Trades_NavigateToSubSections(strSectionName)
'@endcode
'@param strSectionName

Function BIZ_SecondaryMarket_Trades_NavigateToSubSections(strSectionName)
	FRM_Logger_ReportInfoEvent "Navigate to Trades Sub Section","Start Navigate to Trades Sub Section", Null
	
	Dim objTradeStartUpdate, objTabSecurityTrade
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objTradeStartUpdate=SwfWindow("swfname:=MainForm").SWfwindow("swfname:=TradeLoanSyncDlg")
	Set objTabSecurityTrade=objHomePage.SwfObject("swfname:=btnSecurityTrades")
	
	BIZ_Nav_SelectTabControl "Trades"
	
	GUI_Dialog_Encompass_YesX 15, Null
	If GUI_Object_IsExistX(objTradeStartUpdate.SwfButton("swfname:=btnOK"), 15) Then
		GUI_SwfObject_Click objTradeStartUpdate.SwfButton("swfname:=btnOK")
		GUI_Dialog_Encompass_OKX 15, Null
	ElseIf GUI_Object_IsExistX(SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) Then
		GUI_SwfObject_Click SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
		GUI_Dialog_Encompass_OKX 15, Null
	ElseIf GUI_Object_IsExistX(SwfWindow("swfname:=MainForm").Swfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) Then
		GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
		GUI_Dialog_Encompass_OKX 15, Null
	End If
	Select Case strSectionName
		Case "MBS Pools"
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnMbsPools")
			GUI_Dialog_Encompass_YesX 15, Null
		Case "Security Trades"
			GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen").SwfObject("swfname:=objTabSecurityTrade")
			GUI_Dialog_Encompass_YesX 15, Null
		Case "Loan Trades"
			GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen").SwfObject("swfname:=btnTrades")
			GUI_Dialog_Encompass_YesX 15, Null
		Case "Correspondent Commitment"
			GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen").SwfObject("swfname:=btnCorrespondentMasters")
			GUI_Dialog_Encompass_YesX 15, Null
		Case "Correspondent Trades"
			GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen").SwfObject("swfname:=btnCorrespondentTrades")
			GUI_Dialog_Encompass_YesX 15, Null
			GUI_Dialog_Encompass_OKX 10, ""
		Case Else
			FRM_Logger_ReportFailEvent "Trades Sub Section","Trades Sub Section not Exists inT rades Page", Null
	End Select
	
	Set objTabSecurityTrade = Nothing
	Set objTradeStartUpdate = Nothing
End Function



'This function is used to create the Pool to Trades of MBS Pools
'@code
'   Function BIZ_SecondaryMarket_Trades_MBSpool(strpooltype)
'@endcode
'@param strpooltype- Pool type information from Excel

Function BIZ_SecondaryMarket_Trades_MBSpool(strpooltype)

	FRM_Logger_ReportInfoEvent "Start Fannie Mae PE MBS Pool","Scrpit Name - BIZ_SecondaryMarket_Trades_MBSpool", Null
	
	Dim objTradeStartUpdate, objTabSecurityTrade, objData, objNewMBSPage
	
	Set objTradeStartUpdate = SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
	Set objLoanStartUpdate = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objNewMBSPage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MbsPoolMortgageTypeDialog")
	Set objData = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strpooltype)
	set objNoti = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=TradeLoanUpdateNotificationDialog")
	Set objInvestorTemplate = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=InvestorTemplateSelector")
	
	If GUI_Object_IsExistX(objLoanStartUpdate, 60) Then
		GUI_SwfObject_Click objLoanStartUpdate
		GUI_Dialog_Encompass_OKX 15, Null
	End If
	If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=btnNew"), 60) Then
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
		If GUI_Object_IsExistX(objNewMBSPage, 60) then
			If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strPoolMortgageType")) Then
				If Util_String_IsMatch(FRM_DS_GetValue(objData, "strPoolMortgageType"),"Fannie Mae PE MBS") Then
					GUI_SwfRadioButton_Click objNewMBSPage.SwfRadioButton("swfname:=rbtnFannieMaePE")
				ElseIf Util_String_IsMatch(FRM_DS_GetValue(objData, "strPoolMortgageType"),"Fannie Mae") Then
					GUI_SwfRadioButton_Click objNewMBSPage.SwfRadioButton("swfname:=rbtnFannie")
				ElseIf Util_String_IsMatch(FRM_DS_GetValue(objData, "strPoolMortgageType"),"Ginnie Mae") Then
					GUI_SwfRadioButton_Click objNewMBSPage.SwfRadioButton("swfname:=rbtnGinnie")
				ElseIf Util_String_IsMatch(FRM_DS_GetValue(objData, "strPoolMortgageType"),"Freddic Mae") Then
					GUI_SwfRadioButton_Click objNewMBSPage.SwfRadioButton("swfname:=rbtnFreddie")
				End If
				GUI_SwfButton_Click	objNewMBSPage.SwfButton("swfname:=btnOk")
			End If
			If GUI_Object_IsExistX(objHomePage.SwfEdit("swfname:=txtPoolID"),30) Then
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strPoolId")) Then	
					strsSecureids=FRM_DS_GetValue(objData, "strPoolId")
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtPoolID"), strsSecureids
					FRM_Logger_ReportInfoEvent "Start MBS Pool Creation--Pool ID","Pool Id Data Entered - "&strsSecureids, Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "intPoolid")) Then	
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtPoolNumber"), FRM_DS_GetValue(objData, "intPoolid")
					FRM_Logger_ReportInfoEvent "Start MBS Pool Creation--Pool Number","Pool number Data Entered - "&FRM_DS_GetValue(objData, "intPoolid"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateCommitment")) Then	
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","index:=0"), FRM_DS_GetValue(objData, "dateCommitment")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Commitment Date","Commitment Date Data Entered - "&FRM_DS_GetValue(objData, "dateCommitment"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strMortgagetype")) Then	
					GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbMortgageType"), FRM_DS_GetValue(objData, "strMortgagetype")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Mortage Type","Mortage Type Data Entered - "&FRM_DS_GetValue(objData, "strMortgagetype"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "intTerm")) Then	
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTerm"), FRM_DS_GetValue(objData, "intTerm")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Term","Term Data Entered - "&FRM_DS_GetValue(objData, "intTerm"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "intPoolAmount")) Then	
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtAmount"), FRM_DS_GetValue(objData, "intPoolAmount")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Pool Amount","Pool Amount Data Entered - "&FRM_DS_GetValue(objData, "intPoolAmount"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCommitmentType")) Then	
					GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbCommitmentType"), FRM_DS_GetValue(objData, "strCommitmentType")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Commitment Type","Commitment Type Data Entered - "&FRM_DS_GetValue(objData, "strCommitmentType"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeDescription")) Then	
					GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbTradeDesc"), FRM_DS_GetValue(objData, "strTradeDescription")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Trade description","Trade description Data Entered - "&FRM_DS_GetValue(objData, "strTradeDescription"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strInvestorName")) Then	
					GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnInvestorTemplate")
					If GUI_Object_IsExistX(objInvestorTemplate.SwfObject("swfname:=gvTemplates"),60) Then
						GUI_List_ClickRow objInvestorTemplate.SwfObject("swfname:=gvTemplates"), Null, "Investor Name", FRM_DS_GetValue(objData, "strInvestorName"), True, False, False, "Single"
						GUI_SwfButton_Click objInvestorTemplate.SwfButton("swfname:=btnOK")
					End If
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateInvestorDelivery")) Then	
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","index:=7"), FRM_DS_GetValue(objData, "dateInvestorDelivery")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Investor Delivery Date","Investor Delivery Date - "&FRM_DS_GetValue(objData, "dateInvestorDelivery"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strServicingType")) Then	
					GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbServicingType"), FRM_DS_GetValue(objData, "strServicingType")
					FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Servcing Type","Servcing Type Data Entered - "&FRM_DS_GetValue(objData, "strServicingType"), Null
				End If
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
				FRM_Logger_ReportInfoEvent "MBS Pool Creation","MBS Pool Created - "&strsSecureids, Null
			End If
		Else
			FRM_Logger_ReportFailEvent "Fannie Data Field","Details Entering page is not displayed", Null
		End IF
	End If
	Set objTradeStartUpdate = Nothing
	Set objHomePage         = Nothing
	Set objData             = Nothing
	Set objMainFormWnd      = Nothing

	BIZ_SecondaryMarket_Trades_MBSpool=strsSecureids
	
End Function



'This function is used to Select the loans to Trades of MBS Pools
'@code
'   Function BIZ_SecondaryMarket_Trades_PricingDetails(strMbsType)
'@endcode
'@param strMbsType- Pool type information from Excel

Function BIZ_SecondaryMarket_Trades_PricingDetails(strMbsType)
	
	FRM_Logger_ReportInfoEvent "MBS Pool Trade Pricinng", "Function BIZ_SecondaryMarket_Trades_PricingDetails", Null
	
	Dim objMainScreen, objPricingDialog, objPricingFilter, objFilterDialog, objReportFieldDialog, objData
	Set objMainScreen        = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	set objPricingDialog     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsFannieFreddiePricingItemDialog")
	Set objPricingFilter     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=PriceAdjustmentFilterDlg")
	Set objFilterDialog      = objPricingFilter.SwfWindow("swfname:=AddEditFilterDialog")
	Set objReportFieldDialog = objFilterDialog.SwfWindow("swfname:=ReportFieldSelector")
	Set objData              = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strMbsType)
	
	GUI_SwfTab_Click objMainScreen.SwfTab("swfname:=tabTrade"), "Pricing"
	
	If GUI_Object_IsExistX(objMainScreen.SwfObject("swfname:=siBtnAdd"), 60) Then
		GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=siBtnAdd")
		FRM_Logger_ReportInfoEvent "Click on Add Pricing data", "Add Pricing button Clicked", Null
		If GUI_Object_IsExistX(objPricingDialog, 60) Then
			FRM_Logger_ReportInfoEvent "Add pricing Data dialog box should be opened", "Add pricing Data dialog box is opened", Null
			GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txt_NoteRate"), FRM_DS_GetValue(objData, "NoteRateValue")
			GUI_SwfObject_Click objPricingDialog.SwfButton("swfname:=btn_OK")
			If GUI_Object_IsExistX(objMainScreen.SwfObject("swfname:=btnAdd", "index:=1"), 60) Then
				GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=btnAdd", "index:=1")
				If GUI_Object_IsExistX(objPricingFilter, 60) Then
					FRM_Logger_ReportInfoEvent "Add/Edit search filter dialogue box should get displayed", "Add/Edit search filter dialogue box is successfully displayed", Null
					GUI_SwfObject_Click objPricingFilter.SwfObject("swfname:=btnAddFilter")
					If GUI_Object_IsExistX(objFilterDialog, 60) Then
						GUI_SwfObject_Click objFilterDialog.SwfObject("swfname:=btnFieldList")
						FRM_Logger_ReportInfoEvent "Click on Filter DiaLog", "Clicked the DiaLog for Filter Selection", Null
						GUI_SwfEdit_Set objReportFieldDialog.SwfEdit("swfname:=txtFind"), FRM_DS_GetValue(objData, "FieldValue")
						FRM_Logger_ReportInfoEvent "Field Value Data", "Field value data Entered", Null
						GUI_SwfButton_Click objReportFieldDialog.SwfButton("swfname:=btnFind")
						FRM_Logger_ReportInfoEvent "Field Value Find", "Find Button Clicked for Field value", Null
						GUI_SwfButton_Click objReportFieldDialog.SwfButton("swfname:=btnOK")
						FRM_Logger_ReportInfoEvent "Click on Field value Ok", "Clicked on Field value OK Button", Null
						GUI_SwfComboBox_Select objFilterDialog.SwfComboBox("swfname:=cboOperator"), "Is not"
						FRM_Logger_ReportInfoEvent "Combo Box Selection for Operator", "Selected the Operator value in the Combo Box", Null
						GUI_Dialog_Encompass_OKX 15, Null
						GUI_SwfEdit_Set objFilterDialog.SwfEdit("swfname:=txtMinNumber","index:=0"), FRM_DS_GetValue(objData, "Value")
						FRM_Logger_ReportInfoEvent "Minimum value field in Operator", "Minimum value is entered in the field -"&FRM_DS_GetValue(objData, "Value"), Null
						GUI_SwfButton_Click objFilterDialog.SwfButton("swfname:=btnOK")
						FRM_Logger_ReportInfoEvent "Click on OK in operator", "OK Button clicked on the Operator ", Null
						GUI_SwfButton_Click objPricingFilter.SwfButton("swfname:=btnApply")
						FRM_Logger_ReportInfoEvent "Apply Button Click", "Apply Button Clicked on the Operator Selection", Null
					Else
						FRM_Logger_ReportFailEvent "PopUp with fields (Field, Description, Operator, Value) should display:", "PopUp with fields (Field, Description, Operator, Value) is not displayed", Null
					End If
					boolValue = GUI_List_TextExists(objMainScreen.SwfObject("swfname:=gvAdjustments"), 0, FRM_DS_GetValue(objData, "strPriceAdjustMentsValue"))
					If Not boolValue Then
						FRM_Logger_ReportFailEvent "Filter '"&FRM_DS_GetValue(objData, "strPriceAdjustMentsValue")&"' should display in Price Adjustments section", "Filter '"&FRM_DS_GetValue(objData, "strPriceAdjustMentsValue")&"' is not displayed in Price Adjustments section", Null
					End If
				Else
					FRM_Logger_ReportFailEvent "Add/Edit search filter dialogue box should get displayed", "Add/Edit search filter dialogue box is not displayed", Null
				End If
			Else
				FRM_Logger_ReportFailEvent "Price Adjustment Add Button", "Price Adjustment Add Buttonnot exists in the application", Null
			End If
		Else
			FRM_Logger_ReportFailEvent "Click on Add Pricing data", "Add Pricing button not Clicked", Null
		End If
	End If	
	Set objMainScreen        = Nothing
	Set objPricingDialog     = Nothing
	Set objPricingFilter     = Nothing
	Set objFilterDialog      = Nothing
	Set objReportFieldDialog = Nothing
	Set objData              = Nothing
	
End Function




'This function is used to Select the loans to Trades of MBS Pools
'@code
'   Function BIZ_SecondaryMarket_Trades_SelectLoans(strpooltype)
'@endcode
'@param strpooltype- Pool type information from Excel

Function BIZ_SecondaryMarket_Trades_SelectLoans(strpooltype)
	FRM_Logger_ReportInfoEvent "Start Loan Selection","Loans selection for Pool", Null

	Dim objHomePage, objDialogPage, objData
	
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objDialogPage = Swfwindow("Swfname:=MainForm").SwfWindow("swfname:=CommitmentAssignLoanToPoolDialog")
	Set objData = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strpooltype)
	
	If GUI_Object_IsExistX(objHomePage.SwfTab("swfname:=tabTrade"), 60) Then
		GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"), "Loans"
		If GUI_Object_IsExistX(objHomePage.SwfCheckBox("swfname:=chkViewEligible"), 60) Then
			FRM_Logger_ReportInfoEvent "Loans Tab Selection","Loans tabs Selected and Displayed for View Eligibe Loans", Null
			If Not GUI_Object_GetPropertyValue(objHomePage.SwfCheckBox("swfname:=chkViewEligible"),"checked") Then
				GUI_SwfObject_Click objHomePage.SwfCheckBox("swfname:=chkViewEligible")
			End If
			wait 10
			If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=tableContainer1"), 15) Then
				FRM_Logger_ReportInfoEvent "View Eligible Loans","Eligible loans information displayed", Null
				If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=gvEligible"), 15) Then
					intRow = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvEligible"))
					If intRow >= 0 Then
						For i = 0 To intRow Step 1
							strStatusName  = GUI_List_GetCellData(objHomePage.SwfObject("swfname:=gvEligible"),i,1)
							If UTIL_String_IsEmpty(strStatusName) Then
								GUI_List_ActOnRow objHomePage.SwfObject("swfname:=gvEligible"), i+1, False, False, False, "Single"
								GUI_SwfButton_Click objHomePage.SwfButton("swfname:=btnAddLoans")
								FRM_Logger_ReportInfoEvent "Assigned Loans","Clicked on the Assigned Loans", Null
								If GUI_Object_IsExistX(objDialogPage, 60) Then
									If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strContractName")) Then	
										GUI_SwfEdit_Set objDialogPage.SwfEdit("swfname:=txtCommitmentContractNum"), FRM_DS_GetValue(objData, "strContractName")
										FRM_Logger_ReportInfoEvent "Contract Number","Contract Number Data Entered - "&FRM_DS_GetValue(objData, "strContractName"), Null
									End If
									If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strProductName")) Then	
										GUI_SwfComboBox_Select objDialogPage.SwfComboBox("swfname:=cmbProductName"), FRM_DS_GetValue(objData, "strProductName")
										FRM_Logger_ReportInfoEvent "Form NUmber","Form name Data Entered - "&FRM_DS_GetValue(objData, "cmbProductName"), Null
									End If
									GUI_SwfButton_Click objDialogPage.SwfButton("swfname:=btnOK")
									FRM_Logger_ReportInfoEvent "Contract NUmber","Clicked on OK Button", Null
									GUI_Dialog_Encompass_OK "The Commitment Contract number is invalid. Do you want to continue?"
								End If
								intRow1 = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvLoans"))
								intGetData=GUI_List_GetRowIndex(objHomePage.SwfObject("swfname:=gvLoans"),"Trade Assignment Status", "Assigned - Pending")
								If intRow1>=0  and intGetData>=0 Then
									FRM_Logger_ReportPassEvent "Loans Assigned","Loan Assigned to Pool", Null
									Exit For
								Else
									FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
								End If
							End If
						Next
					End If
				Else
					FRM_Logger_ReportFailEvent "View Eligible Loans","Eligible loans information not displayed", Null
				End If
			Else
				FRM_Logger_ReportFailEvent "Loans Tab Selection","Loans tabs not Selected and not displayed View Eligibe Loans", Null
			End If
		End If
	End If
	
	Set objHomePage   = Nothing
	Set objDialogPage = Nothing
	Set objData       = Nothing

End Function
	


'This function is used to Update the Loans
'@code
'   Function BIZ_SecondaryMarket_Trades_UpdateSelectedLoans(strPoolFannieName, strpooltype)
'@endcode
'@param strPoolFannieName Pool type information
'@param strpooltype- Pool type information from Excel

Function BIZ_SecondaryMarket_Trades_UpdateSelectedLoans(strPoolFannieName, strpooltype)

	FRM_Logger_ReportInfoEvent "Start Loan Updaton","Loans updation for Pool", Null

	Dim objHomePage, objDiaLog, objData

	Set objDiaLog = SwfWindow("swfname:=MainForm").DiaLog("text:=EnCompass").Static("index:=1")
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objData     = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strpooltype)
	
	GUI_SwfButton_Click objHomePage.SwfButton("swfname:=btnUpdateLoans")
	If GUI_Object_IsExistX(objDiaLog, 60) Then
		strDialogtext= objDiaLog.GetROProperty("text")
		GUI_Dialog_Encompass_YesX 15, ""
	End IF
	If GUI_Object_IsExistX(SwfWindow("swfname:=MainForm").SWfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) Then
		GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SWfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
		FRM_Logger_ReportInfoEvent "DiaLog Start Update Message","Start Updated for Loan sync dialog exists", Null
	ElseIf GUI_Object_IsExistX(SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) Then
		GUI_SwfButton_Click SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
		FRM_Logger_ReportInfoEvent "DiaLog Start Update Message","Start Updated for Loan sync dialog exists", Null
	ElseIf GUI_Object_IsExistX(SwfWindow("swfname:=Main Form").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) Then
		GUI_SwfButton_Click SwfWindow("swfname:=Main Form").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
		FRM_Logger_ReportInfoEvent "DiaLog Start Update Message","Start Updated for Loan sync dialog exists", Null
	End If	
	If GUI_Object_IsExistX(objDiaLog, 15) Then
		strDialogtext= objDiaLog.GetROProperty("text")
		GUI_Dialog_Encompass_YesX 10,""
		GUI_Dialog_Encompass_OKX 10, ""
		FRM_Logger_ReportInfoEvent "DiaLog Button","Clicked on OK Button", Null
		wait 10
	End If
	intRow1 = GUI_List_GetRowIndex(objHomePage.SwfObject("swfname:=gvLoans","index:=0"), "Trade Assignment Status", "Assigned")
	If intRow1 >= 0 Then
		FRM_Logger_ReportPassEvent "Loans Assigned","Loan Assigned to Pool", Null
	Else
		FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
	End If
	Set objHomePage = Nothing
	Set objDiaLog   = Nothing
	
End Function



'This function is used to validate the Secondary Registration
'@code
'   BIZ_SecondaryMarket_Trades_Loans_SecondaryRegistration(strPoolName, strPoolType)
'@endcode
'@param strPoolName -  Pool Name
'@param strPoolType -  rowId for Data

Function BIZ_SecondaryMarket_Trades_Loans_SecondaryRegistration(strPoolName, strPoolType)
	FRM_Logger_ReportInfoEvent "Start Secondary Registration","Loans updation for Pool- BIZ_SecondaryMarket_Trades_Loans_SecondaryRegistration", Null

	Dim objHomePage, objGridStatus, intRow1
	
	Set objHomePage    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objGridStatus  = SwfWindow("swfname:=MainForm").SwfObject("swfname:=gridSnapshot")
	Set objData        = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strPoolType)
	If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=gvLoans"), 15) Then
		intRow1 = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvLoans"))
		If intRow1 >= 0 Then
			GUI_List_ClickRow objHomePage.SwfObject("swfname:=gvLoans"), Null, "Trade Assignment Status", "Assigned", True, False, False, "Double"
			If GUI_Object_IsExistX(objHomePage.SwfLabel("swfname:=label4","index:=0"), 60) Then
				BIZ_SecondaryMarket_ToolsNavigation "Secondary Registration"
				FRM_Logger_ReportInfoEvent "Secondary Market Navigation","Navigated to secondary Market", Null
				GUI_List_ActOnRow objGridStatus, 0, False, False, False, "Double"
				strActMBSPool = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=textBox26"),"text")
				intActMBSPoolNum = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=textBox23"),"text")
				intInvestorNum = GUI_List_GetRowIndex(objGridStatus,"Investor", FRM_DS_GetValue(objData, "strInvestorName"))
				strActCommitmentDate = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=textBox25","index:=0"),"text")
				strActInvestorDeliveryDate = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=COMBOFIELD2291","index:=0"),"text")
				If UTIL_String_IsNotEmpty(intActMBSPoolNum) Then
					FRM_Logger_ReportPassEvent "Pool Number '"&intActMBSPoolNum&"' should be present in Pool Number Edit box","Pool Number '"&intActMBSPoolNum&"' is present in Pool Number Edit box", Null
				Else
					FRM_Logger_ReportFailEvent "Pool Number '"&intActMBSPoolNum&"' should be present in Pool Number Edit box","Pool Number '"&intActMBSPoolNum&"' is not present in Pool Number Edit box", Null
				End If
				If UTIL_String_IsMatch(strPoolName, strActMBSPool) Then
					FRM_Logger_ReportPassEvent "PoolName '"&strPoolName&"' should present in PoolID Edit box","PoolName '"&strPoolName&"' is present in PoolID Edit box", Null
				Else
					FRM_Logger_ReportFailEvent "PoolName '"&strPoolName&"' should present in PoolID Edit box","PoolName '"&strPoolName&"' is not present in PoolID Edit box", Null
				End If
				If UTIL_String_IsMatch(strActCommitmentDate, BIZ_SecondaryMarket_ConvertDate(FRM_DS_GetValue(objData, "dateCommitment"))) Then
					FRM_Logger_ReportPassEvent "Commitment Date '"&strActCommitmentDate&"' should present in Commitment Date Edit box","Commitment Date '"&strActCommitmentDate&"' is present in Commitment Date Edit box", Null
				Else
					FRM_Logger_ReportFailEvent "Commitment Date '"&strActCommitmentDate&"' should present in Commitment Date Edit box","Commitment Date '"&strActCommitmentDate&"' is not present in Commitment Date Edit box", Null
				End If
				If UTIL_String_IsMatch(strActInvestorDeliveryDate, BIZ_SecondaryMarket_ConvertDate(FRM_DS_GetValue(objData, "dateInvestorDelivery"))) Then
					FRM_Logger_ReportPassEvent "Investor Delivery Date '"&strActInvestorDeliveryDate&"' should present in Investor Delivery Date Edit box","Investor Delivery Date '"&strActInvestorDeliveryDate&"' is present in Investor Delivery Date Edit box", Null
				Else
					FRM_Logger_ReportFailEvent "Investor Delivery Date '"&strActInvestorDeliveryDate&"' should present in Investor Delivery Date Edit box","Investor Delivery Date '"&strActInvestorDeliveryDate&"' is not in Investor Delivery Date Edit box", Null
				End If
				If intInvestorNum >= 0 Then
					FRM_Logger_ReportPassEvent "Investor should present in Investor Column","Investor is present in Investor Column", Null
				Else
					FRM_Logger_ReportFailEvent "Investor should present in Investor Column","Investor is not present in Investor Column", Null
				End If
				BIZ_Loan_Save()
				BIZ_Loan_Exit True
			End If
		Else
			FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
		End If
	End IF
	
	Set objHomePage    = Nothing
	Set objGridStatus  = Nothing
	
End Function



'This function is used to Changes the Investor Name
'@code
'   BIZ_SecondaryMarket_Trades_ChangeInvestor(strPoolType)
'@endcode
'@param strPoolType -  rowId for Data

Function BIZ_SecondaryMarket_Trades_ChangeInvestor(strPoolType)

	FRM_Logger_ReportInfoEvent "Start Change Investor","Scrpit Name - SecondaryMarket_Trades_MBSPool_Fannie_ChangeInvestor_004", Null
	
	Dim objHomePage, objNewMBSPage, objLoanStartUpdate, objGridStatus, objData, objInvestorTemplate
	
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objNewMBSPage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MbsPoolMortgageTypeDialog")
	Set objLoanStartUpdate = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
	Set objGridStatus = SwfWindow("swfname:=MainForm").SwfObject("swfname:=gridSnapshot")
	Set objData = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strPoolType)
	Set objInvestorTemplate = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=InvestorTemplateSelector")
	
	GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"), "Details"
	FRM_Logger_ReportInfoEvent "Details Tab", "Clicked on Details Tab", Null
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strChangeInvestorName")) Then	
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnInvestorTemplate")
		FRM_Logger_ReportInfoEvent "Clicked on Tempate Glass", "Clicked on template Glass", Null
		If GUI_Object_IsExistX(objInvestorTemplate.SwfObject("swfname:=gvTemplates"),60) Then
			GUI_List_ClickRow objInvestorTemplate.SwfObject("swfname:=gvTemplates"), Null, "Investor Name", FRM_DS_GetValue(objData, "strChangeInvestorName"), True, False, False, "Single"
			FRM_Logger_ReportInfoEvent "selected the Chnage Investor", "Investor  Name Sslected for chnage--"&FRM_DS_GetValue(objData, "strChangeInvestorName"), Null
			GUI_SwfButton_Click objInvestorTemplate.SwfButton("swfname:=btnOK")
			FRM_Logger_ReportInfoEvent "Click on OK Button", "After Investor Seleccted Clicked on OK Button", Null
		End If
	End If
		
	strActInvestorName = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=txtInvestor"),"text") 
	If Util_String_IsMatch(strActInvestorName,FRM_DS_GetValue(objData, "strChangeInvestorName")) Then
		FRM_Logger_ReportPassEvent "Start Change Investor","Investor Name is displaying - " &strActInvestorName, Null
	Else
		FRM_Logger_ReportFailEvent "Start Change Investor","Investor Name is not displaying - " &strActInvestorName,, Null
	End If
	
	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
	FRM_Logger_ReportInfoEvent "Save Details","Clicked on save for Pool", Null
	
	GUI_Dialog_Encompass_YesX 15, Null
	If GUI_Object_IsExistX(objLoanStartUpdate, 60) Then
		GUI_SwfButton_Click objLoanStartUpdate
		FRM_Logger_ReportInfoEvent "Update Details","Clicked on Update Button for Pool", Null
	End If
	GUI_Dialog_Encompass_OKX 15, Null
	
	GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"), "Loans"
	FRM_Logger_ReportInfoEvent "Loans Tab","Clicked on Loans Tab", Null
		
	If GUI_Object_IsExistX(objHomePage.SwfCheckBox("swfname:=chkViewEligible"), 60) Then
		intRow1 = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvLoans"))
		If intRow1>=0 Then
			GUI_List_ClickRow objHomePage.SwfObject("swfname:=gvLoans"), Null, "Trade Assignment Status", "Assigned", True, False, False, "Double"
			FRM_Logger_ReportInfoEvent "Assigned Row selction","Selected the Assigned Loan", Null
			If GUI_Object_IsExistX(objHomePage.SwfLabel("swfname:=label4","index:=0"), 60) Then
				BIZ_SecondaryMarket_ToolsNavigation "Secondary Registration"
				FRM_Logger_ReportInfoEvent "Navigate to Secondary Registration","navigated to Secondary registration", Null
				intInvestorNum = GUI_List_GetRowIndex(objGridStatus,"Investor",FRM_DS_GetValue(objData, "strChangeInvestorName"))
				If intInvestorNum >= 0 Then
					FRM_Logger_ReportPassEvent "Change the Investor name to '"&FRM_DS_GetValue(objData, "strChangeInvestorName")&"'", "Investor name is changed to '"&FRM_DS_GetValue(objData, "strChangeInvestorName")&"' successfully", Null
				Else
					FRM_Logger_ReportFailEvent "Change the Investor name to '"&FRM_DS_GetValue(objData, "strChangeInvestorName")&"'", "Investor name is not changed to '"&FRM_DS_GetValue(objData, "strChangeInvestorName")&"'", Null
				End If
			End If
			BIZ_Loan_Save()
			BIZ_Loan_Exit True
		Else
			FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
		End If
	End If	
	
	Set objHomePage         = Nothing
	Set objNewMBSPage		= Nothing
	Set objLoanStartUpdate  = Nothing
	Set objGridStatus		= Nothing
	Set objData				= Nothing
	Set objInvestorTemplate = Nothing
	
End Function



'This function is used to Remove the Loan from Trades
'@code
'   Function BIZ_SecondaryMarket_Trades_Loans_Remove()
'@endcode
'@param 

Function BIZ_SecondaryMarket_Trades_Loans_Remove()
	FRM_Logger_ReportInfoEvent "Start Loan Deletion","Loans updation for Pool- BIZ_SecondaryMarket_Trades_Loans_Remove", Null

	Dim objHomePage, objGridStatus
	
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	set objNoti = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=TradeLoanUpdateNotificationDialog")
	
	If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=gvLoans"), 60) Then
		intRow1 = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvLoans"))
		If intRow1>=0 Then
			GUI_List_ClickRow objHomePage.SwfObject("swfname:=gvLoans"), Null, "Trade Assignment Status", "Assigned", True, False, False, "Single"
			FRM_Logger_ReportInfoEvent "Select Loan","Selected the Loan", Null
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnRemoveLoans")
			FRM_Logger_ReportInfoEvent "Remove Button","Clicked on remove Button", Null
			If GUI_Object_IsExistX(SwfWindow("swfname:=MainForm").SWfwindow("swfname:=RemoveLoansOptionsDialog").SwfButton("swfname:=btnYes"), 60)Then
				GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=RemoveLoansOptionsDialog").SwfButton("swfname:=btnYes")
				FRM_Logger_ReportInfoEvent "DiaLog Button for Delete Loan","Clicked on DiaLog Button for Pool", Null
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
				FRM_Logger_ReportInfoEvent "Save Details for Loan","Clicked on Save Button for Pool", Null
				strDataText = SwfWindow("swfname:=MainForm").DiaLog("text:=EnCompass").Static("index:=0").GetROProperty("text")
				If Util_String_IsMatch(Replace(strDataText,vbCrLf,"") ,"The Fannie Mae PE MBS Pool has been saved successfully.Would you like to update the loan files with these recent changes?")Then
					GUI_Dialog_Encompass_YesX 15, Null
					If GUI_Object_IsExist(SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")) Then
						GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
						GUI_Dialog_Encompass_OK "MBS Pool "&strPoolName&" has been successfully submitted for update and is in pending status"
					ElseIf GUI_Object_IsExist(SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")) Then
						GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
						GUI_Dialog_Encompass_OKX 15, Null
					End If
					GUI_Dialog_Encompass_OKX 15, Null
				Else
					GUI_Dialog_Encompass_YesX 15, Null
					if GUI_Object_isExistX(SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) then
						GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
					ElseIf GUI_Object_isExistX(SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK"), 15) Then
						GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
					End If
					GUI_Dialog_Encompass_OKX 15, Null
					GUI_Dialog_Encompass_YesX 15, Null
					GUI_Dialog_Encompass_YesX 15, Null
					GUI_Dialog_Encompass_OKX 15, Null
					GUI_Dialog_Encompass_YesX 15, Null
				End If
				If GUI_Object_IsExistX(objNoti, 60) then
					GUI_Window_Close objNoti
				End IF
				GUI_SwfObject_Click objHomePage.swfObject("swfname:=btnList")
			End If
		End If
	Else
		FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
	End If
	
	Set objHomePage = Nothing
	
End Function



'This function is used to delete the Pool to Trades of MBS Pools
'@code
'   Function BIZ_SecondaryMarket_Trades_Pool_Deletion(strPoolName)
'@endcode
'@param strPoolName- Pool Name to delete

Function BIZ_SecondaryMarket_Trades_Pool_Deletion(strPoolName)

	FRM_Logger_ReportInfoEvent "Start Deletion Pool","Scrpit Name - Function BIZ_SecondaryMarket_Trades_Pool_Deletion", Null
	
	Dim objHomePage
	
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	
	BIZ_SecondaryMarket_Nav_Tradedetails strPoolName, 1
	If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=btnDelete"), 60) Then
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnDelete")
		FRM_Logger_ReportInfoEvent "Delete Pool Button","Clicked Delete Button", Null
		GUI_Dialog_Encompass_YesX 15, Null
		GUI_Dialog_Encompass_OKX 15, Null
		If GUI_Object_IsExistX(SwfWindow("swfname:=MainForm").DiaLog("text:=EnCompass").Static("index:=1"), 60) Then
			strDiaLogText = GUI_Object_GetPropertyValue(SwfWindow("swfname:=MainForm").DiaLog("text:=EnCompass").Static("index:=1"),"text")
			If Util_String_isMatch(strDiaLogText, "The selected MBS Pool(s) will be permanently deleted. Are you sure you want to proceed?") Then
				GUI_Dialog_Encompass_YesX 15, Null
				GUI_Dialog_Encompass_OKX 15, Null
			End If
		End If
	Else
		FRM_Logger_ReportFailEvent "Delete Pool Button","Not Clicked Delete Button", Null
	End If
	
	Set objHomePage = Nothing
	
End Function



'This function is used to Navigate to Trades
'@code
'   Function BIZ_SecondaryMarket_Nav_Tradedetails(strColValue,initFieldIndexval)
'@endcode
'@param strColValue- Value to serach in Pool
'@param initFieldIndexval- index for text box

Function BIZ_SecondaryMarket_Nav_Tradedetails(strTradeName,initFieldIndexval)

    Dim objLoanList
    
    Set objLoanList = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen").SwfObject("swfname:=gvTradeList")
    
    If GUI_Object_IsExistX(objLoanList, 60) then
		SwfWindow("swfname:=MainForm").SwfEdit("swfname:=txtBox","index:="&initFieldIndexval).Set strTradeName
		UTIL_Win_SendKey "{ENTER}"
		intRow = GUI_List_GetRowIndex(objLoanList, "Commitment Number", strTradeName)
		If intRow>=0 Then
			GUI_List_ActOnRow objLoanList, intRow+1, True, False, False, "Double"
			FRM_Logger_ReportPassEvent "Trade Details","Trade Secutity Exists in Page", Null
		Else
			FRM_Logger_ReportPassEvent "Trade Details","Trade Secutity Exists not in Page", Null
		End If
	End If
	
	Set objLoanList=nothing
	
End Function



'This function is used to Create the Loan trade
'@code
'   Function BIZ_SecondaryMarket_CreateNewTradeLoan(strRowLoan)
'@endcode
'@param strRowLoan - Get the details from the Excel

Function BIZ_SecondaryMarket_CreateNewTradeLoan(strRowLoan)
	
	FRM_Logger_ReportInfoEvent "Start Test Case Trade Security","Navigate to Security Trades SecondaryMarket_NavigationTOSecurityTrade", Null
	
	Set objData = FRM_DS_GetTestData("SecondaryMarket", "TradeLoan", strRowLoan)
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objTradeStartUpdate = SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
	Set objBTNNewTrade=objHomePage.SwfObject("swfname:=btnNew")
	Set objLBLNewTrade=objHomePage.SwfObject("swfname:=groupContainer1")
	Set objTabDetails=objHomePage.SwfTab("swfname:=btnTrades")
	Set objInvestorTemplate = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=InvestorTemplateSelector")
	Set objAddPric = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=AddPricingItemDialog")
	
	GUI_SwfObject_Click objBTNNewTrade
	
	If GUI_Object_IsExistX(objLBLNewTrade, 60) Then
		FRM_Logger_ReportInfoEvent "New Loan Trade Security","New Loan Trade page should be opened highlighting the Details tab", Null
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strSecurityID")) Then
			strTradeId = (FRM_DS_GetValue(objData, "strSecurityID"))
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtName"), strTradeId
			FRM_Logger_ReportInfoEvent "Trade Id Name","Trade ID Name Entered - "&strTradeId, Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "StrTradeCommitmentDate")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","index:=3"), FRM_DS_GetValue(objData, "StrTradeCommitmentDate")
			FRM_Logger_ReportInfoEvent "Commitment Date","Start Commitment Date Entered - "&FRM_DS_GetValue(objData, "StrTradeCommitmentDate"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCommitmentType")) Then
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbCommitmentType"), FRM_DS_GetValue(objData, "strCommitmentType")
			FRM_Logger_ReportInfoEvent "Commitment Type","Commitment Type Entered - "&FRM_DS_GetValue(objData, "StrTradeCommitmentDate"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeDescription")) Then
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbTradeDesc"), FRM_DS_GetValue(objData, "strTradeDescription")
			FRM_Logger_ReportInfoEvent "Trade Description","Trade Description Entered - "&FRM_DS_GetValue(objData, "strTradeDescription"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strInvestorName")) Then
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnInvestorTemplate")
			GUI_Object_IsExistX objInvestorTemplate.SwfObject("swfname:=gvTemplates"),30
			GUI_List_ClickRow objInvestorTemplate.SwfObject("swfname:=gvTemplates"), Null, "Investor Name", FRM_DS_GetValue(objData, "strInvestorName"), True, False, False, "Single"
			GUI_SwfButton_Click objInvestorTemplate.SwfButton("swfname:=btnOK")
			FRM_Logger_ReportInfoEvent "Investor Name","Investor Name Entered - "&FRM_DS_GetValue(objData, "strInvestorName"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeamount")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtAmount"), FRM_DS_GetValue(objData, "strTradeamount")
			FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Trade Amount","Trade Amount Data Entered - "&FRM_DS_GetValue(objData, "strTradeamount"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strInputTolerance")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTolerance"), FRM_DS_GetValue(objData, "strInputTolerance")
			FRM_Logger_ReportInfoEvent "Trade Tolreance","Trade Tolerance Entered - "&FRM_DS_GetValue(objData, "strInputTolerance"), Null
		End If
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
		'Pricing
		GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"),"Pricing"
		GUI_Object_WaitTillVisibleX objHomePage.SwfObject("swfname:=btnAdd","index:=1"),30
		
		If GUI_Object_IsExist(objHomePage.SwfObject("swfname:=btnAdd","index:=1")) Then
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnAdd","index:=1")
			If GUI_Object_IsExist(objAddPric) Then
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtRate"), FRM_DS_GetValue(objData, "NoteRateValue")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtPrice"), FRM_DS_GetValue(objData, "Price")
				GUI_SwfButton_Click objAddPric.SwfButton("swfname:=btnAddAnother")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtRate"), FRM_DS_GetValue(objData, "NoteRateValue1")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtPrice"), FRM_DS_GetValue(objData, "Price1")
				GUI_SwfButton_Click objAddPric.SwfButton("swfname:=btnAddAnother")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtRate"), FRM_DS_GetValue(objData, "NoteRateValue2")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtPrice"), FRM_DS_GetValue(objData, "Price2")
				GUI_SwfButton_Click objAddPric.SwfButton("swfname:=btnOK")
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
		
				intRow = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvPricing","index:=1"))
				If intRow<=3 Then
					FRM_Logger_ReportInfoEvent "Rows after Price Add","All the Pricing information Populated", Null
				Else
					FRM_Logger_ReportFailEvent "Rows after Price Add","All the Pricing information not Populated", Null
				End If
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnList")
			End If
		End If
		
	Else
		FRM_Logger_ReportFailEvent "New Trade Security","New Trade page not highlighted the Details tab", Null
	End If
	
	BIZ_SecondaryMarket_CreateNewTradeLoan=strTradeId

End Function



'This function is used to Create the Security trade
'@code
'   Function BIZ_SecondaryMarket_CreateNewSecurityTradeLoan(strRowLoan)
'@endcode
'@param strRowLoan - Get the details from the Excel

Function BIZ_SecondaryMarket_CreateNewSecurityTradeLoan(strRowLoan)
	
	FRM_Logger_ReportInfoEvent "Start Test Case Trade Security","Navigate to Security Trades SecondaryMarket_NavigationTOSecurityTrade", Null
	
	Set objData = FRM_DS_GetTestData("SecondaryMarket", "TradeLoan", strRowLoan)
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objTradeStartUpdate = SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
	Set objBTNNewTrade=objHomePage.SwfObject("swfname:=btnNew")
	Set objLBLNewTrade=objHomePage.SwfObject("swfname:=groupContainer1")
	Set objAddPric = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SecurityTradePairOffDialog")
	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
	If GUI_Object_IsExistX(objLBLNewTrade, 60) Then
		FRM_Logger_ReportInfoEvent "Security Loan Trade Security","New Security Trade page should be opened highlighting the Details tab", Null
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strSecurityID")) Then
			strTradeId = (FRM_DS_GetValue(objData, "strSecurityID"))
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtName"), strTradeId
			FRM_Logger_ReportInfoEvent "Trade Id Name","Trade ID Name Entered - "&strTradeId, Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCommitmentType")) Then
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cboCommitmentType"), FRM_DS_GetValue(objData, "strCommitmentType")
			FRM_Logger_ReportInfoEvent "Commitment Type","Commitment Type Entered - "&FRM_DS_GetValue(objData, "strCommitmentType"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeDescription")) Then
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cboTradeDescription"), FRM_DS_GetValue(objData, "strTradeDescription")
			FRM_Logger_ReportInfoEvent "Trade Description","Trade Description Entered - "&FRM_DS_GetValue(objData, "strTradeDescription"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strProgramType")) Then
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cboProgramType"), FRM_DS_GetValue(objData, "strProgramType")
			FRM_Logger_ReportInfoEvent "Program Type","Program Type Entered - "&FRM_DS_GetValue(objData, "strProgramType"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeamount")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtAmount"), FRM_DS_GetValue(objData, "strTradeamount")
			FRM_Logger_ReportInfoEvent "Trade Amount","Trade Amount Entered - "&FRM_DS_GetValue(objData, "strTradeamount"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strInputTolerance")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTolerance"), FRM_DS_GetValue(objData, "strInputTolerance")
			FRM_Logger_ReportInfoEvent "Trade Tolerance","Trade Tolerance Entered - "&FRM_DS_GetValue(objData, "strInputTolerance"), Null
		End If
		intMinText = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=txtMinAmt"), "text")
		intMaxText = GUI_Object_GetPropertyValue(objHomePage.SwfEdit("swfname:=txtMaxAmt"), "text")
		FRM_VerifyEqual Replace(intMinText,",",,""), cint(FRM_DS_GetValue(objData, "intMinAmount")), "Trade Min Amount", "Trade Minimum amount valiadation"
		FRM_VerifyEqual Replace(intMaxText,",",,""), cint(FRM_DS_GetValue(objData, "intMaxAmount")), "Trade Min Amount", "Trade Minimum amount valiadation"
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTextDate")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","index:=3"), FRM_DS_GetValue(objData, "strTextDate")
			FRM_Logger_ReportInfoEvent "Trade Commitment Date","Trade Commitment Date Entered - "&FRM_DS_GetValue(objData, "strTextDate"), Null
		End If
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
		'Pair-Off 
		If GUI_Object_IsExist(objHomePage.SwfObject("swfname:=gvPairOffs","index:=1")) Then
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=gvPairOffs","index:=1")
			boolExists = GUI_List_ClickRow(objHomePage.SwfObject("swfname:=gvPairOffs","index:=1"), Null, "Pair-Off #", "Pair-Off 1", True, False, False, "Double")
			If boolExists Then
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtDate"), FRM_DS_GetValue(objData, "StrTradeCommitmentDate")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtTradeAmount"), FRM_DS_GetValue(objData, "strAssignTradeamount")
				GUI_SwfEdit_Set objAddPric.SwfEdit("swfname:=txtBuyPrice"), FRM_DS_GetValue(objData, "strPairOfBuyPrice")
				GUI_SwfButton_Click objAddPric.SwfButton("swfname:=btnOK")
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
				intRow = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvPairOffs","index:=1"))
				If intRow>=0 Then
					FRM_Logger_ReportInfoEvent "Rows after Pair-Off Add","All the Pair-Off information Populated", Null
				Else
					FRM_Logger_ReportFailEvent "Rows after Pair-Off Add","All the Pair-Off information not Populated", Null
				End If
			End If
		End If
	Else
		FRM_Logger_ReportFailEvent "New Trade Security","New Trade page not highlighted the Details tab", Null
	End If
	
	BIZ_SecondaryMarket_CreateNewSecurityTradeLoan=strTradeId

End Function



'This function is used to Create the Correspondent Loan trade
'@code
'   Function BIZ_SecondaryMarket_CorrespondentLoanTradeCreation(strRow)
'@endcode
'@param strRow - Get the details from the Excel

Function BIZ_SecondaryMarket_CorrespondentLoanTradeCreation(strRow)
	
	FRM_Logger_ReportInfoEvent "StartLoanTradeCreation","Prequiste - BIZ_SecondaryMarket_CorrespondentLoanTradeCreation", Null
	
	Dim objMainFormWnd,objHomePage,objData,objPricingDialog,strTradeId,objInvestorTemplate
	
	Set objMainFormWnd  = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer")
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objData         = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie",strRow)
	Set objPricingDialog= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=AddPricingItemDialog")
	Set objInvestorTemplate = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=InvestorTemplateSelector")
	
	strTradeId= FRM_DS_GetValue(objData, "strPoolId")
		
	If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=btnNew"), 60) Then
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
		If UTIL_String_IsNotEmpty(strTradeId) Then	
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtName","index:=0"), strTradeId
			FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Trade id Type","Trade id Type  Data Entered - "&strTradeId, Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCommitmentType")) Then	
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbCommitmentType"), FRM_DS_GetValue(objData, "strCommitmentType")
			FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Commitment Type","Commitment Type Data Entered - "&FRM_DS_GetValue(objData, "strCommitmentType"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeDescription")) Then	
			GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbTradeDesc"), FRM_DS_GetValue(objData, "strTradeDescription")
			FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Trade description","Trade description Data Entered - "&FRM_DS_GetValue(objData, "strTradeDescription"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strInvestorName")) Then	
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnInvestorTemplate")
			GUI_Object_IsExistX objInvestorTemplate.SwfObject("swfname:=gvTemplates"),30
			GUI_List_ClickRow objInvestorTemplate.SwfObject("swfname:=gvTemplates"), Null, "Investor Name", FRM_DS_GetValue(objData, "strInvestorName"), True, False, False, "Single"
			GUI_SwfButton_Click objInvestorTemplate.SwfButton("swfname:=btnOK")
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strAssignTradeamount")) Then	
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtAmount","index:=0"), FRM_DS_GetValue(objData, "strAssignTradeamount")
			FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Trade Amount","Trade Amount  Data Entered - "&FRM_DS_GetValue(objData, "strAssignTradeamount"), Null
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strAssignInputTolerance")) Then	
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTolerance","index:=0"), FRM_DS_GetValue(objData, "strAssignInputTolerance")
			FRM_Logger_ReportInfoEvent "Start Loan Data Creation--Tolerance","Tolerance  Data Entered - "&FRM_DS_GetValue(objData, "strAssignInputTolerance"), Nul
		End If
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
		GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"), "Pricing"
		If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=btnAdd","index:=1"),60) Then
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnAdd","index:=1")
			FRM_Logger_ReportPassEvent "Click on Add Pricing data", "Add Pricing button Clicked", Null
			If GUI_Object_IsExistX(objPricingDialog,60) Then
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NoteRateValue")) Then	
					GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txtRate","index:=0"), FRM_DS_GetValue(objData, "NoteRateValue")
					FRM_Logger_ReportInfoEvent "Pricing Data--NoteRateValue","NoteRateValue  Data Entered - "&FRM_DS_GetValue(objData, "NoteRateValue"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Price")) Then	
					GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txtPrice","index:=0"), FRM_DS_GetValue(objData, "Price")
					FRM_Logger_ReportInfoEvent "Pricing Data--Price","Price  Data Entered - "&FRM_DS_GetValue(objData, "Price"), Null
				End If
				GUI_SwfButton_Click objPricingDialog.SwfButton("swfname:=btnAddAnother")
				FRM_Logger_ReportInfoEvent "Add another Button", "Add another Button clicked", Null
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NoteRateValue1")) Then	
					GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txtRate","index:=0"), FRM_DS_GetValue(objData, "NoteRateValue1")
					FRM_Logger_ReportInfoEvent "Pricing Data--NoteRateValue","NoteRateValue  Data Entered - "&FRM_DS_GetValue(objData, "NoteRateValue1"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Price")) Then	
					GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txtPrice","index:=0"), FRM_DS_GetValue(objData, "Price1")
					FRM_Logger_ReportInfoEvent "Pricing Data--Price","Price  Data Entered - "&FRM_DS_GetValue(objData, "Price1"), Null
				End If
				GUI_SwfButton_Click objPricingDialog.SwfButton("swfname:=btnAddAnother")
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NoteRateValue2")) Then	
					GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txtRate","index:=0"), FRM_DS_GetValue(objData, "NoteRateValue2")
					FRM_Logger_ReportInfoEvent "Pricing Data--NoteRateValue","NoteRateValue  Data Entered - "&FRM_DS_GetValue(objData, "NoteRateValue2"), Null
				End If
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Price2")) Then	
					GUI_SwfEdit_Set objPricingDialog.SwfEdit("swfname:=txtPrice","index:=0"), FRM_DS_GetValue(objData, "Price2")
					FRM_Logger_ReportInfoEvent "Pricing Data--Price","Price  Data Entered - "&FRM_DS_GetValue(objData, "Price2"), Null
				End If
				GUI_SwfButton_Click objPricingDialog.SwfButton("swfname:=btnOK")
				If GUI_Object_IsEnabled(objHomePage.SwfObject("swfname:=btnSave"),60) Then
					GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
				End If
				If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=btnTrades"),60) Then
					GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnTrades")
					If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=gvTradeList"),60) Then
						intTblNameRowindex = GUI_List_GetRowIndex(objHomePage.SwfObject("swfname:=gvTradeList"), "Trade ID",Trim(strTradeId)) 
	    				GUI_List_ValidateCellData objHomePage.SwfObject("swfname:=gvTradeList"), intTblNameRowindex, "Trade ID", strTradeId
					Else
						FRM_Logger_ReportFailEvent "Add pricing Data dialog box should be opened", "Add pricing Data dialog box is not opened", Null
					End If
				End If
			End If
		End If
	End If	
	Set objMainFormWnd   	= Nothing
	Set objHomePage	     	= Nothing
	Set objData         	= Nothing  
	Set objPricingDialog    = Nothing	
	Set objInvestorTemplate = Nothing	
	
	BIZ_SecondaryMarket_CorrespondentLoanTradeCreation = strTradeId
	
End Function



'This function is used to Edit Existing Trade
'@code
'   Function BIZ_SecondaryMarket_LoanEditExistingTrade(strColValue,strRow)
'@endcode
'@param strColValue - is used to assign pool value
'@param strRow - Get the details from the Excel

Function BIZ_SecondaryMarket_LoanEditExistingTrade(strColValue,strRow)
		
	FRM_Logger_ReportInfoEvent "StartEdit Existing LoanTrade","BIZ_SecondaryMarket_LoanEditExistingTrade", Null
	Dim objSettings,objLoanList,objLoanAssignment,objLoanAssignmentResult
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")  
    Set objLoanList = objHomePage.SwfObject("swfname:=gvTradeList")
	Set objLoanAssignment= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=LoanAssignmentFromFileImport")
	Set objLoanAssignmentResult= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanUpdateCompleteDialog")
	Set objLoanSyncDialog= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanSyncDlg")
		
	If GUI_Object_IsExistX(objLoanList, 60) Then
		BIZ_SecondaryMarket_Nav_Tradedetails strColValue,1
		If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=btnEdit"), 20) Then
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnEdit")
			If GUI_Object_IsExistX(objHomePage.SwfTab("swfname:=tabTrade"), 30) Then
				GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"), "Loans"
				If Not GUI_Object_GetPropertyValue(objHomePage.SwfCheckBox("swfname:=chkViewEligible"),"checked") Then
					GUI_SwfObject_Click objHomePage.SwfCheckBox("swfname:=chkViewEligible")
				End If
			End If
		End If	 
	End IF
	Set objLoanList=nothing

End Function



'This function is used to Edit Existing Trade
'@code
'   Function BIZ_SecondaryMarket_CorrespondentLoanEditExistingTrade(strColValue,strRow)
'@endcode
'@param strColValue - is used to assign pool value
'@param strRow - Get the details from the Excel

Function BIZ_SecondaryMarket_CorrespondentLoanEditExistingTrade(strColValue,strRow)
		
	FRM_Logger_ReportInfoEvent "StartEdit Existing LoanTrade","BIZ_SecondaryMarket_LoanEditExistingTrade", Null
	Dim objHomePage,objCorrespondentTrade, objThirdpartyOriginator,objData
	
	Set objHomePage = SwfWindow("swfname:=MainForm").Swfwindow("swfname:=MainScreen")
	Set objCorrespondentTrade= SwfWindow("swfname:=MainForm").Swfwindow("swfname:=NewCorrespondentTrade")
	Set objThirdpartyOriginator= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objData = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strRowID)
   		
	BIZ_Nav_SelectTabControl "Trades"
	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnCorrespondentTrades")
	
	GUI_Object_IsExistX objHomePage.SwfObject("swfname:=btnNew"), 20
	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
    GUI_Object_IsExistX objCorrespondentTrade.SwfObject("swfname:=btnSelector"), 20
    GUI_SwfObject_Click	objCorrespondentTrade.SwfObject("swfname:=btnSelector")	
	GUI_List_ClickRow objThirdpartyOriginator.SwfObject("swfname:=grd3rdParties"), Null, 0, "Prolifics TPO", True, False, False, "Single"
	GUI_SwfButton_Click	objThirdpartyOriginator.SwfButton("swfname:=btnSelect")	
	GUI_SwfRadioButton_Click objCorrespondentTrade.SwfRadioButton("swfname:=rdoMandatory")
	GUI_SwfButton_Click	objCorrespondentTrade.SwfButton("swfname:=btnSave")
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strPoolId")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtCommitmentNumber"), FRM_DS_GetValue(objData, "strPoolId")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment---"&FRM_DS_GetValue(objData, "strPoolId"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateCommitment")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate"), FRM_DS_GetValue(objData, "dateCommitment")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment date---"&FRM_DS_GetValue(objData, "dateCommitment"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeDescription")) Then
		GUI_SwfEdit_Set objHomePage.SwfComboBox("swfname:=cmbTradeDesc"), FRM_DS_GetValue(objData, "strTradeDescription")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment description---"&FRM_DS_GetValue(objData, "strTradeDescription"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "MasterCommitment")) Then
		GUI_SwfEdit_Set objHomePage.SwfComboBox("swfname:=cboMasters"), FRM_DS_GetValue(objData, "MasterCommitment")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment MasterCommitment---"&FRM_DS_GetValue(objData, "MasterCommitment"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DeliveryType")) Then
		GUI_SwfEdit_Set objHomePage.SwfComboBox("swfname:=cmbDeliveryType"), FRM_DS_GetValue(objData, "DeliveryType")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment DeliveryType---"&FRM_DS_GetValue(objData, "DeliveryType"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "intPoolAmount")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtAmount"), FRM_DS_GetValue(objData, "intPoolAmount")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment Trade Amount---"&FRM_DS_GetValue(objData, "intPoolAmount"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strAssignInputTolerance")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTolerance"), FRM_DS_GetValue(objData, "strAssignInputTolerance")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment Tolerance---"&FRM_DS_GetValue(objData, "strAssignInputTolerance"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateInvestorDelivery")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","index:=2"), FRM_DS_GetValue(objData, "dateInvestorDelivery")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment Expiration date---"&FRM_DS_GetValue(objData, "dateInvestorDelivery"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateInvestorDelivery")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","index:=0"), FRM_DS_GetValue(objData, "dateInvestorDelivery")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment Delivery Expiration date---"&FRM_DS_GetValue(objData, "dateInvestorDelivery"), Null
	End If

	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "MasterEffective")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtExpirationDate;panel2;.*"), FRM_DS_GetValue(objData, "MasterEffective")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Master Effective date---"&FRM_DS_GetValue(objData, "MasterEffective"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "MasterExpiry")) Then
		GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtDeliveryExpirationDate;panel2;.*"), FRM_DS_GetValue(objData, "MasterExpiry")
		FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment description---"&FRM_DS_GetValue(objData, "MasterExpiry"), Null
	End If
	
	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
	
	Set objHomePage 		   = Nothing
	Set objCorrespondentTrade  = Nothing
	Set objThirdpartyOriginator= Nothing
	Set objData 			   = Nothing

End Function



'This function is used to Remove the Loan from Trades
'@code
'   Function BIZ_SecondaryMarket_Trades_Loans_RemoveCorrespondentLoan()
'@endcode

Function BIZ_SecondaryMarket_Trades_Loans_RemoveCorrespondentLoan()
	FRM_Logger_ReportInfoEvent "Start Loan Deletion","Loans updation for Pool- BIZ_SecondaryMarket_Trades_Loans_Remove", Null

	Dim objHomePage, objGridStatus
	
	Set objHomePage = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	set objNoti = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=TradeLoanUpdateNotificationDialog")
	
	intRow1 = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvLoans"))
	If intRow1>=0 Then
		 GUI_List_ActOnRow objHomePage.SwfObject("swfname:=gvLoans"), intRow1-1, False, False, False, "Single"
		 
		'GUI_List_ClickRow objHomePage.SwfObject("swfname:=gvLoans"), Null, "Trade Assignment", "Assigned", False, False, False, "Single"
		FRM_Logger_ReportInfoEvent "Select Loan","Selected the Loan", Null
	
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnRemoveLoans")
		FRM_Logger_ReportInfoEvent "Remove Button","Clicked on remove Button", Null
			
		GUI_Object_IsExistX SwfWindow("swfname:=MainForm").SWfwindow("swfname:=RemoveLoansOptionsDialog").SwfButton("swfname:=btnYes"), 30
		
		If GUI_Object_IsExist (SwfWindow("swfname:=MainForm").SWfwindow("swfname:=RemoveLoansOptionsDialog").SwfButton("swfname:=btnYes"))Then
			
			GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SWfwindow("swfname:=RemoveLoansOptionsDialog").SwfButton("swfname:=btnYes")
			FRM_Logger_ReportInfoEvent "DiaLog Button for Delete Loan","Clicked on DiaLog Button for Pool", Null
	
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
			FRM_Logger_ReportInfoEvent "Save Details for Loan","Clicked on Save Button for Pool", Null
				
			strDataText = SwfWindow("swfname:=MainForm").DiaLog("text:=EnCompass").Static("index:=0").GetROProperty("text")
			
			If Util_String_IsMatch(Replace(strDataText,vbCrLf,"") ,"The Fannie Mae PE MBS Pool has been saved successfully.Would you like to update the loan files with these recent changes?")Then
				GUI_Dialog_Encompass_YesX 15, Null
				If GUI_Object_IsExist(SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")) Then
					GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsPoolLoanSyncDlg").SwfButton("swfname:=btnOK")
					GUI_Dialog_Encompass_OK "MBS Pool "&strPoolName&" has been successfully submitted for update and is in pending status"
				End If
				GUI_Dialog_Encompass_OK "*. has been successfully submitted for update and is in pending status"
			
			Else
				GUI_Dialog_Encompass_YesX 15, Null
				GUI_SwfButton_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
				GUI_Dialog_Encompass_OKX 15, Null
			End If	
			If GUI_Object_IsExist(objNoti) then
				GUI_Window_Close objNoti
			End IF
			GUI_SwfObject_Click objHomePage.swfObject("swfname:=btnList")
		End If
		
	Else
		FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
	End If
	
	Set objHomePage = Nothing
	
End Function



'This function is used to Remove the Loan from Trades
'@code
'   Function BIZ_SecondaryMarket_Trades_CorrespondentLoans_SecondaryRegistration(strPoolName,strPoolType)
'@endcode
'@param strPoolName to verify correspondent loan
'@param strPoolType get data from excel

Function BIZ_SecondaryMarket_Trades_CorrespondentLoans_SecondaryRegistration(strPoolName, strPoolType)

	FRM_Logger_ReportInfoEvent "Start Secondary Registration","Loans updation for Pool- BIZ_SecondaryMarket_Trades_Loans_SecondaryRegistration", Null

	Dim objHomePage, objGridStatus, intRow1
	
	Set objHomePage    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objGridStatus  = SwfWindow("swfname:=MainForm").SwfObject("swfname:=gridSnapshot")
	Set objLoanPage    = objHomePage.SWfwindow("swfname:=LoanPage")
	Set objData        = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie", strPoolType)
	
	intRow1 = GUI_List_GetNumberofRows(objHomePage.SwfObject("swfname:=gvLoans"))
	
	If intRow1 >= 0 Then
		strLoanNumber = GUI_List_GetCellData(objHomePage.SwfObject("swfname:=gvLoans"),0, 2)
		BIZ_Pipeline_SelectPipelineViewAndLoanFolder "Administrator - Default View", "<All Folders>"
		BIZ_Loan_OpenByLoanNumber strLoanNumber
		BIZ_SecondaryMarket_ToolsNavigation "Secondary Registration"
		
		intRow2 = GUI_List_GetNumberofRows(objLoanPage.SwfObject("swfname:=gridSnapshot"))
		
		If intRow2 <0 Then
			FRM_Logger_ReportPassEvent "Records","Records not available", Null
		Else
			FRM_Logger_ReportFailEvent "Records","Records  available", Null
		End If
		
		BIZ_Loan_Exit False
	Else
		FRM_Logger_ReportFailEvent "Loans Assigned","Loan not Assigned to Pool", Null
	End If
	
	Set objHomePage    = Nothing
	Set objGridStatus  = Nothing
	Set objLoanPage	   = Nothing
	
End Function



'This function is used to validate the warning message for Desk Lock hours
'@code
'   BIZ_SecondaryMarket_TPOSettingsForCorrespondentLoan(strTPOName, strTreeViewName)
'@endcode
'@param

Function BIZ_SecondaryMarket_TPOSettingsForCorrespondentLoan(strTPOName, strTreeViewName)
	
	FRM_Logger_ReportInfoEvent "Start TPO Settings","Scrpit Name - BIZ_SecondaryMarket_TPOSettingsForChannelDefault", Null
	
	Dim objONRPDetailsPage
	Set objSetupContainer = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer")
	Set objONRPDetailsPage = objSetupContainer.SwfWindow("swfname:=EditCompanyDetailsDialog")
	
	Set objAddSalesRepForm=objONRPDetailsPage.SwfWindow("swfname:=AddSalesRepForm")
	
	BIZ_Nav_OpenMenuItem "Encompass;Settings..."
	BIZ_Nav_HierarchyTree "External Company Setup", "Company Details"
	
		
	GUI_SwfTreeView_Select SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfTreeView("swfname:=hierarchyTree"), strTreeViewName	
	FRM_Logger_ReportInfoEvent "Navigate to Hierarchy Tree","Navigated to Third party Originators", Null
	
	GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfObject("swfname:=stdIconBtnNewOrg")
	FRM_Logger_ReportInfoEvent "Click on New Object","Clicked on New Object", Null
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strOrgnization")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtOrgName"), FRM_DS_GetValue(objData, "strOrgnization")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strOrgnization"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strOrgType")) Then
		GUI_SwfComboBox_Select objONRPDetailsPage.SwfComboBox("swfname:=cmbOnrpSunEndBN","index:=0"),FRM_DS_GetValue(objData, "strOrgType")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strOrgType"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "ChannelType")) Then
		GUI_SwfCheckbox_Set objONRPDetailsPage.SwfCheckBox("swfname:=chkBroker"), "On"
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "ChannelType"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "ChannelType")) Then
		GUI_SwfCheckbox_Set objONRPDetailsPage.SwfCheckBox("swfname:=chkCorrespondent"), "On"
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "ChannelType"), Null
	End If
	
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCompanyLegalName")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtName"), FRM_DS_GetValue(objData, "strCompanyLegalName")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strCompanyLegalName"), Null
	End If
	
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strAddress")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtAddress"), FRM_DS_GetValue(objData, "strAddress")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strAddress"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCity")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtCity"), FRM_DS_GetValue(objData, "strCity")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strCity"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strState")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=cboStateAddr"), FRM_DS_GetValue(objData, "strState")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strState"), Null
	End If
	
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zipcode")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtZip"), FRM_DS_GetValue(objData, "Zipcode")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "Zipcode"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "PhoneNumber")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtPhone"), FRM_DS_GetValue(objData, "PhoneNumber")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "PhoneNumber"), Null
	End If
	
	GUI_SwfObject_Click objONRPDetailsPage.SwfObject("swfname:=btnAddRep")
	
	 If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strPrimarySales")) Then 
       GUI_List_Select objONRPDetailsPage,  FRM_DS_GetValue(objData, "strPrimarySales")
    End If  
	
		
	GUI_SwfButton_Click objSendRequest.SwfButton("text:=btnOK")
	
	GUI_SwfObject_Click objONRPDetailsPage.SwfObject("swfname:=btnSave")
	
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Commitment")) Then 
       GUI_SwfTab_Click objONRPDetailsPage.SwfTab("swfname:=tabControlExAll"), FRM_DS_GetValue(objData, "Commitment")
    End If 
	 
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "Mandatory")) Then
		GUI_SwfCheckbox_Set objONRPDetailsPage.SwfCheckBox("swfname:=chbMandatory"), "On"
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "Mandatory"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "BulkCheckBox")) Then
	
	x= GUI_List_GetRowIndex(objONRPDetailsPage.SwfObject("swfname:=gvDelivery"),"Delivery Type",FRM_DS_GetValue(objData, "BulkCheckBox"))
	If x>=0 Then
		
		GUI_List_ClickRow objONRPDetailsPage.SwfObject("swfname:=gvDelivery"), Null, "Delivery Type",FRM_DS_GetValue(objData, "BulkCheckBox"), True, False, False, "Double"
	End If
			
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "BulkCheckBox"), Null
	End If
	
	If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strmaxcommitAmount")) Then
		GUI_SwfEdit_Set objONRPDetailsPage.SwfEdit("swfname:=txtMaxAmount"), FRM_DS_GetValue(objData, "strmaxcommitAmount")
		FRM_Logger_ReportInfoEvent "Company details","Start Company details---"&FRM_DS_GetValue(objData, "strmaxcommitAmount"), Null
	End If
	
	GUI_SwfObject_Click objONRPDetailsPage.SwfObject("swfname:=btnSave")
	GUI_Window_Close objONRPDetailsPage
	
	GUI_Window_Close SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer")

	Set objONRPDetailsPage = Nothing
End Function



'This function is used to deletion of correspondent Master commitment
'@code
'   Function BIZ_Trades_DeleteCommitment(strCommitmentName)
'@endcode
'@param strCommitmentName - Commitment Name

Function BIZ_Trades_DeleteCommitment(strCommitmentName)
	FRM_Logger_ReportInfoEvent "Correspondnet Master","Start Correspondnet Master Delete---"&strCommitmentName, Null
	
	Dim objHomePage,objData
	
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	
	If GUI_Object_ISExistX(objHomePage.SwfObject("swfname:=gvMain"), 60) Then
		intRow = GUI_List_GetRowIndex(objHomePage.SwfObject("swfname:=gvMain"), "Master Commitment #", strCommitmentName)
		If intRow>=0 Then
			GUI_List_ActOnRow objHomePage.SwfObject("swfname:=gvMain"), intRow+1, True, False, False, "Single"
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnDelete")
			GUI_Dialog_Encompass_YesX 15, Null
			GUI_Dialog_Encompass_OKX 15, Null
			boolExist1 = GUI_List_ClickRow(objHomePage.SwfObject("swfname:=gvMain"), Null, "Master Commitment #", strCommitmentName, True, False, False, "Single")
			FRM_VerifyEqual boolExist1, False, "Delete Commitment","Commitment Deeleted"
		Else
			FRM_Logger_ReportFailEvent "Correspondnet Master","Correspondnet Master not exists ---", Null
		End If
	Else
		FRM_Logger_ReportFailEvent "Correspondnet Master Page","Correspondnet Master Page not exists ---", Null
	End If
	
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	
End Function



'This function is used to deletion of correspondent Trade
'@code
'   Function BIZ_Trades_DeleteCorrespondenetTrade(strTradeName)
'@endcode
'@param strTradeName - Trade Name

Function BIZ_Trades_DeleteTrade(strTradeName)
	FRM_Logger_ReportInfoEvent "Correspondnet Trade Delete","Start Correspondnet Trade Delete---"&strTradeName, Null
	
	Dim objHomePage,objData
	
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objTPOPage      = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objDeliPage     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=CorrespondentDeliveryType")
	
	If GUI_Object_ISExistX(objHomePage.SwfObject("swfname:=gvTradeList"), 60) Then
		SwfWindow("swfname:=MainForm").SwfEdit("swfname:=txtBox","index:=1").Set strTradeName
		UTIL_Win_SendKey "{ENTER}"
		intRow = GUI_List_GetRowIndex(objHomePage.SwfObject("swfname:=gvTradeList"), "Commitment Number", strTradeName)
		If intRow>=0 Then
			GUI_List_ActOnRow objHomePage.SwfObject("swfname:=gvTradeList"), intRow+1, True, False, False, "Single"
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnDelete")
			GUI_Dialog_Encompass_YesX 15, Null
			GUI_Dialog_Encompass_OKX 15, Null
			boolExist1 = GUI_List_ClickRow(objHomePage.SwfObject("swfname:=gvTradeList"), objHomePage.SwfObject("swfname:=gvTradeList").SwfScrollBar("swfname:=vPanelScrollBar"), "Commitment Number", strTradeName, True, False, False, "Single")
			FRM_VerifyEqual boolExist1, False, "Delete Trade","Trade Deeleted"
		Else
			FRM_Logger_ReportFailEvent "Correspondnet Trade Delete","Correspondnet Trade not  Exists---"&strTradeName, Null
		End If
	Else
		FRM_Logger_ReportFailEvent "Correspondnet Trade Page","Correspondnet Trade not Page---", Null
	End If
	
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	
End Function


'This function is used to deletion of correspondent Master commitment
'@code
'   Function BIZ_Trades_DeleteCommitmentwithoutDeletingDeliveryType(strRowID, strCommitmentName)
'@endcode
'@param strRow - Get the details from the Excel
'@param strCommitmentName - Commitment Name

Function BIZ_Trades_CommitmentDeletingDeliveryType(strCommitmentName)
	FRM_Logger_ReportInfoEvent "Correspondnet Master Delete","Start Correspondnet Master Delete---"&strRowID, Null
	
	Dim objHomePage,objData
	
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objTPOPage      = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objDeliPage     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=CorrespondentDeliveryType")
	
	If GUI_Object_ISExistX(objHomePage.SwfObject("swfname:=gvMain"), 60) Then
		intRow = GUI_List_GetRowIndex(objHomePage.SwfObject("swfname:=gvMain"), "Master Commitment #", strCommitmentName)
		If intRow>=0 Then
			GUI_List_ActOnRow objHomePage.SwfObject("swfname:=gvMain"), intRow+1, True, False, False, "Double"
			boolExist1 = GUI_List_ClickRow(objHomePage.SwfObject("swfname:=grdDeliveryMethod"), Null, "Delivery Type", "Individual Mandatory", True, False, False, "Single")
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnDeleteDelivery")
			boolExist2 = GUI_List_ClickRow(objHomePage.SwfObject("swfname:=grdDeliveryMethod"), Null, "Delivery Type", "Individual Mandatory", True, False, False, "Single")
			FRM_VerifyEqual boolExist2, False, "Delete Delivery Type", "Delivery Type deltion"
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnClose")
			GUI_Dialog_Encompass_NoX 15, Null
		Else
			FRM_Logger_ReportFailEvent "Correspondnet Master Delete","Correspondnet Master not Delete---"&strRowID, Null
		End If
	Else
		FRM_Logger_ReportFailEvent "Correspondnet Master Page","Correspondnet Master not Page---", Null
	End If
	
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	
End Function



'This function is used to deletion of correspondent Master commitment
'@code
'   Function BIZ_Trades_DeleteCommitmentwithoutDeletingDeliveryType(strRowID, strCommitmentName)
'@endcode
'@param strRow - Get the details from the Excel
'@param strCommitmentName - Commitment Name

Function BIZ_Trades_DeleteCommitmentwithoutDeletingDeliveryType(strRowID, strCommitmentName)
	FRM_Logger_ReportInfoEvent "Correspondnet Master Delete","Start Correspondnet Master Delete---"&strRowID, Null
	
	Dim objHomePage,objData
	
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objTPOPage      = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objDeliPage     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=CorrespondentDeliveryType")
	
	If GUI_Object_ISExistX(objHomePage.SwfObject("swfname:=gvMain"), 60) Then
		boolExist = GUI_List_ClickRow(objHomePage.SwfObject("swfname:=gvMain"), Null, "Master Commitment #", strCommitmentName, True, False, False, "Single")
		If boolExist Then
			GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnDelete")
			If GUI_Object_IsExistX(SwfWindow("swfname:=MainForm").DiaLog("text:=Encompass"), 60) Then
				strText = GUI_Object_GetPropertyValue(SwfWindow("swfname:=MainForm").DiaLog("text:=Encompass").Static("index:=1"), "text")
				GUI_Dialog_Encompass_OKX 15, Null
				FRM_Logger_ReportInfoEvent "Delete Message","Clicked on Delete Dialog msgbox --"&strText, Null
			End If
		End If
	End If
	
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	
End Function



'This function is used to create correspondent Master commitment
'@code
'   Function BIZ_Trades_CreateCorrespondentMasters(strRowID)
'@endcode
'@param strRow - Get the details from the Excel

Function BIZ_Trades_CreateCorrespondentMasters(strRowID)
	FRM_Logger_ReportInfoEvent "Correspondnet Master Creation","Start Correspondnet Master Creation---"&strRowID, Null
	
	Dim objMainFormWnd,objHomePage,objData,objTPOPage,strTradeId,objDeliPage
	
	Set objMainFormWnd  = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=NewCorrespondentMaster")
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objData         = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie",strRowID)
	Set objTPOPage      = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objDeliPage     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=CorrespondentDeliveryType")
	
	strTradeId= FRM_DS_GetValue(objData, "MasterCommitment")
	
	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
	If GUI_Object_IsExistX(objMainFormWnd.SwfObject("swfname:=btnSelector"), 60) Then
		GUI_SwfObject_Click objMainFormWnd.SwfObject("swfname:=btnSelector")
		FRM_Logger_ReportInfoEvent "Magnify Glass","Clicked on Magnifying Glass", Null
		If GUI_Object_IsExistX(objTPOPage.SwfObject("swfname:=grd3rdParties"), 60) Then
			intRow = GUI_List_GetRowIndex(objTPOPage.SwfObject("swfname:=grd3rdParties"), "Organization Name", "Prolifics TPO")

			GUI_List_ActOnRow objTPOPage.SwfObject("swfname:=grd3rdParties"), intRow+1, True, False, False, "Single"
	
			GUI_SwfButton_Click	objTPOPage.SwfButton("swfname:=btnSelect")
			FRM_Logger_ReportInfoEvent "Select Button","Clicked on Selected Button", Null
			
			GUI_SwfRadioButton_Click objMainFormWnd.SwfRadioButton("swfname:=chkMandatory")
			FRM_Logger_ReportInfoEvent "Mandatory","Clicked on Mandatory Radio Button", Null
			
			GUI_SwfButton_Click	objMainFormWnd.SwfButton("swfname:=btnSave")
			FRM_Logger_ReportInfoEvent "OK Button","Clicked on OK Button", Null
			
			If GUI_Object_IsExistX( objHomePage.SwfEdit("swfname:=txtNumber"), 60) Then
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "MasterCommitment")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtNumber"), strTradeId
					FRM_Logger_ReportInfoEvent "Commitment ID","Start Correspondent Trade Commitment MasterCommitment---"&strTradeId, Null
				End If
			
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PriceGroup")) Then
				   GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbRateSheet"),FRM_DS_GetValue(objData,"PriceGroup")
				   FRM_Logger_ReportInfoEvent "Price Group","price Group Entered--"&FRM_DS_GetValue(objData,"PriceGroup"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "intPoolAmount")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtMasterCommitmentAmount"), FRM_DS_GetValue(objData, "intPoolAmount")
					FRM_Logger_ReportInfoEvent "Pool Amount","Master Commitment Amount-"&FRM_DS_GetValue(objData, "intPoolAmount"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateCommitment")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtStartDate;groupContainer1;.*"), FRM_DS_GetValue(objData, "dateCommitment")
					FRM_Logger_ReportInfoEvent "Master Effective date","Master Effective date---"&FRM_DS_GetValue(objData, "dateCommitment"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DateExpiryDate")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtExpireDate;groupContainer1;.*"), FRM_DS_GetValue(objData, "DateExpiryDate")
					FRM_Logger_ReportInfoEvent "Master Expiry date","Master Expiry date---"&FRM_DS_GetValue(objData, "DateExpiryDate"), Null
				End If
				
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
				If GUI_Object_IsExistX(objDeliPage, 60) Then
					If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCommitmentType")) Then
						GUI_SwfComboBox_Select objDeliPage.SwfComboBox("swfname:=cmbDeliveryMethodType"),FRM_DS_GetValue(objData,"strCommitmentType")
						FRM_Logger_ReportInfoEvent "Delivery Type","Selected the Delivery Type----"&FRM_DS_GetValue(objData, "strCommitmentType"), Null
					End If
				
					If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DeliveryDays")) Then
						GUI_SwfEdit_Set objDeliPage.SwfEdit("swfname:=txtDays"), FRM_DS_GetValue(objData, "DeliveryDays")
						FRM_Logger_ReportInfoEvent "Delivery Days","Master Commitment Delivery Days-"&FRM_DS_GetValue(objData, "DeliveryDays"), Null
					End If
					If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "Tolerance")) Then
						GUI_SwfEdit_Set objDeliPage.SwfEdit("swfname:=txtTolerance"), FRM_DS_GetValue(objData, "Tolerance")
						FRM_Logger_ReportInfoEvent "Tolerance","Master Commitment Tolerance-"&FRM_DS_GetValue(objData, "Tolerance"), Null
					End If
				
					If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateCommitment")) Then
						GUI_SwfEdit_Set objDeliPage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtStartDate;groupContainer1;.*"), FRM_DS_GetValue(objData, "dateCommitment")
						FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Master Effective date---"&FRM_DS_GetValue(objData, "dateCommitment"), Null
					End If
					
					If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DateExpiryDate")) Then
						GUI_SwfEdit_Set objDeliPage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtExpireDate;groupContainer1;.*"), FRM_DS_GetValue(objData, "DateExpiryDate")
						FRM_Logger_ReportInfoEvent "Correspondent Trade","Start Correspondent Trade Commitment description---"&FRM_DS_GetValue(objData, "DateExpiryDate"), Null
					End If
					GUI_SwfButton_Click objDeliPage.SwfButton("swfname:=btnSave")
				End If
	
				GUI_Object_WaitTillVisibleX objHomePage.SwfObject("swfname:=btnSave"), 120	'@ Handle Sync Issues
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnClose")
			Else
				FRM_Logger_ReportInfoEvent "Commitment ID Field","Commitment ID Field Page not Exists", Null
			End IF
		Else
			FRM_Logger_ReportInfoEvent "TPO Page","TPO Page not Exists", Null
		End If
	Else
		FRM_Logger_ReportFailEvent "Magnify Glass","Magbifying Glass not Exists", Null
	End If
	
	BIZ_Trades_CreateCorrespondentMasters = strTradeId
	
	Set objMainFormWnd  = Nothing
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	Set objTPOPage      = Nothing
	Set objDeliPage     = Nothing
	
End Function



'This function is used to create correspondent Trades
'@code
'   Function BIZ_Trades_CreateCorrespondentTrades(strRowID)
'@endcode
'@param strRow - Get the details from the Excel

Function BIZ_Trades_CreateCorrespondentTrades(strRowID, strMasterCommitName)
	FRM_Logger_ReportInfoEvent "Correspondnet Trade Creation","Start Correspondnet Trade Creation---"&strRowID, Null
	
	Dim objMainFormWnd,objHomePage,objData,objTPOPage,strTradeId,objDeliPage
	
	Set objMainFormWnd  = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=NewCorrespondentTrade")
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objData         = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie",strRowID)
	Set objTPOPage      = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objDeliPage     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=CorrespondentDeliveryType")
	
	strTradeId= FRM_DS_GetValue(objData, "intPoolid")

	GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnNew")
	If GUI_Object_IsExistX(objMainFormWnd.SwfObject("swfname:=btnSelector"), 60) Then
		GUI_SwfObject_Click objMainFormWnd.SwfObject("swfname:=btnSelector")
		FRM_Logger_ReportInfoEvent "Magnify Glass","Clicked on Magnifying Glass", Null
		If GUI_Object_IsExistX(objTPOPage.SwfObject("swfname:=grd3rdParties"), 60) Then
			intRow = GUI_List_GetRowIndex(objTPOPage.SwfObject("swfname:=grd3rdParties"), "Organization Name", "Prolifics TPO")

			GUI_List_ActOnRow objTPOPage.SwfObject("swfname:=grd3rdParties"), intRow+1, True, False, False, "Single"
	
			GUI_SwfButton_Click	objTPOPage.SwfButton("swfname:=btnSelect")
			FRM_Logger_ReportInfoEvent "Select Button","Clicked on Selected Button", Null
			
			GUI_SwfRadioButton_Click objMainFormWnd.SwfRadioButton("swfname:=rdoMandatory")
			FRM_Logger_ReportInfoEvent "Mandatory","Clicked on Mandatory Radio Button", Null
			
			GUI_SwfButton_Click	objMainFormWnd.SwfButton("swfname:=btnSave")
			FRM_Logger_ReportInfoEvent "OK Button","Clicked on OK Button", Null
			wait 15
			If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=lbtnCommitmentNumber","index:=0"), 60) Then
				GUI_swfObject_Click objHomePage.SwfObject("swfname:=lbtnCommitmentNumber","index:=0")
			End If
	
			If GUI_Object_IsExistX( objHomePage.SwfEdit("swfname:=txtCommitmentNumber"), 60) Then
				If GUI_Object_IsExistX(objHomePage.SwfObject("swfname:=pbIcon"), 20) Then
					GUI_SwfObject_Click objHomePage.SwfObject("swfname:=pbIcon")
				End If
				If Util_String_IsNotEmpty(strTradeId) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtCommitmentNumber"), strTradeId
					FRM_Logger_ReportInfoEvent "Commitment ID","Correspondent Trade Commitment ---"&strTradeId, Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "dateCommitment")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtCommitment;panel2;groupContainer1;.*"), FRM_DS_GetValue(objData, "dateCommitment")
					FRM_Logger_ReportInfoEvent "Commmitment date","Commmitment date---"&FRM_DS_GetValue(objData, "dateCommitment"), Null
				End If
				
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strTradeDescription")) Then
				   GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbTradeDesc"),FRM_DS_GetValue(objData,"strTradeDescription")
				   FRM_Logger_ReportInfoEvent "Trade Description","Trade Description Entered--"&FRM_DS_GetValue(objData,"strTradeDescription"), Null
				End If
				
				If UTIL_String_IsNotEmpty(strMasterCommitName) Then
				   GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cboMasters"),strMasterCommitName
				   FRM_Logger_ReportInfoEvent "Master Commiment","Master Commiment Entered--"&strMasterCommitName, Null
				End If
				
				If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "strCommitmentType")) Then
				   GUI_SwfComboBox_Select objHomePage.SwfComboBox("swfname:=cmbDeliveryType"),FRM_DS_GetValue(objData, "strCommitmentType")
				   FRM_Logger_ReportInfoEvent "Delivery Type","Delivery Type Entered--"&FRM_DS_GetValue(objData, "strCommitmentType"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "intPoolAmount")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtAmount"), FRM_DS_GetValue(objData, "intPoolAmount")
					FRM_Logger_ReportInfoEvent "Pool Amount","Trade Amount-"&FRM_DS_GetValue(objData, "intPoolAmount"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strAssignInputTolerance")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTolerance"), FRM_DS_GetValue(objData, "strAssignInputTolerance")
					FRM_Logger_ReportInfoEvent "Tolerance","Master Commitment Tolerance-"&FRM_DS_GetValue(objData, "strAssignInputTolerance"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DateExpiryDate")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtExpirationDate;panel2;groupContainer1;.*"), FRM_DS_GetValue(objData, "DateExpiryDate")
					FRM_Logger_ReportInfoEvent "Master Expiry date","Master Expiry date---"&FRM_DS_GetValue(objData, "DateExpiryDate"), Null
				End If
				
				If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DeliveryExpiryDate")) Then
					GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtDeliveryExpirationDate;panel2;groupContainer1;.*"), FRM_DS_GetValue(objData, "DeliveryExpiryDate")
					FRM_Logger_ReportInfoEvent "Delivery Expiry date","Delivery Expiry date---"&FRM_DS_GetValue(objData, "DeliveryExpiryDate"), Null
				End If
				GUI_Object_WaitTillVisibleX objHomePage.SwfObject("swfname:=btnSave"), 120	'@ Handle Sync Issues
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
				GUI_Dialog_Encompass_YesX 15, Null
				GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnList")
				GUI_Dialog_Encompass_YesX 15, Null
				GUI_Dialog_Encompass_OKX 15, Null
			Else
				FRM_Logger_ReportInfoEvent "Commitment ID Field","Commitment ID Field Page not Exists", Null
			End IF
		Else
			FRM_Logger_ReportInfoEvent "TPO Page","TPO Page not Exists", Null
		End If
	Else
		FRM_Logger_ReportFailEvent "Magnify Glass","Magbifying Glass not Exists", Null
	End If
	
	BIZ_Trades_CreateCorrespondentTrades = strTradeId
	
	Set objMainFormWnd  = Nothing
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	Set objTPOPage      = Nothing
	Set objDeliPage     = Nothing
	
End Function


'This function is used to Lock Settings
'@code
'   BIZ_SecondaryMarket_LockSettings(strLockType, strLockStatus)
'@endcode
'@param strRow - Get the details from the Excel

Function BIZ_SecondaryMarket_LockSettings(strLockType, strLockStatus)
	
	Dim objSetupContainer, objData, arrCriteria, objName, objCheck
	Set objSetupContainer 	= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer")
	
	BIZ_Nav_OpenMenuItem "Encompass;Settings..."
	BIZ_Nav_HierarchyTree "Secondary Setup", "Auto-Lock"
	
	If strLockType = "Re-Lock"  Then
		If strLockStatus = "On" Then
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "On"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRelock"), "On"
		Else
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "On"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRelock"), "On"	
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRelock"), "Off"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "Off"			
		End If
	ElseIf strLockType = "Extend" Then	
		If strLockStatus = "On" Then
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "On"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockExtRequest"), "On"
		Else
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "Off"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockExtRequest"), "Off"
		End If
	ElseIf strLockType = "Cancel" Then
		If strLockStatus = "On" Then
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "On"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoCancelLockRequest"), "On"
		Else
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoLockRequest"), "Off"
			GUI_SwfCheckBox_Set SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfCheckBox("swfname:=chkAutoCancelLockRequest"), "Off"		
		End If
	End If
	
	If GUI_Object_IsEnabled(SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfObject("swfname:=stdIconBtnSave")) Then
		GUI_SwfObject_Click SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfObject("swfname:=stdIconBtnSave")
	End If
	
	BIZ_Settings_ClickClose()
	
	Set objSetupContainer 	= Nothing
	
End Function
'This function is used to Navigation TO GseCommitments
'@code
'    BIZ_SecondaryMarket_NavigationTOGseCommitments()
'@endcode

Function BIZ_SecondaryMarket_NavigationTOGseCommitments()

	FRM_Logger_ReportInfoEvent "Start Test Case GseCommitments","Navigate to SecondaryMarket Gse Commitments ", Null
	Dim objTradeStartUpdate,objTabSecurityTrade

	Set objMainScreen=SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MainScreen")
	Set objTradeStartUpdate=SwfWindow("swfname:=MainForm").SWfwindow("swfname:=TradeLoanSyncDlg").SwfButton("swfname:=btnOK")
	Set objTabSecurityTrade=objMainScreen.SwfObject("swfname:=btnSecurityTrades")

	BIZ_Nav_SelectTabControl "Trades"
	Wait g_ShortWaitSmall 'Explicit wait added Due to Sync
	GUI_Dialog_Encompass_YesX 15, Null
	
	If GUI_Object_IsExist(objTradeStartUpdate)=True Then
		GUI_Object_Click objTradeStartUpdate,"SwfButton","SWfObject"
		GUI_Dialog_Encompass_OKX 15, Null
	End If
	
	Wait g_ShortWaitSmall 'Explicit wait added Due to Sync
	GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=btnGseCommitments")

	Set objMainScreen		=Nothing	
	Set objTradeStartUpdate	=Nothing
	Set objTabSecurityTrade	=Nothing

End Function



'This function is used to Create Commitment 
'@code
'    BIZ_SecondaryMarket_CreateCommitment(strRowID)
'@endcode
'@Param strRowID - points to row in Excel

Function BIZ_SecondaryMarket_CreateCommitment(strRowID)
    
    FRM_Logger_ReportInfoEvent "Secondary Market Commitment","Create Commitment"  , Null
    Dim objData,objMainScreen,objFannieMaeProduct,objMainScreenBtnNew,objCommitmentID,objContractNumber
    Dim objTradeDescription, objCommitmentDate ,objSellerName ,objCommitAmount,objIssueMonth,strIssueMonth
    Dim strCommitmentID	,strContractNumber,strTradeDescription,strCommitmentDate,strSellerName,strCommitAmount,strProductName	
	
	Set objData 				= 	FRM_DS_GetTestData("SecondaryMarket", "GSM_Commitment", strRowID)
	Set objMainScreen			=	SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MainScreen")
	Set objFannieMaeProduct		=	SwfWindow("swfname:=MainForm").SwfWindow("swfname:=FannieMaeProductNames")
	Set objMainScreenBtnNew		=	objMainScreen.SwfObject("swfname:=btnNew")
	Set objCommitmentID			=	objMainScreen.SwfEdit("swfname:=txtCmtId")
	Set objContractNumber		=	objMainScreen.SwfEdit("swfname:=txtContractNumber")
	Set objTradeDescription		=	objMainScreen.SwfEdit("swfname:=cmbTradeDesc")
	Set objCommitmentDate		=	objMainScreen.SwfEdit("swfname:=txtDate","index:=0")
	Set objSellerName 			=	objMainScreen.SwfEdit("swfname:=txtSellerNumber")
	Set objCommitAmount			=	objMainScreen.SwfEdit("swfname:=txtAmount")
	Set objIssueMonth			=	objMainScreen.SwfEdit("swfname:=txtDate","index:=1")	
	strCommitmentID				=	FRM_DS_GetValue(objData,"CommitmentID")
	strContractNumber			=	FRM_DS_GetValue(objData,"ContractNumber")	
	strTradeDescription			=	FRM_DS_GetValue(objData,"TradeDescription")	
	strCommitmentDate			=	FRM_DS_GetValue(objData,"CommitmentDate")	
	strSellerName				=	FRM_DS_GetValue(objData,"SellerName")	
	strCommitAmount				=	FRM_DS_GetValue(objData,"CommitAmount")	
	strIssueMonth				=	FRM_DS_GetValue(objData,"IssueMonth")
	strProductName				=	FRM_DS_GetValue(objData,"ProductName")

		Wait g_ShortWaitSmall
		GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=btnNew")

		If UTIL_String_IsNotEmpty(strCommitmentID) Then
		GUI_SwfEditor_Type objCommitmentID, strCommitmentID 	
		End If
		
		If UTIL_String_IsNotEmpty(strContractNumber) Then
		GUI_SwfEditor_Type objContractNumber, strContractNumber	
		End If
		
		If UTIL_String_IsNotEmpty(strTradeDescription) Then
		GUI_SwfEditor_Type objTradeDescription, strTradeDescription		
		End If
		
		If UTIL_String_IsNotEmpty(strCommitmentDate) Then
		GUI_SwfEditor_Type objCommitmentDate, strCommitmentDate	
		End If
		
		If UTIL_String_IsNotEmpty(strSellerName) Then
		GUI_SwfEditor_Type objSellerName, strSellerName	
		End If
		
		If UTIL_String_IsNotEmpty(strCommitAmount) Then
		GUI_SwfEditor_Type objCommitAmount, strCommitAmount	
		End If
		
		If UTIL_String_IsNotEmpty(strIssueMonth) Then
		GUI_SwfEditor_Type objIssueMonth, strIssueMonth		
		End If
		
		If UTIL_String_IsNotEmpty(strIssueMonth) Then
		GUI_SwfEditor_Type objIssueMonth, strIssueMonth		
		End If
		
  
    If UTIL_String_IsNotEmpty(strProductName) Then
  		GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=btnAddPN") 
  		GUI_List_ClickRow objFannieMaeProduct.SwfObject("swfname:=gridFannieMaeProductsName"), null, "Fannie Mae Product Name", strProductName, True, False, False, "Single"
  		GUI_SwfButton_Click objFannieMaeProduct.SwfButton("swfname:=btnSelect") 
	End If

    GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=btnSave")
    GUI_SwfObject_Click objMainScreen.SwfObject("swfname:=btnList")
    
    BIZ_SecondaryMarket_CreateCommitment = strCommitmentID

    Set objData 				= 	Nothing
	Set objMainScreen			=	Nothing
	Set objFannieMaeProduct		=	Nothing
	Set objMainScreenBtnNew		=	Nothing
	Set objCommitmentID			=	Nothing
	Set objContractNumber		=	Nothing
	Set objTradeDescription		=	Nothing
	Set objCommitmentDate		=	Nothing
	Set objSellerName 			=	Nothing
	Set objCommitAmount			=	Nothing
	Set objIssueMonth			=	Nothing

End Function



'This function is used to AllocateCommitment
'@code
'    BIZ_SeconodaryMarket_Trades_MBSPools_AllocatePetoGSE(strCommitment)
'@endcode
'@param strCommitment - Commitment ID

Function BIZ_SeconodaryMarket_Trades_MBSPools_AllocatePetoGSE(strCommitment)
	
	FRM_Logger_ReportInfoEvent "BIZ_SeconodaryMarket_Trades_MBSPools_AllocatePetoGSE", "Allocate '"&strCommitment&"' GSE Commitment", Null
	
	Dim objPricingDetailsPage, objPricePage, objList
	Set objPricingDetailsPage 	= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MainScreen")
	Set objAllocGSEWnd			= SwfWindow("swfname:=MainForm").SwfWindow("swfname:=GSECmtAssignmentDialog")
	Set objList					= objAllocGSEWnd.SwfObject("swfname:=gvEligible")
	
	GUI_SwfTab_Click objPricingDetailsPage.SwfTab("swfname:=tabTrade"), "Details"
	
	Wait g_ShortWaitMedium
	GUI_SwfButton_Click objPricingDetailsPage.SwfButton("swfname:=btnOpenDialog","index:=1")
	
	If GUI_Object_IsExist(objAllocGSEWnd) Then
		GUI_SwfEdit_Set objAllocGSEWnd.SwfEdit("swfname:=txt_cmtID"), strCommitment
		GUI_SwfButton_Click objAllocGSEWnd.SwfButton("swfname:=btnSearch")
		Wait g_ShortWaitMedium
		GUI_List_ClickRow objList, Null, "Commitment ID", strCommitment, True, False, False, "Single"
		GUI_SwfButton_Click objAllocGSEWnd.SwfButton("swfname:=btnAssign")
		If GUI_Object_IsExist(objAllocGSEWnd.Dialog("regexpwndtitle:=Encompass")) Then
			GUI_Dialog_Encompass_YesX 15, Null
		End If
		GUI_SwfObject_Click objPricingDetailsPage.SwfObject("swfname:=btnSave")
		Wait g_ShortWaitMedium
    	GUI_SwfObject_Click objPricingDetailsPage.SwfObject("swfname:=btnList")
		Wait g_ShortWaitMedium
	End If
	
	Set objPricingDetailsPage 	= Nothing
	Set	objPricePage			= Nothing 
	Set objList					= Nothing
		
End Function
Function BIZ_SeconodaryMarket_Trades_MBSPools_FannieMaePEDetails()

	FRM_Logger_ReportInfoEvent "Coupon Fields", "Start Coupon Fields---", Null 
	
	Dim objPricingDetailsPage, objPricePage	
	Set objPricingDetailsPage = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MainScreen")
	Set objPricePage          = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=MbsFannieFreddiePricingItemDialog")
	
	intCoupnval 		= "4.00"
	intWeghtPerc 		= "101"
	intBaseGaurantyFee 	= "0.45"
	intGaurantyFee 		= "0.2"
	intMinserFee 		= "0.15"
	intMaxBuyUp 		= "0.25"
	intFixedSerFee 		= "0.125"
	intNoteRate 		= "5.000"
	
	GUI_SwfTab_Click objPricingDetailsPage.SwfTab("swfname:=tabTrade"), "Details"
	If GUI_Object_IsExistX(objPricingDetailsPage.SwfEdit("swfname:=txtCoupon"), 60) Then
		
		GUI_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtCoupon"), intCoupnval
		FRM_Logger_ReportInfoEvent "Coupon Data ", "Coupon Data Entered----"&intCoupnval, Null
		
		If GUI_Object_IsExistX(objPricingDetailsPage.SwfObject("swfname:=pbIcon"), 60) Then
			GUI_SwfObject_Click objPricingDetailsPage.SwfObject("swfname:=pbIcon")
			GUi_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtWeightedAvgPrice"), intWeghtPerc
			FRM_Logger_ReportInfoEvent "Weight Average Price ", "Weight Average Price Entered----"&intWeghtPerc, Null
		End If
		
		GUI_SwfObject_Click objPricingDetailsPage.SwfObject("swfname:=btnSave")
	End If
	
	GUI_SwfTab_Click objPricingDetailsPage.SwfTab("swfname:=tabTrade"), "Setup"	
	
	If GUI_Object_IsExistX(objPricingDetailsPage.SwfEdit("swfname:=txtBaseGuarantyFee"), 60) Then	
		If Util_String_IsNotEmpty(intBaseGaurantyFee) Then
			GUi_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtBaseGuarantyFee"), intBaseGaurantyFee
			FRM_Logger_ReportInfoEvent "Base Gauranty Fee ", "Base Gauranty Fee Entered----"&intBaseGaurantyFee, Null
		End If
		If Util_String_IsNotEmpty(intGaurantyFee) Then
			GUi_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtGuaranteeFee"), intGaurantyFee
			FRM_Logger_ReportInfoEvent "Gauranty Fee ", "Gauranty Fee Entered----"&intGaurantyFee, Null
		End If
		If Util_String_IsNotEmpty(intMinserFee) Then
			GUi_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtMinServicingFee"), intMinserFee
			FRM_Logger_ReportInfoEvent "Minimum Servicing Fee ", "Minimum Servicing Fee Entered----"&intMinserFee, Null
		End If
		If Util_String_IsNotEmpty(intMaxBuyUp) Then
			GUi_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtMaxBU"), intMaxBuyUp
			FRM_Logger_ReportInfoEvent "Maximum Buy UP ", "Maximum Buy UP Entered----"&intMaxBuyUp, Null
		End If
		If Util_String_IsNotEmpty(intFixedSerFee) Then
			GUi_SwfEdit_Set objPricingDetailsPage.SwfEdit("swfname:=txtServiceFee"), intFixedSerFee
			FRM_Logger_ReportInfoEvent "Fixed Servicing Fee ", "Fixed Servicing Fee Entered----"&intFixedSerFee, Null
		End If
		GUI_SwfObject_Click objPricingDetailsPage.SwfObject("swfname:=btnSave")
		wait 10
	End If
	
End Function



'This function is used to edit correspondent Trades
'@code
'   Function BIZ_Trades_CorrespondentTrades_EditToAndDeliveryExpiration(strRowID)
'@endcode
'@param strRow - Get the details from the Excel

Function BIZ_Trades_CorrespondentTrades_EditToAndDeliveryExpiration(strRowID)
	FRM_Logger_ReportInfoEvent "Correspondnet Trade Tolerance and Delivery Expiration","Start Correspondnet Trade Tolerance and Delivery Expiration---"&strRowID, Null
	
	Dim objMainFormWnd,objHomePage,objData,objTPOPage,strTradeId,objDeliPage
	
	Set objMainFormWnd  = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=NewCorrespondentTrade")
	Set objHomePage	    = SwfWindow("swfname:=MainForm").SWfwindow("swfname:=MainScreen")
	Set objData         = FRM_DS_GetTestData("SecondaryMarket", "MBSPoolFannie",strRowID)
	Set objTPOPage      = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=TPOCompanyMasterSelectorForm")
	Set objDeliPage     = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=CorrespondentDeliveryType")
	
	If GUI_Object_IsExistX( objHomePage.SwfEdit("swfname:=txtCommitmentNumber"), 60) Then
		If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "strAssignInputTolerance")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtTolerance"), FRM_DS_GetValue(objData, "strAssignInputTolerance")
			FRM_Logger_ReportInfoEvent "Tolerance","Master Commitment Tolerance-"&FRM_DS_GetValue(objData, "strAssignInputTolerance"), Null
		End If
		If Util_String_IsNotEmpty(FRM_DS_GetValue(objData, "DeliveryExpiryDate")) Then
			GUI_SwfEdit_Set objHomePage.SwfEdit("swfname:=txtDate","swfname path:=txtDate;dtDeliveryExpirationDate;panel2;groupContainer1;.*"), FRM_DS_GetValue(objData, "DeliveryExpiryDate")
			FRM_Logger_ReportInfoEvent "Delivery Expiry date","Delivery Expiry date---"&FRM_DS_GetValue(objData, "DeliveryExpiryDate"), Null
		End If
		GUI_Object_WaitTillVisibleX objHomePage.SwfObject("swfname:=btnSave"), 120	'@ Handle Sync Issues
		GUI_SwfObject_Click objHomePage.SwfObject("swfname:=btnSave")
		GUI_Dialog_Encompass_YesX 10, ""
		GUI_Dialog_Encompass_YesX 10, ""
		GUI_Dialog_Encompass_OKX 10, ""
		GUI_SwfTab_Click objHomePage.SwfTab("swfname:=tabTrade"), "Loans"
	Else
		FRM_Logger_ReportInfoEvent "Commitment ID Field","Commitment ID Field Page not Exists", Null
	End IF
	
	Set objMainFormWnd  = Nothing
	Set objHomePage	    = Nothing
	Set objData         = Nothing
	Set objTPOPage      = Nothing
	Set objDeliPage     = Nothing
	
End Function
'@}