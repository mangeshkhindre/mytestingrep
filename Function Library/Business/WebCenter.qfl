''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'@defgroup BIZ_WebCenter BIZ_WebCenter
'
' List of functions here
' @code
'   Function BIZ_WebCenter_OpenSite(strRowID)
'   Function BIZ_WebCenter_ClickNextPageBtn()
'   Function BIZ_WebCenter_BasicInfo(strRowID)
'   Function BIZ_WebCenter_GetFullApplicationPage(strApplyFor)
'   Function BIZ_WebCenter_GetShortApplicationPage()
'   Function BIZ_WebCenter_ClickApplyNow() 
'   Function BIZ_WebCenter_LoanInformation(strRowID)
'   Function BIZ_WebCenter_PersonalInformation(strRowID)
'   Function BIZ_WebCenter_EmploymentAndIncome(strRowIDs)
'   Function BIZ_WebCenter_Assets(strRowIDs)
'   Function BIZ_WebCenter_Liabilities(strRowIDs)
'   Function BIZ_WebCenter_Declarations (strRowID)
'   Function BIZ_WebCenter_Consent (isAgree)
'   Function BIZ_WebCenter_SubmitApplication()
'   Function BIZ_WebCenter_AccountDelete(strRowID)
'   Function BIZ_WebCenter_CreateNewAccount (strRowID)
'   Function BIZ_WebCenter_LogIn(strRowID)
'   Function BIZ_WebCenter_RefreshFirstEMail(strRowID)
'   Function BIZ_WebCenter_ReadGmailAndNavigateToAccountPage(strRowID, eType)
'   Function BIZ_WebCenter_VerifyEmailTriggeredAndReceived(strRowID, eType)
'   Function BIZ_Webcenter_OpenDocumentInDetailPage(strDocSubject)
'   Function BIZ_WebCenter_GetDetailPageWhenMultipleBorrOnAccount(strBorrName)
'   Function BIZ_WebCenter_LogOut()
'   Function BIZ_WebCenter_VerifyCheckLoanStatusPage()
'   Function BIZ_WebCenter_CreateDocumentIfNotExists(strDocumentType,strDocName)
'   Function BIZ_WebCenter_SetUpConsent()
'   Function BIZ_WebCenter_SetUpConsentAndCreateDocumentIfNotExistsForCNDTests(strRowID)
'   Function BIZ_WebCenter_BorrActOnDocumentInDetailPage(strDocSubject,strBorrName,strButton)
'   Function BIZ_Webcenter_VerifyIfObjectExistsForBorrower(strDocSubject,strBorrName,strObjectTextProperty, strObjClass) 
'   Function BIZ_WebCenter_Setup()
'   Function BIZ_WebCenter_DocuSignSignDocument()
'@endcode
' @{
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



'@description Open WebCenter Site
'@param  strRowID 
'@code
'   BIZ_WebCenter_OpenSite (strRowID) 
'@endcode

Function BIZ_WebCenter_OpenSite (strRowID)    
    Set objData = FRM_DS_GetTestData("Global_Data", "Website", strRowID)
    strURL = FRM_DS_GetValue(objData, "URL")
    FRM_Logger_ReportInfoEvent "Open WebCenter Site", "Opening site:" & strURL, null 
    GUI_Browser_OpenUrl strURL
    'If Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*").WebElement("innertext:=Welcome to our website.*","index:=0").Exist(120) Then ' batch fails with this one
	If Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*").Exist(120) Then
        FRM_Logger_ReportPassEvent "Open WebCenter Site", "WebCenter site is opened", null  
    Else
        FRM_Logger_ReportFailEvent "Open WebCenter Site", "WebCenter site is NOT opened. Welcome page is NOT displayed.", null  
    End If  
    Set objData = Nothing
End Function



'@description Select application to apply for
'@param  strApplyFor apply for which application
'@code
'   BIZ_WebCenter_GetFullApplicationPage "Full Application"
'@endcode

Function BIZ_WebCenter_GetFullApplicationPage(strApplyFor)
    FRM_Logger_ReportInfoEvent "Select Application to apply", "Select to apply for:" & strApplyFor, null 
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.Link("text:=" & strApplyFor,"index:=0"),60
    'GUI_Link_Click objWebCenterPage.Link("text:=Apply Now","index:=0")
    GUI_Link_Click objWebCenterPage.Link("text:=" & strApplyFor,"index:=0")
    Set objWebCenterPage = Nothing
End Function



'@This function is used to Select Short application to apply for
'@code
'   BIZ_WebCenter_GetShortApplicationPage
'@endcode

Function BIZ_WebCenter_GetShortApplicationPage()
	BIZ_WebCenter_GetFullApplicationPage "Short Application"
End Function



'@This function is used to click on Apply Now  button 
'@code
'   BIZ_WebCenter_ClickApplyNow()
'@endcode

Function BIZ_WebCenter_ClickApplyNow()
    FRM_Logger_ReportInfoEvent "Apply Now", " Click on Apply Now button", null 
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.Link("text:=Apply Now","index:=1").WebElement("innertext:=Apply Now","index:=0"),60
    objWebCenterPage.Link("text:=Apply Now","index:=1").WebElement("innertext:=Apply Now","index:=0").Click 
    Set objWebCenterPage = Nothing
End Function 



'This function is used to click Next button on webcenter pages
'@code
'    BIZ_WebCenter_ClickNextPageBtn
'@endcode

Function BIZ_WebCenter_ClickNextPageBtn()
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
        objWebCenterPage.Link("text:=.*Next.*","index:=1").WebElement("innertext:=.*Next.*","index:=0").Click
    Set objWebCenterPage = Nothing
End Function


'This function is used to WebCenter Site - Short Application
'@code
'    BIZ_WebCenter_ShortApplicationPersonalInfo(strRowID)
'@endcode

Function BIZ_WebCenter_ShortApplicationPersonalInfo(strRowID)
    FRM_Logger_ReportInfoEvent "WebCenter Site - Short Application", "Enter Personal Info data in  using 'ShortApp_PersonalData' datasheet RowId:" & strRowID, null 
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "ShortApp_PersonalData", strRowID)
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")

    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("html id:=.*nameLabel.*","innertext:=Short Application","indx:=0"),60
        
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerFirstName")) Then       
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boFirstName.*","index:=0"), FRM_DS_GetValue(objData, "BorrowerFirstName")
    End If  
	
	If objWebCenterPage.WebEdit("html id:=.*boMiddleName.*","index:=0").Exist(2) Then
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerMiddleName")) Then       
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boMiddleName.*","index:=0"), FRM_DS_GetValue(objData, "BorrowerMiddleName")
		End If 
    End If
	
    strBorrowerLastName = FRM_DS_GetValue(objData, "BorrowerLastName") & "-" & UTIL_Date_FormatDateByPattern(now, "mmddyyyyHHnnss")
    If UTIL_String_IsNotEmpty(strBorrowerLastName) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boLastName.*","index:=0"), strBorrowerLastName
        FRM_RT_SetPropValue "BorrowerLastName", strBorrowerLastName
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerEmail")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boEmail.*","index:=0"), FRM_DS_GetValue(objData, "BorrowerEmail")
    End If

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "ReferralName")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*_referralName.*","index:=0"), FRM_DS_GetValue(objData, "ReferralName")
    End If


    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HomePhone")) Then
        strHomePhone = FRM_DS_GetValue(objData, "HomePhone")
        strHomePhone = UTIL_String_RemoveCharacters(strHomePhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boHomePhone.areaCodeTextBox.*","index:=0"), mid(strHomePhone,1,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boHomePhone.prefixTextBox.*","index:=0"), mid(strHomePhone,4,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boHomePhone.suffixTextBox.*","index:=0"), mid(strHomePhone,7,4)
    End If  

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CellPhone")) Then
        strCellPhone = FRM_DS_GetValue(objData, "CellPhone")
        strCellPhone = UTIL_String_RemoveCharacters(strCellPhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCellPhone.areaCodeTextBox.*","index:=0"), mid(strCellPhone,1,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCellPhone.prefixTextBox.*","index:=0"), mid(strCellPhone,4,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCellPhone.suffixTextBox.*","index:=0"), mid(strCellPhone,7,4)
    End If
	

	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "WorkPhone")) Then
		strWorkPhone = FRM_DS_GetValue(objData, "WorkPhone")
		strWorkPhone = UTIL_String_RemoveCharacters(strWorkPhone,array("-","(",")"," ","."))
		GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boWorkPhone.areaCodeTextBox.*","index:=0"), mid(strWorkPhone,1,3)
		GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boWorkPhone.prefixTextBox.*","index:=0"), mid(strWorkPhone,4,3)
		GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boWorkPhone.suffixTextBox.*","index:=0"), mid(strWorkPhone,7,4)
	End If	


	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MaritalStatus")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boMaritalStatus.*","index:=0"), FRM_DS_GetValue(objData, "MaritalStatus")
    End If
	
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsUSCitizen")) Then
            GUI_WebList_Select objWebCenterPage.WebList("html id:=.*citizen.*","index:=0"), FRM_DS_GetValue(objData, "IsUSCitizen")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "DateOfBirth")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boBirthday.*","index:=0"), FRM_DS_GetValue(objData, "DateOfBirth")
    End If
	
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SSN")) Then
        strSSN = FRM_DS_GetValue(objData, "SSN")
        strSSN = UTIL_String_RemoveCharacters(strSSN,array("-","(",")"," ","."))
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSocialIDOneTextBox.*","index:=0"), mid(strSSN,1,3)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSocialIDTwoTextBox.*","index:=0"), mid(strSSN,4,2)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSocialIDThreeTextBox.*","index:=0"), mid(strSSN,6,4)
    End If   

	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CreditCheckAuthorization")) Then
            GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boAuthorization.*","index:=0"), FRM_DS_GetValue(objData, "CreditCheckAuthorization")
    End If	
	
	If objWebCenterPage.WebEdit("html id:=.*boYearsOfSchool.*","index:=0").Exist(2) Then
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "YearsOfSchool")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boYearsOfSchool.*","index:=0"), FRM_DS_GetValue(objData, "YearsOfSchool")
		End If	
	End If
	
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NumberOfDependents")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boDependents.*","index:=0"), FRM_DS_GetValue(objData, "NumberOfDependents")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "DependentAge")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boAge.*","index:=0"), FRM_DS_GetValue(objData, "DependentAge")
    End If      
    
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "StreetAddress")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentAddress.*","index:=0"), FRM_DS_GetValue(objData, "StreetAddress")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentCity.*","index:=0"), FRM_DS_GetValue(objData, "City")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boCurrentState.*","index:=0"), FRM_DS_GetValue(objData, "State")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
        strZip = FRM_DS_GetValue(objData, "Zip")
        strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentZip.*","index:=0"), mid(strZip,1,5)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentExtZip.*","index:=0"), mid(strZip,6,4)
    End If      
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "YearsAtThisAddress")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentYearsAt.*","index:=0"), FRM_DS_GetValue(objData, "YearsAtThisAddress")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Months")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentMonthsAt.*","index:=0"), FRM_DS_GetValue(objData, "Months")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "RentOrOwn")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boRentOrOwn.*","index:=0"), FRM_DS_GetValue(objData, "RentOrOwn")
    End If
    

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PurposeOfLoan")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*boPurposeOfLoan.*","index:=0"), FRM_DS_GetValue(objData, "PurposeOfLoan")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PropertyUsage")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*boPropertyUsage.*","index:=0"), FRM_DS_GetValue(objData, "PropertyUsage")
    End If	
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "LoanAmount")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boLoanAmout.*","index:=0"), FRM_DS_GetValue(objData, "LoanAmount")
    End If  

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PurchasePrice")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boValueAndPrice.*","index:=0"), FRM_DS_GetValue(objData, "PurchasePrice")
    End If
    
	If objWebCenterPage.WebEdit("html id:=.*boEstimatedValue.*","index:=0").Exist(2) Then
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "EstimatedValue")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boEstimatedValue.*","index:=0"), FRM_DS_GetValue(objData, "EstimatedValue")
		End If
	End If
	
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NumberOfUnits")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boNumOfUnits.*","index:=0"), FRM_DS_GetValue(objData, "NumberOfUnits")
    End If

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "YearBuilt")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boYearBuilt.*","index:=0"), FRM_DS_GetValue(objData, "YearBuilt")
    End If 	
	
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SubjectPropertyAddress")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSubjectPropertyAddr.*","index:=0"), FRM_DS_GetValue(objData, "SubjectPropertyAddress")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSubjectPropertyCity.*","index:=0"), FRM_DS_GetValue(objData, "City")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*boSubjectPropertyState.*","index:=0"), FRM_DS_GetValue(objData, "State")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
        strZip = FRM_DS_GetValue(objData, "Zip")
        strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ",".")) 
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSubjectPropertyZip.*","index:=0"), mid(strZip,1,5)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSubjectPropertyExtzip.*","index:=0"), mid(strZip,6,4)
    End If	

	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MonthlyBaseIncome")) Then
		GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boBaseIncome.*","index:=0"), FRM_DS_GetValue(objData, "MonthlyBaseIncome")
	End If	

	
	'Assets checking
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "AssetsChecking")) Then
		GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boChecking.*","index:=0"), FRM_DS_GetValue(objData, "AssetsChecking")
	End If	

	
	'Assets saving
	If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "AssetsSaving")) Then
		GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boSaving.*","index:=0"), FRM_DS_GetValue(objData, "AssetsSaving")
	End If	
	
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "FurnishGovernmentMonitoring")) Then 
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*boFurnishGoverInfoOptionCheckBox.*","index:=0"),FRM_DS_GetValue(objData, "FurnishGovernmentMonitoring")    
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Sex")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*boSexRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "Sex")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Ethnicity")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*boEthRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "Ethnicity")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Race")) Then    
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*boRaceRadioButtonList." & FRM_DS_GetValue(objData, "Race") & ".*","index:=0"),"ON" 
    End If	

	
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HasCoBorrower")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*hasCoBorrower.*","index:=0"), "hasCoBorrower" & FRM_DS_GetValue(objData, "HasCoBorrower")& "RB"
    End If

'Co-Borrower
    If FRM_DS_GetValue(objData, "HasCoBorrower")= "Yes" Then
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerFirstName")) Then       
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coFirstName.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerFirstName")
		End If  
		
		If objWebCenterPage.WebEdit("html id:=.*coMiddleName.*","index:=0").Exist(2) Then
			If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerMiddleName")) Then       
				GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coMiddleName.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerMiddleName")
			End If 
		End If
		

		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerLastName")) Then
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coLastName.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerLastName")
		End If  
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerEmail")) Then
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coEmail.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerEmail")
		End If


		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerHomePhone")) Then
			strHomePhone = FRM_DS_GetValue(objData, "Co-BorrowerHomePhone")
			strHomePhone = UTIL_String_RemoveCharacters(strHomePhone,array("-","(",")"," ","."))
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coHomePhone.areaCodeTextBox.*","index:=0"), mid(strHomePhone,1,3)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coHomePhone.prefixTextBox.*","index:=0"), mid(strHomePhone,4,3)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coHomePhone.suffixTextBox.*","index:=0"), mid(strHomePhone,7,4)
		End If  

		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerCellPhone")) Then
			strCellPhone = FRM_DS_GetValue(objData, "Co-BorrowerCellPhone")
			strCellPhone = UTIL_String_RemoveCharacters(strCellPhone,array("-","(",")"," ","."))
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coCellPhone.areaCodeTextBox.*","index:=0"), mid(strCellPhone,1,3)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coCellPhone.prefixTextBox.*","index:=0"), mid(strCellPhone,4,3)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coCellPhone.suffixTextBox.*","index:=0"), mid(strCellPhone,7,4)
		End If
		

		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerWorkPhone")) Then
			strWorkPhone = FRM_DS_GetValue(objData, "Co-BorrowerWorkPhone")
			strWorkPhone = UTIL_String_RemoveCharacters(strWorkPhone,array("-","(",")"," ","."))
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coWorkPhone.areaCodeTextBox.*","index:=0"), mid(strWorkPhone,1,3)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coWorkPhone.prefixTextBox.*","index:=0"), mid(strWorkPhone,4,3)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coWorkPhone.suffixTextBox.*","index:=0"), mid(strWorkPhone,7,4)
		End If	


		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerMaritalStatus")) Then
			GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coMaritalStatus.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerMaritalStatus")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerIsUSCitizen")) Then
				GUI_WebList_Select objWebCenterPage.WebList("html id:=.*cocitizen.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerIsUSCitizen")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerDateOfBirth")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBirthday.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerDateOfBirth")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerSSN")) Then
			strSSN = FRM_DS_GetValue(objData, "Co-BorrowerSSN")
			strSSN = UTIL_String_RemoveCharacters(strSSN,array("-","(",")"," ","."))
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coSocialIDOneTextBox.*","index:=0"), mid(strSSN,1,3)
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coSocialIDTwoTextBox.*","index:=0"), mid(strSSN,4,2)
			GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coSocialIDThreeTextBox.*","index:=0"), mid(strSSN,6,4)
		End If   

		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerCreditCheckAuthorization")) Then
				GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coAuthorization.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerCreditCheckAuthorization")
		End If	
		
		If objWebCenterPage.WebEdit("html id:=.*coYearsOfSchool.*","index:=0").Exist(2) Then
			If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerYearsOfSchool")) Then
				GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coYearsOfSchool.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerYearsOfSchool")
			End If	
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerNumberOfDependents")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coDependents.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerNumberOfDependents")
		End If  
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerDependentAge")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coAge.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerDependentAge")
		End If      
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerStreetAddress")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentAddres.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerStreetAddress")
		End If  
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerCity")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentCity.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerCity")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerState")) Then
			GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coBoCurrentState.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerState")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerZip")) Then
			strZip = FRM_DS_GetValue(objData, "Co-BorrowerZip")
			strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentZip.*","index:=0"), mid(strZip,1,5)
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentExtZip.*","index:=0"), mid(strZip,6,4)
		End If      
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerYearsAtThisAddress")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentYearsAt.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerYearsAtThisAddress")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerMonths")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentMonthsAt.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerMonths")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerRentOrOwn")) Then
			GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coRentOrOwn.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerRentOrOwn")
		End If
		
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerMonthlyBaseIncome")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBaseIncome.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerMonthlyBaseIncome")
		End If	

		
		'Assets checking
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerAssetsChecking")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coChecking.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerAssetsChecking")
		End If	

		
		'Assets saving
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerAssetsSaving")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coSaving.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerAssetsSaving")
		End If	
		                                                    
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerFurnishGovernmentMonitoring")) Then                                                                                                       
			GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*coBoFurnishGoverInfoOptionCheckBox.*","index:=0"),FRM_DS_GetValue(objData, "Co-BorrowerFurnishGovernmentMonitoring")    
		End If  
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerSex")) Then
			GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*coSexRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerSex")
		End If
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerEthnicity")) Then
			GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*coEthRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "Co-BorrowerEthnicity")
		End If  
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Co-BorrowerRace")) Then    
			GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*coRaceRadioButtonList." & FRM_DS_GetValue(objData, "Co-BorrowerRace") & ".*","index:=0"),"ON" 
		End If	

    End If




    GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*policyCheckBox.*" ,"index:=0"),"ON"  
    
    objWebCenterPage.Link("text:=Submit","index:=0").WebElement("innertext:=Submit","index:=0").Click    
    
    Set objData = Nothing
    Set objWebCenterPage = Nothing
End Function



'This function is used to enter data to Start page of webcenter
'@code
'    BIZ_WebCenter_BasicInfo(strRowID)
'@endcode
'@param strRowID - row Id to use in the data sheet

Function BIZ_WebCenter_BasicInfo(strRowID)
    FRM_Logger_ReportInfoEvent "WebCenter Site - Start tab", "Enter basic data in Start page using 'Basic' datasheet RowId:" & strRowID, null 
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "Basic", strRowID)
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")

    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Start"),60
        
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerFirstName")) Then       
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*borrowFirstName.*","index:=0"), FRM_DS_GetValue(objData, "BorrowerFirstName")
    End If  
    
    strBorrowerLastName = FRM_DS_GetValue(objData, "BorrowerLastName") & "-" & UTIL_Date_FormatDateByPattern(now, "mmddyyyyHHnnss")
    If UTIL_String_IsNotEmpty(strBorrowerLastName) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*borrowLastName.*","index:=0"), strBorrowerLastName
        FRM_RT_SetPropValue "BorrowerLastName", strBorrowerLastName
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerEmail")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*borrowEmail.*","index:=0"), FRM_DS_GetValue(objData, "BorrowerEmail")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HasCoBorrower")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*hasCoBorrowerRadioButton.*","index:=0"), FRM_DS_GetValue(objData, "HasCoBorrower")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrowerFirstName")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coborrowerFirstName.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrowerFirstName")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrowerLastName")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coborrowerLirstName.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrowerLastName")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrowerEmail")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coborrowerEmail.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrowerEmail")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerJointCreditYesNo")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*borrowApplyDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "BorrowerJointCreditYesNo")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrowerJointCreditYesNo")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*coborrowApplyDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrowerJointCreditYesNo")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HowDidYouHear")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*ApplicationLeadSourceDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "HowDidYouHear")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HasRealEstateAgent")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*hasRealtorRadioButton.*","index:=0"), FRM_DS_GetValue(objData, "HasRealEstateAgent")
    End If

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "RealEstateAgentName")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*realtorNameTextBox.*","index:=0"), FRM_DS_GetValue(objData, "RealEstateAgentName")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "RealEstateAgentPhone")) Then
        strAgentPhone = FRM_DS_GetValue(objData, "RealEstateAgentPhone")
        strAgentPhone = UTIL_String_RemoveCharacters(strAgentPhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*realtorPhone.areaCodeTextBox.*","index:=0"), mid(strAgentPhone,1,3)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*_realtorPhone.prefixTextBox.*","index:=0"), mid(strAgentPhone,4,3)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*_realtorPhone.suffixTextBox.*","index:=0"), mid(strAgentPhone,7,4)
    End If
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "RealEstateAgentEmail")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*realtorEmailTextBox.*","index:=0"), FRM_DS_GetValue(objData, "RealEstateAgentEmail")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "ReferralName")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*realtorByTextBox.*","index:=0"), FRM_DS_GetValue(objData, "ReferralName")
    End If
    
    If objWebCenterPage.WebCheckBox("html id:=.*creditAuthorizationCheckBox.*","index:=0").Exist(3) Then     
		GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*creditAuthorizationCheckBox.*","index:=0"),"ON"
	End If	
	If objWebCenterPage.WebCheckBox("html id:=.*agreePatriotActCheckBox.*","index:=0").Exist(3) Then
		GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*agreePatriotActCheckBox.*","index:=0"),"ON"
	End If	
	If objWebCenterPage.WebCheckBox("html id:=.*agreeElectronicDisclosuresAgreementCheckBox.*","index:=0").Exist(3) Then
		GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*agreeElectronicDisclosuresAgreementCheckBox.*","index:=0"),"ON"
	End If	
    '=============On QA server checkbox is not present===============
    If objWebCenterPage.WebCheckBox("html id:=.*policyCheckBox.*","index:=0").Exist(3) Then
		GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*policyCheckBox.*","index:=0"),"ON"
    End If
    
    '=============On QA server checkboxes are present===============
    If objWebCenterPage.WebCheckBox("html id:=.*isAdditionalDisclosureCheckBox.*","index:=0").Exist(3) Then
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*isAdditionalDisclosureCheckBox.*","index:=0"),"ON"
    End If
    
    If objWebCenterPage.WebCheckBox("html id:=.*isDisclosureCheckBox.*","index:=0").Exist(3) Then
       GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*isDisclosureCheckBox.*","index:=0"),"ON"
    End If
    
    objWebCenterPage.Link("text:=Next >","index:=1").WebElement("innertext:=Next >","index:=0").Click    
    
    Set objData = Nothing
    Set objWebCenterPage = Nothing
End Function



'This function is used to enter data to Loan Information page of webcenter
'@code
'    BIZ_WebCenter_LoanInformation(strRowID)
'@endcode
'@param strRowID - row Id to use in the data sheet

Function BIZ_WebCenter_LoanInformation(strRowID)
    FRM_Logger_ReportInfoEvent "WebCenter Site - Loan Information tab", "Enter data in Loan Information page using 'LoanInformation' datasheet RowId:" & strRowID, null 
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "LoanInformation", strRowID)
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Loan Information","index:=0"),60

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PurposeOfLoan")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*purposeOfLoanDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "PurposeOfLoan")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "ExecutedContract")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*hasExecuteContactRadioButton.*","index:=0"), FRM_DS_GetValue(objData, "ExecutedContract")
    End If

	If objWebCenterPage.WebList("html id:=.*loanTypeDropDownList.*","index:=0").Exist(2) Then
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "LoanType")) Then
			GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*loanTypeDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "LoanType")
		End If
    End If
	
	If objWebCenterPage.WebList("html id:=.*amortizationTypeDropDownList.*","index:=0").Exist(2) Then
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "AmortizationType")) Then
			GUI_WebList_Select objWebCenterPage.WebList("html id:=.*amortizationTypeDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "AmortizationType")
		End If
    End If
	
	If objWebCenterPage.WebEdit("html id:=.*loanTermTextBox.*","index:=0").Exist(2) Then 
		If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "LoanTerm")) Then
			GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*loanTermTextBox.*","index:=0"), FRM_DS_GetValue(objData, "LoanTerm")
		End If  
	End If
	
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SubjectPropertyAddress")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*propertyAddressTextBox.*","index:=0"), FRM_DS_GetValue(objData, "SubjectPropertyAddress")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*cityTextBox.*","index:=0"), FRM_DS_GetValue(objData, "City")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*stateDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "State")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
        strZip = FRM_DS_GetValue(objData, "Zip")
        strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ",".")) 
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*zipTextBox.*","index:=0"), mid(strZip,1,5)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*ExtzipTextBox.*","index:=0"), mid(strZip,6,4)
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PropertyUsage")) Then
        GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*propertyUsageDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "PropertyUsage")
    End If

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NumberOfUnits")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*unitsTextBox.*","index:=0"), FRM_DS_GetValue(objData, "NumberOfUnits")
    End If

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "YearBuilt")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*yearBuiltTextBox.*","index:=0"), FRM_DS_GetValue(objData, "YearBuilt")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PurchasePrice")) Then
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*presentAndPurchasePriceTextBox.*","index:=0"), FRM_DS_GetValue(objData, "PurchasePrice")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "EstimatedValue")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*estimatedValueTextBox.*","index:=0"), FRM_DS_GetValue(objData, "EstimatedValue")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "LoanAmount")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*loanAmoutTextBox.*","index:=0"), FRM_DS_GetValue(objData, "LoanAmount")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NameTitleWillBeHeld")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*titleOneTextBox.*","index:=0"), FRM_DS_GetValue(objData, "NameTitleWillBeHeld")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HeldManner")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*mannerDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "HeldManner")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SourceOfDownPayment")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*sourceOfDownPaymentDownList.*","index:=0"), FRM_DS_GetValue(objData, "SourceOfDownPayment")
    End If  
    objWebCenterPage.Link("text:=Next >","index:=1").WebElement("innertext:=Next >","index:=0").Click
        
    Set objData = Nothing
    Set objWebCenterPage = Nothing
End Function



'This function is used to enter data to Personal Information page of webcenter
'@code
'    BIZ_WebCenter_PersonalInformation(strRowID)
'@endcode
'@param strRowID - row Id to use in the data sheet

Function BIZ_WebCenter_PersonalInformation(strRowID)
    FRM_Logger_ReportInfoEvent "WebCenter Site - Personal Information tab", "Enter data in Personal Information page using 'PersonalInformation' datasheet RowId:" & strRowID, null 
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "PersonalInformation", strRowID)
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Personal Information","index:=0"),60

    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MaritalStatus")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boMaritalStatusDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "MaritalStatus")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "DateOfBirth")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boBirthTextBox.*","index:=0"), FRM_DS_GetValue(objData, "DateOfBirth")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "NumberOfDependents")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boDependentsTextBox.*","index:=0"), FRM_DS_GetValue(objData, "NumberOfDependents")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "DependentAge")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boAgeTextBox.*","index:=0"), FRM_DS_GetValue(objData, "DependentAge")
    End If      
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SSN")) Then
        strSSN = FRM_DS_GetValue(objData, "SSN")
        strSSN = UTIL_String_RemoveCharacters(strSSN,array("-","(",")"," ","."))
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSocialIDOneTextBox.*","index:=0"), mid(strSSN,1,3)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSocialIDTwoTextBox.*","index:=0"), mid(strSSN,4,2)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*boSocialIDThreeTextBox.*","index:=0"), mid(strSSN,6,4)
    End If    
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HomePhone")) Then
        strHomePhone = FRM_DS_GetValue(objData, "HomePhone")
        strHomePhone = UTIL_String_RemoveCharacters(strHomePhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boHomePhone.areaCodeTextBox.*","index:=0"), mid(strHomePhone,1,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boHomePhone.prefixTextBox.*","index:=0"), mid(strHomePhone,4,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boHomePhone.suffixTextBox.*","index:=0"), mid(strHomePhone,7,4)
    End If    
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CellPhone")) Then
        strCellPhone = FRM_DS_GetValue(objData, "CellPhone")
        strCellPhone = UTIL_String_RemoveCharacters(strCellPhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCellPhone.areaCodeTextBox.*","index:=0"), mid(strCellPhone,1,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCellPhone.prefixTextBox.*","index:=0"), mid(strCellPhone,4,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCellPhone.suffixTextBox.*","index:=0"), mid(strCellPhone,7,4)
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "StreetAddress")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentAddressTextBox.*","index:=0"), FRM_DS_GetValue(objData, "StreetAddress")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentCityTextBox.*","index:=0"), FRM_DS_GetValue(objData, "City")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boCurrentStateDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "State")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
        strZip = FRM_DS_GetValue(objData, "Zip")
        strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentZipTextBox.*","index:=0"), mid(strZip,1,5)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentExtZipTextBox.*","index:=0"), mid(strZip,6,4)
    End If      
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "YearsAtThisAddress")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentYearsAtTextBox.*","index:=0"), FRM_DS_GetValue(objData, "YearsAtThisAddress")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Months")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*boCurrentMonthsAtTextBox.*","index:=0"), FRM_DS_GetValue(objData, "Months")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "RentOrOwn")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*boRentOrOwnDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "RentOrOwn")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MailingAddressDiferent")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*boMailingDifferentAddressRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "MailingAddressDiferent")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "FurnishGovernmentMonitoring")) Then 
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*boFurnishGoverInfoOptionCheckBox.*","index:=0"),FRM_DS_GetValue(objData, "FurnishGovernmentMonitoring")    
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Sex")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*boSexRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "Sex")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Ethnicity")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*boEthRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "Ethnicity")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Race")) Then    
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*boRaceRadioButtonList." & FRM_DS_GetValue(objData, "Race") & ".*","index:=0"),"ON" 
    End If
    
    'Co-Borrower Info    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrMaritalStatus")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coBoMaritalStatusDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrMaritalStatus")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrDateOfBirth")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoBirthTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrDateOfBirth")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrNumberOfDependents")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoDependentsTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrNumberOfDependents")
    End If  
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrDependentAge")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoAgeTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrDependentAge")
    End If      
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrSSN")) Then
        strSSN = FRM_DS_GetValue(objData, "CoBorrSSN")
        strSSN = UTIL_String_RemoveCharacters(strSSN,array("-","(",")"," ","."))
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coBoSocialIDOneTextBox.*","index:=0"), mid(strSSN,1,3)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coBoSocialIDTwoTextBox.*","index:=0"), mid(strSSN,4,2)
        GUI_WebEdit_Set  objWebCenterPage.WebEdit("html id:=.*coBoSocialIDThreeTextBox.*","index:=0"), mid(strSSN,6,4)
    End If    
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrHomePhone")) Then
        strHomePhone = FRM_DS_GetValue(objData, "CoBorrHomePhone")
        strHomePhone = UTIL_String_RemoveCharacters(strHomePhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoHomePhone.areaCodeTextBox.*","index:=0"), mid(strHomePhone,1,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoHomePhone.prefixTextBox.*","index:=0"), mid(strHomePhone,4,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoHomePhone.suffixTextBox.*","index:=0"), mid(strHomePhone,7,4)
    End If
        
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrCellPhone")) Then
        strCellPhone = FRM_DS_GetValue(objData, "CoBorrCellPhone")
        strCellPhone = UTIL_String_RemoveCharacters(strCellPhone,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCellPhone.areaCodeTextBox.*","index:=0"), mid(strCellPhone,1,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCellPhone.prefixTextBox.*","index:=0"), mid(strCellPhone,4,3)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCellPhone.suffixTextBox.*","index:=0"), mid(strCellPhone,7,4)
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrStreetAddress")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentAddressTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrStreetAddress")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrCity")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentCityTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrCity")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrState")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coBoCurrentStateDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrState")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrZip")) Then
        strZip = FRM_DS_GetValue(objData, "CoBorrZip")
        strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentZipTextBox.*","index:=0"), mid(strZip,1,5)
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentExtZipTextBox.*","index:=0"), mid(strZip,6,4)
    End If      
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrYearsAtThisAddress")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentYearsAtTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrYearsAtThisAddress")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrMonths")) Then
        GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*coBoCurrentMonthsAtTextBox.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrMonths")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrRentOrOwn")) Then
        GUI_WebList_Select objWebCenterPage.WebList("html id:=.*coBoRentOrOwnDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrRentOrOwn")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrMailingAddressDiferent")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*coBoMailingDifferentAddressRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrMailingAddressDiferent")
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrFurnishGovernmentMonitoring")) Then   
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*coBoFurnishGoverInfoOptionCheckBox.*","index:=0"),FRM_DS_GetValue(objData, "CoBorrFurnishGovernmentMonitoring")    
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrSex")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*coBoSexRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrSex")
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrEthnicity")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("html id:=.*coBoEthRadioButtonList.*","index:=0"), FRM_DS_GetValue(objData, "CoBorrEthnicity")
    End If  
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoBorrRace")) Then  
        GUI_WebCheckbox_Set objWebCenterPage.WebCheckBox("html id:=.*coBoRaceRadioButtonList." & FRM_DS_GetValue(objData, "CoBorrRace") & ".*","index:=0"),"ON" 
    End If  

    objWebCenterPage.Link("text:=Next >","index:=1").WebElement("innertext:=Next >","index:=0").Click
        
    Set objData = Nothing
    Set objWebCenterPage = Nothing
End Function



'This function is used to enter data to Employment & Income page of webcenter
'@code
'    BIZ_WebCenter_EmploymentAndIncome "CND494-1_TC1,CND494-2_TC1|CND494-3_TC1,CND494-4_TC1"
'@endcode
'@param strRowIDs - coma delimited list of row Ids to use for one employee and Pipe delimited for multiple employees in the data sheet

Function BIZ_WebCenter_EmploymentAndIncome(strRowIDs)
    
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Employment & Income","index:=0"),60   
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CanProvideProofOfIncome")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*borrowerDocIncomeRadio.*","index:=0"), FRM_DS_GetValue(objData, "CanProvideProofOfIncome")
    End If  
    arrRowIDs = Split(strRowIDs,"|")
    For intEmployee = 0 To Ubound(arrRowIDs)
        strEmployeeJobs = arrRowIDs(intEmployee)
        If NOT strEmployeeJobs = "" Then
            objWebCenterPage.Link("text:=Enter Employment Information","index:="& intEmployee).WebElement("innertext:=Enter Employment Information","index:=0").Click
            GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Enter Employment Information.*","index:=0"),60
        End If      
        arrRowID = Split(strEmployeeJobs,",") 
        For intJob = 0 to ubound(arrRowID)  
            strRowID = arrRowID(intJob)         
            FRM_Logger_ReportInfoEvent "WebCenter Site - Employment & Income tab", "Enter data in Employment & Income page using 'EmploymentAndIncome' datasheet RowId:" & strRowID, null 
            Set objData = FRM_DS_GetTestData("WebCenter_Application", "EmploymentAndIncome", strRowID)
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CurrentPreviousEmployer")) Then
                GUI_WebList_Select  objWebCenterPage.WebList("html id:=.*employmentTypeDpl.*","index:=0"), FRM_DS_GetValue(objData, "CurrentPreviousEmployer")
            End If
    
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "EmployerName")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*employerNameTextBox.*","index:=0"), FRM_DS_GetValue(objData, "EmployerName")
            End If
            
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "EmployerAddress")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*employerAddressTextBox.*","index:=0"), FRM_DS_GetValue(objData, "EmployerAddress")
            End If  
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*cityTextBox.*","index:=0"), FRM_DS_GetValue(objData, "City")
            End If
            
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
                GUI_WebList_Select objWebCenterPage.WebList("html id:=.*stateDpl.*","index:=0"), FRM_DS_GetValue(objData, "State")
            End If
            
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
                strZip = FRM_DS_GetValue(objData, "Zip")
                strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*zipTextBox.*","index:=0"), mid(strZip,1,5)
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*extZipTextBox.*","index:=0"), mid(strZip,6,4)
            End If  
    
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "WorkPhone")) Then
                strWorkPhone = FRM_DS_GetValue(objData, "WorkPhone")
                strWorkPhone = UTIL_String_RemoveCharacters(strWorkPhone,array("-","(",")"," ","."))
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*areaCodeTextBox.*","index:=0"), mid(strWorkPhone,1,3)
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*prefixTextBox.*","index:=0"), mid(strWorkPhone,4,3)
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*suffixTextBox.*","index:=0"), mid(strWorkPhone,7,4)
            End If
            
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BusinessType")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*businessTypeTextBox.*","index:=0"), FRM_DS_GetValue(objData, "BusinessType")
            End If  
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "TitlePosition")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*positionTextBox.*","index:=0"), FRM_DS_GetValue(objData, "TitlePosition")
            End If
    
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SelfEmployed")) Then
                GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*isSelfEmployedDpl.*","index:=0"), FRM_DS_GetValue(objData, "SelfEmployed")
            End If
            
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "EmployedFrom")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*employedStartDateTextBox.*","index:=0"), FRM_DS_GetValue(objData, "EmployedFrom")
            End If  
                If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "EmployedTo")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*employedEndDateTextBox.*","index:=0"), FRM_DS_GetValue(objData, "EmployedTo")
            End If  
            
            If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MonthlyBaseIncome")) Then
                GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*monthlyBaseIncomeTextBox.*","index:=0"), FRM_DS_GetValue(objData, "MonthlyBaseIncome")
            End If

            If intJob < ubound(arrRowID) Then
                objWebCenterPage.Link("text:=Add Another","index:=1").WebElement("innertext:=Add Another","index:=0").Click
            End If  
        Next
        If NOT strEmployeeJobs = "" Then
            objWebCenterPage.Link("text:=Done","index:=1").WebElement("innertext:=Done","index:=0").Click
            GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Employment & Income","index:=0"),60       
        End If 
    Next    
    Set objData = Nothing
    Set objWebCenterPage = Nothing
End Function



'This function is used to enter data to Assets page of webcenter
'@code
'    BIZ_WebCenter_Assets CND494-1_TC1,CND494-2_TC1"
'@endcode
'@param strRowIDs - coma delimited list of row Ids to use in the data sheet

Function BIZ_WebCenter_Assets(strRowIDs)
    arrRowIDs = Split(strRowIDs,",") 
    intRecords = Ubound(arrRowIDs) + 1
    intProcessed = 0
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Assets and Liabilities","index:=0"),60
    objWebCenterPage.Link("text:=.*Enter Assets.*","index:=1").WebElement("innertext:=.*Enter Assets.*","index:=0").Click
        
    For each strRowID in arrRowIDs  
        Set objData = FRM_DS_GetTestData("WebCenter_Application", "Assets", strRowID)
        FRM_Logger_ReportInfoEvent "WebCenter Site - Assets", "Enter data in Assets page using 'Assets' datasheet RowId:" & strRowID, null    
        GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead2","innertext:=Asset Details","index:=0"),60
          
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "AccountAssetType")) Then
            GUI_WebList_Select objWebCenterPage.WebList("name:=.*assetAccountTypeDDl.*","index:=0"), FRM_DS_GetValue(objData, "AccountAssetType")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "OwnedBy")) Then
            If objWebCenterPage.WebList("name:=.*ownedByDDL.*","index:=0").Exist(1) Then
                If isNumeric(FRM_DS_GetValue(objData, "OwnedBy")) Then
                   vOwnedBy = cInt(FRM_DS_GetValue(objData, "OwnedBy"))
                Else
                   vOwnedBy =  FRM_DS_GetValue(objData, "OwnedBy")          
                End If
                GUI_WebList_Select objWebCenterPage.WebList("name:=.*ownedByDDL.*","index:=0"),  vOwnedBy 
            End If  
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CashValue")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*cashValueTxt.*","index:=0"), FRM_DS_GetValue(objData, "CashValue")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "AccountNumber")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*accountNumberTxt.*","index:=0"), FRM_DS_GetValue(objData, "AccountNumber")
        End If

        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Institution")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*institutionTxt.*","index:=0"), FRM_DS_GetValue(objData, "Institution")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Address")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*addressTxt.*","index:=0"), FRM_DS_GetValue(objData, "Address")
        End If  
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*cityTxt.*","index:=0"), FRM_DS_GetValue(objData, "City")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
            GUI_WebList_Select objWebCenterPage.WebList("html id:=.*stateDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "State")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
            strZip = FRM_DS_GetValue(objData, "Zip")
            strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*zipTxt.*","index:=0"), mid(strZip,1,5)
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*extZipTxt.*","index:=0"), mid(strZip,6,4)
        End If  
        intProcessed = intProcessed + 1
        If intRecords = intProcessed Then
            Exit For
        Else
            objWebCenterPage.Link("text:=Add Another","index:=1").WebElement("innertext:=Add Another","index:=0").Click
        End If      
    Next        
    objWebCenterPage.Link("text:=Done","index:=1").WebElement("innertext:=Done","index:=0").Click
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Assets and Liabilities","index:=0"),60
    
    Set objData = Nothing
    Set objWebCenterPage = Nothing
End Function



'This function is used to enter data to Liabilities page of webcenter
'@code
'    BIZ_WebCenter_Liabilities CND494-1_TC1,CND494-2_TC1"
'@endcode
'@param strRowIDs - coma delimited list of row Ids to use in the data sheet

Function BIZ_WebCenter_Liabilities(strRowIDs)
    arrRowIDs = Split(strRowIDs,",") 
    intRecords = Ubound(arrRowIDs) + 1
    intProcessed = 0
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Assets and Liabilities","index:=0"),60
    objWebCenterPage.Link("text:=.*Enter Liabilities.*","index:=1").WebElement("innertext:=.*Enter Liabilities.*","index:=0").Click
    For each strRowID in arrRowIDs
        FRM_Logger_ReportInfoEvent "WebCenter Site - Liabilities", "Enter data in Liabilities page using 'Liabilities' datasheet RowId:" & strRowID, null 
        Set objData = FRM_DS_GetTestData("WebCenter_Application", "Liabilities", strRowID)
        GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead2","innertext:=Liability Details","index:=0"),60
          
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "LiabilityType")) Then
            GUI_WebList_Select objWebCenterPage.WebList("name:=.*liabilityTypeDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "LiabilityType")
        End If
        
                
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "OwnedBy")) Then
            If objWebCenterPage.WebList("name:=.*ownedByDropDownList.*","index:=0").Exist(1) Then
                If isNumeric(FRM_DS_GetValue(objData, "OwnedBy")) Then
                   vlOwnedBy = cInt(FRM_DS_GetValue(objData, "OwnedBy"))
                Else
                   vlOwnedBy = FRM_DS_GetValue(objData, "OwnedBy")          
                End If
                GUI_WebList_Select objWebCenterPage.WebList("name:=.*ownedByDropDownList.*","index:=0"),  vlOwnedBy 
            End If  
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "AccountNumber")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*accountNumberTxt.*","index:=0"), FRM_DS_GetValue(objData, "AccountNumber")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Balance")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*balanceTxt.*","index:=0"), FRM_DS_GetValue(objData, "Balance")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MonthlyPayment")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*monthlyPaymentTxt.*","index:=0"), FRM_DS_GetValue(objData, "MonthlyPayment")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "MonthsLeftToPay")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*monthsLeftTxt.*","index:=0"), FRM_DS_GetValue(objData, "MonthsLeftToPay")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsPaidByClose")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*isPaidByClose.*","index:=0"), FRM_DS_GetValue(objData, "IsPaidByClose")
        End If

        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Institution")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*insititionTxt.*","index:=0"), FRM_DS_GetValue(objData, "Institution")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Address")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*addressTxt.*","index:=0"), FRM_DS_GetValue(objData, "Address")
        End If  
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "City")) Then
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*cityTxt.*","index:=0"), FRM_DS_GetValue(objData, "City")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "State")) Then
            GUI_WebList_Select objWebCenterPage.WebList("html id:=.*stateDropDownList.*","index:=0"), FRM_DS_GetValue(objData, "State")
        End If
        
        If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "Zip")) Then
            strZip = FRM_DS_GetValue(objData, "Zip")
            strZip = UTIL_String_RemoveCharacters(strZip,array("-","(",")"," ","."))
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*zipTxt.*","index:=0"), mid(strZip,1,5)
            GUI_WebEdit_Set objWebCenterPage.WebEdit("html id:=.*extZipTxt.*","index:=0"), mid(strZip,6,4)
        End If  
        intProcessed = intProcessed + 1
        If intRecords = intProcessed Then
            Exit For
        Else
            objWebCenterPage.Link("text:=Add Another","index:=1").WebElement("innertext:=Add Another","index:=0").Click
        End If
    Next    
    objWebCenterPage.Link("text:=Done","index:=1").WebElement("innertext:=Done","index:=0").Click
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Assets and Liabilities","index:=0"),60
        
    Set objData = Nothing
    Set objWebCenterPage = Nothing
        
End Function



'This function is used to enter data to Declaration page of webcenter
'@code
'    BIZ_WebCenter_Declarations (strRowID)
'@endcode
'@param strRowID - row Id to use in the data sheet

Function BIZ_WebCenter_Declarations (strRowID)
    FRM_Logger_ReportInfoEvent "WebCenter Site - Declarations ", "Enter data in Declarations page using 'Declarations' datasheet RowId:" & strRowID, null 
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "Declarations", strRowID)
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=WebAppHead1","innertext:=Declarations","index:=0"),60
        
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsOutstandingAgainst")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsOutstandingAgainst.*","index:=0"), "boIsOutstandingAgainst" & FRM_DS_GetValue(objData, "IsOutstandingAgainst") & "RB"
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HasDeclaredBankruptPast7Years")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boHasDeclaredBankruptPast7Years.*","index:=0"), "boHasDeclaredBankruptPast7Years" & FRM_DS_GetValue(objData, "HasDeclaredBankruptPast7Years") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HasPropertyForeclosedPast7Years")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boHasPropertyForeclosedPast7Years.*","index:=0"), "boHasPropertyForeclosedPast7Years" & FRM_DS_GetValue(objData, "HasPropertyForeclosedPast7Years") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsPartyToLawsuit")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsPartyToLawsuit.*","index:=0"), "boIsPartyToLawsuit" & FRM_DS_GetValue(objData, "IsPartyToLawsuit") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsObligatedOnLoan")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsObligatedOnLoan.*","index:=0"), "boIsObligatedOnLoan" & FRM_DS_GetValue(objData, "IsObligatedOnLoan") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsDelinquentFederalDebt")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsDelinquentFederalDebt.*","index:=0"), "boIsDelinquentFederalDebt" & FRM_DS_GetValue(objData, "IsDelinquentFederalDebt") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsObligateToPayAlimony")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsObligateToPayAlimony.*","index:=0"), "boIsObligateToPayAlimony" & FRM_DS_GetValue(objData, "IsObligateToPayAlimony") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsDownPaymentBorrowed")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsDownPaymentBorrowed.*","index:=0"), "boIsDownPaymentBorrowed" & FRM_DS_GetValue(objData, "IsDownPaymentBorrowed") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsCoMakerOnANote")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsCoMakerOnANote.*","index:=0"), "boIsCoMakerOnANote" & FRM_DS_GetValue(objData, "IsCoMakerOnANote") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsUSCitizen")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsUSCitizen.*","index:=0"), "boIsUSCitizen" & FRM_DS_GetValue(objData, "IsUSCitizen") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsPermanentResidentAlien")) Then
       If NOT objWebCenterPage.WebRadioGroup("name:=.*boIsPermanentResidentAlien.*","index:=0").GetROProperty("disabled") = 1 Then
          GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsPermanentResidentAlien.*","index:=0"), "boIsPermanentResidentAlien" & FRM_DS_GetValue(objData, "IsPermanentResidentAlien") & "RB"
       End If           
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "IsIntendToOccupyTheProperty")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boIsIntendToOccupyTheProperty.*","index:=0"), "boIsIntendToOccupyTheProperty" & FRM_DS_GetValue(objData, "IsIntendToOccupyTheProperty") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HasOwnershipInterestInAProperty")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*boHasOwnershipInterestInAProperty.*","index:=0"), "boHasOwnershipInterestInAProperty" & FRM_DS_GetValue(objData, "HasOwnershipInterestInAProperty") & "RB"
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "PropertyTypeYouOwn")) Then
        If objWebCenterPage.WebList("name:=.*boPropertyTypeYouOwnDDL.*","index:=0").Exist(1) Then
            GUI_WebList_Select objWebCenterPage.WebList("name:=.*boPropertyTypeYouOwnDDL.*","index:=0"),  FRM_DS_GetValue(objData, "PropertyTypeYouOwn") 
        End If  
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "HoldTitleToHome")) Then
        If objWebCenterPage.WebList("name:=.*boHoldTitleToHomeDDL.*","index:=0").Exist(1) Then
            GUI_WebList_Select objWebCenterPage.WebList("name:=.*boHoldTitleToHomeDDL.*","index:=0"),  FRM_DS_GetValue(objData, "HoldTitleToHome") 
        End If  
    End If  
    
	'Co-Borrower Declarations
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsOutstandingAgainst")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsOutstandingAgainst.*","index:=0"), "coIsOutstandingAgainst" & FRM_DS_GetValue(objData, "CoIsOutstandingAgainst") & "RB"
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoHasDeclaredBankruptPast7Years")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coHasDeclaredBankruptPast7Years.*","index:=0"), "coHasDeclaredBankruptPast7Years" & FRM_DS_GetValue(objData, "CoHasDeclaredBankruptPast7Years") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoHasPropertyForeclosedPast7Years")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coHasPropertyForeclosedPast7Years.*","index:=0"), "coHasPropertyForeclosedPast7Years" & FRM_DS_GetValue(objData, "CoHasPropertyForeclosedPast7Years") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsPartyToLawsuit")) Then
            GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsPartyToLawsuit.*","index:=0"), "coIsPartyToLawsuit" & FRM_DS_GetValue(objData, "CoIsPartyToLawsuit") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsObligatedOnLoan")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsObligatedOnLoan.*","index:=0"), "coIsObligatedOnLoan" & FRM_DS_GetValue(objData, "CoIsObligatedOnLoan") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsDelinquentFederalDebt")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsDelinquentFederalDebt.*","index:=0"), "coIsDelinquentFederalDebt" & FRM_DS_GetValue(objData, "CoIsDelinquentFederalDebt") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsObligateToPayAlimony")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsObligateToPayAlimony.*","index:=0"), "coIsObligateToPayAlimony" & FRM_DS_GetValue(objData, "CoIsObligateToPayAlimony") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsDownPaymentBorrowed")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsDownPaymentBorrowed.*","index:=0"), "coIsDownPaymentBorrowed" & FRM_DS_GetValue(objData, "CoIsDownPaymentBorrowed") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsCoMakerOnANote")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsCoMakerOnANote.*","index:=0"), "coIsCoMakerOnANote" & FRM_DS_GetValue(objData, "CoIsCoMakerOnANote") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsUSCitizen")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsUSCitizen.*","index:=0"), "coIsUSCitizen" & FRM_DS_GetValue(objData, "CoIsUSCitizen") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsPermanentResidentAlien")) Then
		If NOT objWebCenterPage.WebRadioGroup("name:=.*coIsPermanentResidentAlien.*","index:=0").GetROProperty("disabled") = 1 Then
			GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsPermanentResidentAlien.*","index:=0"), "coIsPermanentResidentAlien" & FRM_DS_GetValue(objData, "CoIsPermanentResidentAlien") & "RB"
		End If           
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoIsIntendToOccupyTheProperty")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coIsIntendToOccupyTheProperty.*","index:=0"), "coIsIntendToOccupyTheProperty" & FRM_DS_GetValue(objData, "CoIsIntendToOccupyTheProperty") & "RB"
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoHasOwnershipInterestInAProperty")) Then
        GUI_WebRadioGroup_Select objWebCenterPage.WebRadioGroup("name:=.*coHasOwnershipInterestInAProperty.*","index:=0"), "coHasOwnershipInterestInAProperty" & FRM_DS_GetValue(objData, "CoHasOwnershipInterestInAProperty") & "RB"
    End If
    
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoPropertyTypeYouOwn")) Then
        If objWebCenterPage.WebList("name:=.*coPropertyTypeYouOwnDDL.*","index:=0").Exist(1) Then
            GUI_WebList_Select objWebCenterPage.WebList("name:=.*coPropertyTypeYouOwnDDL.*","index:=0"),  FRM_DS_GetValue(objData, "CoPropertyTypeYouOwn") 
        End If  
    End If
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "CoHoldTitleToHome")) Then
        If objWebCenterPage.WebList("name:=.*coHoldTitleToHomeDDL.*","index:=0").Exist(1) Then
            GUI_WebList_Select objWebCenterPage.WebList("name:=.*coHoldTitleToHomeDDL.*","index:=0"),  FRM_DS_GetValue(objData, "CoHoldTitleToHome") 
        End If  
    End If          
    objWebCenterPage.Link("text:=.*Next.*","index:=1").WebElement("innertext:=.*Next.*","index:=0").Click        
    Set objData = Nothing
    Set objWebCenterPage = Nothing
	
End Function



'This function is used to click correct button on eConsent Page
'@code
'    BIZ_WebCenter_Consent "I Agree"
'@endcode
'@param isAgree - string "I Agree" or  " I Do Not Agree"

Function BIZ_WebCenter_Consent(isAgree)

    FRM_Logger_ReportInfoEvent "WebCenter Site - Consent", "Your Consent To Do Business Electronically. Clicked: "&isAgree , null 
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=header","innertext:=.*Your Consent.*","index:=0"),60   
    If isAgree = "Skip this Step" Then
		objWebCenterPage.Link("text:=Skip this Step","index:=0").Click
	Else	
		objWebCenterPage.Link("text:=.*"&isAgree&".*","index:=1").WebElement("innertext:=.*"&isAgree&".*","index:=0").Click
    End If
	Set objWebCenterPage = Nothing
	
End Function



'This function is used to Submit application by clicking on Submit button
'@code
'    BIZ_WebCenter_SubmitApplication()
'@endcode

Function BIZ_WebCenter_SubmitApplication()

    FRM_Logger_ReportInfoEvent "WebCenter Site - Submit", "Click Submit button on Summary page", null 
    Set objWebCenterPage = Browser("name:=Ellie Mae.*").Page("title:=Ellie Mae.*")
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("class:=.*WebAppHead1.*","innertext:=Summary","index:=0"),60   
    objWebCenterPage.Link("text:=.*Submit.*","index:=1").WebElement("innertext:=.*Submit.*","index:=0").Click
    GUI_Object_WaitTillExistX objWebCenterPage.WebElement("html id:=.*lblHeaderMessage.*","innertext:=Thank You","index:=0"),60
    
    If objWebCenterPage.WebElement("html id:=.*lblHeaderMessage.*","innertext:=Thank You","index:=0").Exist(1) and _
        objWebCenterPage.Link("text:=Return to Home Page","index:=0").Exist(1) Then
 
        FRM_Logger_ReportPassEvent "WebCenter - Application Submitted", "Application is submitted with successful message and link to 'Return to Home page' available", null 
    Else
        FRM_Logger_ReportFailEvent "WebCenter - Application Submitted", "Application is NOT submitted or submitted with issues ", null  
    End If
    Set objWebCenterPage = Nothing
	
End Function



'This function is used to Create New Account on E-mail from webcenter response. Page opened using link from e-mail
'@code
'    BIZ_WebCenter_CreateNewAccount (strRowID)
'@endcode
'@param strRowID - row id to use for data from datasheet

Function BIZ_WebCenter_CreateNewAccount (strRowID)

    'Create New Account Page must be opened before function call
    FRM_Logger_ReportInfoEvent "Create New Account", "Provide values for required details for a new account", null
    Set objNewAccountPage = Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*")
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "LoanInformation", strRowID)
    GUI_Object_WaitTillExistX objNewAccountPage.WebEdit("name:=.*textboxAddress.*"),60
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "SubjectPropertyAddress")) Then
        strNumber = split(FRM_DS_GetValue(objData, "SubjectPropertyAddress")," ")(0)
        GUI_WebEdit_Set objNewAccountPage.WebEdit("name:=.*textboxAddress.*"), strNumber
    End If	
    Set objData = Nothing
	
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "Basic", strRowID)
    If UTIL_String_IsNotEmpty(FRM_DS_GetValue(objData, "BorrowerFirstName")) Then       
        GUI_WebEdit_Set objNewAccountPage.WebEdit("name:=.*newFirstNameTextBox.*"), FRM_DS_GetValue(objData, "BorrowerFirstName")
    End If   
    GUI_WebEdit_Set  objNewAccountPage.WebEdit("html id:=.*newLastNameTextBox.*","index:=0"), FRM_RT_GetPropValue("BorrowerLastName", True)      
    objNewAccountPage.WebEdit("name:=.*newPasswordTextBox.*").Set  FRM_DS_GetValue(objData, "BorrowerEmailPassword")       
    objNewAccountPage.WebEdit("name:=.*newReEnterPasswordTextBox.*").Set FRM_DS_GetValue(objData, "BorrowerEmailPassword")           
    objNewAccountPage.Link("text:=.*Create New Account.*").WebElement("innertext:=.*Create New Account.*").Click      
    Set objData = Nothing
	
    If (objNewAccountPage.WebElement("class:=.*paddingBottom.*","innertext:=Create New Account").Exist(10) and _
        objNewAccountPage.WebElement("html tag:=TD","innertext:=.*Next steps:.*","index:=0").Exist(5)) OR _
        objNewAccountPage.WebElement("class:=Header5","innertext:=Loan Detail","index:=0").Exist(5) OR _
        objNewAccountPage.WebElement("innertext:=Check Loan Status","index:=0").Exist(5)       Then  ' for QA
        FRM_Logger_ReportPassEvent "Provide values for a New Account", "'Create New Account' page is displayed with the email request is sent and Next steps details ", null 
    Else
        FRM_Logger_ReportFailEvent "Provide values for a New Account", "Create New Account' page is NOT displayed", null 
    End If

End Function



'This function is used to Create New Account on E-mail from webcenter response. Page opened using link from e-mail
'@code
'    BIZ_WebCenter_AccountDelete(strRowID,boolDelete)
'@endcode
'@param strRowID - row id to use for data from datasheet
'@param boolDelete - true/false to delete account

Function BIZ_WebCenter_AccountDelete(strRowID)
        BIZ_WebCenter_OpenSite strRowID
        Set objWebCenterPage = Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*")
        objWebCenterPage.Link("text:=Log.*","index:=0").Click
        BIZ_WebCenter_LogIn strRowID
        boolStop = false
        If objWebCenterPage.WebElement("innertext:=The email or password is invalid.*","html id:=.*labelError.*").Exist(3) OR _
           objWebCenterPage.WebElement("innertext:=Account not activated.*","html id:=.*labelError.*").Exist(3) Then
           boolStop = true
        End If
        If NOT boolStop Then
            If objWebCenterPage.Link("text:=My Account.*","index:=0").Exist(5) Then
                objWebCenterPage.Link("text:=My Account.*","index:=0").Click    
            End If
            If objWebCenterPage.Link("text:=Delete Account.*","index:=0").Exist(5) Then
                objWebCenterPage.Link("text:=Delete Account.*","index:=0").Click    
            End If  
            If objWebCenterPage.WebCheckBox("name:=.*yesCheckBox.*","index:=0").Exist(5) Then
                objWebCenterPage.WebCheckBox("name:=.*yesCheckBox.*","index:=0").Set "ON"   
            End If  
            objWebCenterPage.Link("text:=.*Delete Account.*","html id:=.*delButton.linkButton.*").WebElement("innertext:=.*Delete Account.*","index:=0").Click
            If objWebCenterPage.WebElement("class:=.*Header.*","innertext:=.*Account Deleted.*","index:=0").Exist(15) Then
                FRM_Logger_ReportPassEvent "Account Deleted", "User deleted WebCenter account", null    
            End If
        End If    
End Function



'This function is used to Log Out WebCenter Account 
'@code
'    BIZ_WebCenter_LogOut()
'@endcode
Function BIZ_WebCenter_LogOut()
	Dim objBrowser, objAccountPage
    If(GUI_Object_IsExist(Browser("name:=.*Ellie Mae.*", "index:=0").Page("title:=.*Ellie Mae.*", "index:=0"))) Then 
		Set objBrowser = Browser("name:=.*Ellie Mae.*", "index:=0")
		Set objAccountPage = objBrowser.Page("title:=.*Ellie Mae.*", "index:=0")
	ElseIf(GUI_Object_IsExist(Browser("name:=.*Mortgage.*", "index:=0").Page("title:=.*Mortgage.*", "index:=0"))) Then
		Set objBrowser =  Browser("name:=.*Mortgage.*", "index:=0")
		Set objAccountPage = objBrowser.Page("title:=.*Mortgage.*", "index:=0")
	End If
    objAccountPage.Link("text:=Log Out","index:=0").Click
	Wait g_TinyWaitSmall
	objBrowser.Close()
    Set objAccountPage = Nothing
    FRM_Logger_ReportInfoEvent "Log Out Loan Center", "User Logs Out the Loan Center", null
End Function



'This function is used to Log In SWebCenter Account 
'@code
'    BIZ_WebCenter_LogIn(strRowID)
'@endcode
'@param strRowID - row id to use for data from datasheet

Function BIZ_WebCenter_LogIn(strRowID)
    FRM_Logger_ReportInfoEvent "Log In WebCenter Account", "User Log In WebCenter account", null
    Set objData = FRM_DS_GetTestData("Global_Data", "Website", strRowID)
    Set objAccountPage = Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*")
    If NOT objAccountPage.Exist(2) Then
        BIZ_WebCenter_OpenSite (strRowID)
        GUI_Object_WaitTillExistX objAccountPage,120
        objAccountPage.Link("text:=Log.*","index:=0").Click
    End If  
    
    strEmail = FRM_DS_GetValue(objData, "EmailAccount")
    strPwd = FRM_DS_GetValue(objData, "Password")
    j = 0
    boolExit = false
    Do
        If objAccountPage.WebEdit("name:=.*textboxEmail.*").Exist(1) Then
            boolExit = true   
        End If  
        If objAccountPage.Link("text:=.*New Account.*","html id:=.*linkButton.*","index:=0").Exist(1) Then
            boolExit = true   
        End If  
        If objAccountPage.Link("text:=.*Login.*","index:=0").Exist(1) Then
            boolExit = true   
        End If

    	j = j + 1
        If boolExit or j > 120 Then
           Exit Do
        End If 
   
    Loop    
	
    If objAccountPage.WebEdit("name:=.*textboxEmail.*","index:=0").Exist(10) Then
       objAccountPage.WebEdit("name:=.*textboxEmail.*","index:=0").Set strEmail
    End If              
    If objAccountPage.Link("text:=.*New Account.*","html id:=.*linkButton.*","index:=0").Exist(2) Then
        objAccountPage.WebEdit("name:=.*passwordTextBox.*").Set strPwd 
        objAccountPage.Link("text:=.*New Account.*").WebElement("innertext:=.*New Account.*").Click 
        
        FRM_Logger_ReportInfoEvent "Create New WebCenter Account", strEmail & "," & strPwd, null                
    ElseIf objAccountPage.Link("text:=.*Login.*","index:=0").Exist(2) Then
    
        objAccountPage.WebEdit("name:=.*textboxPassword.*").Set strPwd
        objAccountPage.Link("text:=.*Login.*","index:=0").WebElement("innertext:=.*Login.*","index:=0").Click 
        
        FRM_Logger_ReportInfoEvent "Log in to WebCenter", strEmail & "," & strPwd, null
    End If
    
    Set objData = Nothing
    Set objAccountPage = Nothing
        
End Function



'This function is used to refresh first row in e-mail box of GMAIL Account in order subject line is updated with new e-mail subject. Happens because e-mails are groupped.
'@code
'    BIZ_WebCenter_RefreshFirstEMail(strRowID)
'@endcode
'@param strRowID - row id to use for data from datasheet

Function BIZ_WebCenter_RefreshFirstEMail(strRowID)

    Set objData = FRM_DS_GetTestData("WebCenter_Application", "Basic", strRowID)
    strBorrEMail = FRM_DS_GetValue(objData, "BorrowerEmail")
        
    GUI_Browser_OpenUrl "gmail.com"  
    Set objGmail = Browser("name:=.*Gmail.*").Page("title:=.*Gmail.*","index:=0") 
    
    wait 5 ' delay to have a time to receive e-mail
    GUI_Object_WaitTillExistX objGmail,120
    
    Set objGoogle = Browser("name:=.*Google.*").Page("title:=.*Google.*","index:=0") 
    If objGmail.WebElement("html id:=reauthEmail","index:=0").Exist(2)Then
        If NOT objGmail.WebElement("html id:=reauthEmail","index:=0").GetROProperty("innertext") = strBorrEMail Then
            objGmail.Link("text:=Sign in with a different account","index:=0").Click
            wait 1
            If objGoogle.WebButton("name:=.*"&strBorrEMail& ".*","index:=0").WebElement("innertext:=.*"&strBorrEMail& ".*","index:=0").Exist(2) Then
               objGoogle.WebButton("name:=.*"&strBorrEMail& ".*","index:=0").WebElement("innertext:=.*"&strBorrEMail& ".*","index:=0").Click
            Else                           
               objGoogle.Link("text:=Add account","index:=0").Click               
            End If 
        End If
        Set objGoogle = Nothing
    End If
    If objGmail.WebEdit("name:=Email").Exist(2) and _
       NOT objGmail.WebElement("html id:=reauthEmail","innertext:=" & strBorrEMail).Exist(2)Then
        If objGmail.WebEdit("name:=Email").GetROproperty("visible") Then
            objGmail.WebEdit("name:=Email").Set strBorrEMail
            wait 1
            objGmail.WebButton("name:=Next").Click
        End If
    End If
    wait 5
    If objGmail.WebEdit("name:=Passwd").Exist(2) Then
        If objGmail.WebEdit("name:=Passwd").GetROproperty("visible") Then
            objGmail.WebEdit("name:=Passwd").Set FRM_DS_GetValue(objData, "BorrowerEmailPassword")
            wait 2
            objGmail.WebCheckBox("name:=PersistentCookie","index:=0").Set "OFF"
            wait 2
            objGmail.WebButton("name:=Sign in").Click
        End If
    End If
    wait 10
    'in case if gmail box already  opened
    GUI_Browser_Refresh
    'Browser("name:=.*Gmail.*").Refresh
    wait 2
    strBorrowerLName = FRM_RT_GetPropValue("BorrowerLastName", True)
    Set objMailTableBrowserF = objGmail.WebTable("class:=F cf zt","index:=0")
    Set objMailTableBrowserT = objGmail.WebTable("class:=th","index:=0")
    strBrowser = ""
    If objMailTableBrowserF.exist(1) Then
       Set objMailTable =  objMailTableBrowserF
	   strBrowser = "F"
    ElseIf objMailTableBrowserT.exist(1) Then 
       Set objMailTable =  objMailTableBrowserT
	   strBrowser = "T"
    End If
    Set objMailTableBrowserF = Nothing
    Set objMailTableBrowserT = Nothing
    intEMailRows = objMailTable.RowCount
    intEMailsColumns = objMailTable.ColumnCount(1)
    isFoundMail = false
    'To find e-mail search latest 3 e-mails first. Loop 5 times and refresh the browser after each loop. 
    'If not found e-mail then search all e-mails in the box.
	
	For iColumn = 3 To intEMailsColumns
        If NOT trim(objMailTable.GetCellData(1,iColumn)) = "" Then
			objMailTable.ChildItem(1,iColumn,"WebElement",0).Click  
		    wait 5
			If strBrowser = "F" then
			   If objGmail.WebElement("class:=ar6 T-I-J3 J-J5-Ji","index:=0").Exist(2) Then
				  objGmail.WebElement("class:=ar6 T-I-J3 J-J5-Ji","index:=0").Click
				  wait 2
			   End If
			End If
			If strBrowser = "T" then
			   If objGmail.Link("text:=.*Back to Inbox.*","index:=0").Exist(2) Then
				  objGmail.Link("text:=.*Back to Inbox.*","index:=0").Click
				  wait 2
			   End If
			End If				
			GUI_Browser_Refresh
			'Browser("name:=.*Gmail.*").Refresh	
            Exit For			
        End If
    Next

    'GUI_Browser_CloseAll
    UTIL_Win_CloseProcesses "chrome.exe"
    UTIL_Win_CloseProcesses "iexplore.exe"
    UTIL_Win_CloseProcesses  "firefox.exe"
 
End Function



'This function is used to read GMAIL Account e-mails for webcenter
'@code
'    BIZ_WebCenter_ReadGmailAndNavigateToAccountPage(strRowID, eType)
'@endcode
'@param strRowID - row id to use for data from datasheet
'@param eType - email type written in subject

Function BIZ_WebCenter_ReadGmailAndNavigateToAccountPage(strRowID, eType)
    BIZ_WebCenter_ReadGmailAndNavigateToAccountPage = true 
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "Basic", strRowID)
    strBorrEMail = FRM_DS_GetValue(objData, "BorrowerEmail")
        
    GUI_Browser_OpenUrl "gmail.com"  
    Set objGmail = Browser("name:=.*Gmail.*").Page("title:=.*Gmail.*","index:=0") 
    
    wait 5 ' delay to have a time to receive e-mail
    GUI_Object_WaitTillExistX objGmail,120
    
    Set objGoogle = Browser("name:=.*Google.*").Page("title:=.*Google.*","index:=0") 
    If objGmail.WebElement("html id:=reauthEmail","index:=0").Exist(2)Then
        If NOT objGmail.WebElement("html id:=reauthEmail","index:=0").GetROProperty("innertext") = strBorrEMail Then
            objGmail.Link("text:=Sign in with a different account","index:=0").Click
            wait 1
            If objGoogle.WebButton("name:=.*"&strBorrEMail& ".*","index:=0").WebElement("innertext:=.*"&strBorrEMail& ".*","index:=0").Exist(2) Then
               objGoogle.WebButton("name:=.*"&strBorrEMail& ".*","index:=0").WebElement("innertext:=.*"&strBorrEMail& ".*","index:=0").Click
            Else                           
               objGoogle.Link("text:=Add account","index:=0").Click               
            End If 
        End If
        Set objGoogle = Nothing
    End If
    If objGmail.WebEdit("name:=Email").Exist(2) and _
       NOT objGmail.WebElement("html id:=reauthEmail","innertext:=" & strBorrEMail).Exist(2)Then
        If objGmail.WebEdit("name:=Email").GetROproperty("visible") Then
            objGmail.WebEdit("name:=Email").Set strBorrEMail
            wait 1
            objGmail.WebButton("name:=Next").Click
        End If
    End If
    wait 5
    If objGmail.WebEdit("name:=Passwd").Exist(2) Then
        If objGmail.WebEdit("name:=Passwd").GetROproperty("visible") Then
            objGmail.WebEdit("name:=Passwd").Set FRM_DS_GetValue(objData, "BorrowerEmailPassword")
            wait 2
            objGmail.WebCheckBox("name:=PersistentCookie","index:=0").Set "OFF"
            wait 2
            objGmail.WebButton("name:=Sign in").Click
        End If
    End If
    wait 10
    'in case if gmail box already  opened
    GUI_Browser_Refresh
    'Browser("name:=.*Gmail.*").Refresh
    wait 10
    strBorrowerLName = FRM_RT_GetPropValue("BorrowerLastName", True)
    Set objMailTableBrowserF = objGmail.WebTable("class:=F cf zt","index:=0")
    Set objMailTableBrowserT = objGmail.WebTable("class:=th","index:=0")
    
    If objMailTableBrowserF.exist(1) Then
       Set objMailTable =  objMailTableBrowserF
    ElseIf objMailTableBrowserT.exist(1) Then 
       Set objMailTable =  objMailTableBrowserT
    End If
    Set objMailTableBrowserF = Nothing
    Set objMailTableBrowserT = Nothing
    intEMailRows = objMailTable.RowCount
    intEMailsColumns = objMailTable.ColumnCount(1)
    isFoundMail = false
    'To find e-mail search latest 3 e-mails first. Loop 5 times and refresh the browser after each loop. 
    'If not found e-mail then search all e-mails in the box.
	If eType =  "New User Account Created" Then
    	strBorrowerLName = "Thank you for creating"
    End If

    For intLoop = 1 to 1
	    wait 5
        For iMail = 1 To 15
            For iColumn = 1 To intEMailsColumns
               If instr(objMailTable.GetCellData(iMail,iColumn),strBorrowerLName) > 0 Then
                If instr(objMailTable.ChildItem(iMail,iColumn,"WebElement",0).GetROProperty("innertext"),strBorrowerLName) > 0 and _
                   instr(objMailTable.ChildItem(iMail,iColumn,"WebElement",0).GetROProperty("innertext"),eType) Then
                    objMailTable.ChildItem(iMail,iColumn,"WebElement",0).Click  
                    isFoundMail = true
                    Exit For
                End If
               End If
            Next
            If isFoundMail Then
                Exit For    
            End If
        Next    
        If isFoundMail Then
            Exit For    
        End If
        wait 10

    Next
    
    If  NOT isFoundMail Then        
        BIZ_WebCenter_ReadGmailAndNavigateToAccountPage = False  
        'GUI_Browser_CloseAll
        UTIL_Win_CloseProcesses "chrome.exe"
        UTIL_Win_CloseProcesses "iexplore.exe"
        UTIL_Win_CloseProcesses  "firefox.exe"		
		FRM_Logger_ReportInfoEvent "User reads " &eType& " eMail and clicks URL.", "User did not receive email ", null  	
    Else 
		If objGmail.Link("text:=.*mortgage.*","index:=0").exist(10) Then
			strURL = objGmail.Link("text:=.*mortgage.*","index:=0").GetROProperty("text")
			'GUI_Browser_CloseAll
			UTIL_Win_CloseProcesses "chrome.exe"
			UTIL_Win_CloseProcesses "iexplore.exe"
			UTIL_Win_CloseProcesses  "firefox.exe"
			wait 1
			GUI_Browser_OpenUrl strURL 
			FRM_Logger_ReportPassEvent "User reads " &eType& " eMail and clicks URL." , "EMail triggered asking " & eType & ". URL clicked: " & strURL, null 
		End If
	End If
    Set objMailTable = Nothing
    Set objGmail = Nothing
    
End Function



'This function is used to verify if user received e-mail
'@code
'    BIZ_WebCenter_VerifyEmailTriggeredAndReceived(strRowID, eType)
'@endcode
'@param strRowID - row id to use for data from datasheet
'@param eType - email type written in subject

Function BIZ_WebCenter_VerifyEmailTriggeredAndReceived(strRowID, eType)
    BIZ_WebCenter_RefreshFirstEMail strRowID
    Set objData = FRM_DS_GetTestData("WebCenter_Application", "Basic", strRowID)
    strBorrEMail = FRM_DS_GetValue(objData, "BorrowerEmail")
        
    GUI_Browser_OpenUrl "gmail.com"  
    Set objGmail = Browser("name:=.*Gmail.*").Page("title:=.*Gmail.*","index:=0") 
    
    wait 5 ' delay to have a time to receive e-mail
    GUI_Object_WaitTillExistX objGmail,120
    
    Set objGoogle = Browser("name:=.*Google.*").Page("title:=.*Google.*","index:=0") 
    If objGmail.WebElement("html id:=reauthEmail","index:=0").Exist(2)Then
        If NOT objGmail.WebElement("html id:=reauthEmail","index:=0").GetROProperty("innertext") = strBorrEMail Then
            objGmail.Link("text:=Sign in with a different account","index:=0").Click
            wait 1
            If objGoogle.WebButton("name:=.*"&strBorrEMail& ".*","index:=0").WebElement("innertext:=.*"&strBorrEMail& ".*","index:=0").Exist(2) Then
               objGoogle.WebButton("name:=.*"&strBorrEMail& ".*","index:=0").WebElement("innertext:=.*"&strBorrEMail& ".*","index:=0").Click
            Else                           
               objGoogle.Link("text:=Add account","index:=0").Click               
            End If 
        End If
        Set objGoogle = Nothing
    End If
    If objGmail.WebEdit("name:=Email").Exist(2) and _
       NOT objGmail.WebElement("html id:=reauthEmail","innertext:=" & strBorrEMail).Exist(2)Then
        If objGmail.WebEdit("name:=Email").GetROproperty("visible") Then
            objGmail.WebEdit("name:=Email").Set strBorrEMail
            wait 1
            objGmail.WebButton("name:=Next").Click
        End If
    End If
    wait 5
    If objGmail.WebEdit("name:=Passwd").Exist(2) Then
        If objGmail.WebEdit("name:=Passwd").GetROproperty("visible") Then
            objGmail.WebEdit("name:=Passwd").Set FRM_DS_GetValue(objData, "BorrowerEmailPassword")
            wait 2
            objGmail.WebCheckBox("name:=PersistentCookie","index:=0").Set "OFF"
            wait 2
            objGmail.WebButton("name:=Sign in").Click
        End If
    End If
    wait 10
    'in case if gmail box already  opened
    GUI_Browser_Refresh
    'Browser("name:=.*Gmail.*").Refresh
    wait 2
    strBorrowerLName = FRM_RT_GetPropValue("BorrowerLastName", True)
    Set objMailTableBrowserF = objGmail.WebTable("class:=F cf zt","index:=0")
    Set objMailTableBrowserT = objGmail.WebTable("class:=th","index:=0")
    strBrowser = ""
    If objMailTableBrowserF.exist(1) Then
       Set objMailTable =  objMailTableBrowserF
	   strBrowser = "F"
    ElseIf objMailTableBrowserT.exist(1) Then 
       Set objMailTable =  objMailTableBrowserT
	   strBrowser = "T"
    End If
    Set objMailTableBrowserF = Nothing
    Set objMailTableBrowserT = Nothing
    intEMailRows = objMailTable.RowCount
    intEMailsColumns = objMailTable.ColumnCount(1)
    isFoundMail = false
    'To find e-mail search latest 3 e-mails first. Loop 5 times and refresh the browser after each loop. 
    'If not found e-mail then search all e-mails in the box.
	
    For intLoop = 1 to 5
        For iMail = 1 To 3
            For iColumn = 3 To intEMailsColumns
               If instr(objMailTable.GetCellData(iMail,iColumn),strBorrowerLName) > 0 Then
                If instr(objMailTable.ChildItem(iMail,iColumn,"WebElement",0).GetROProperty("innertext"),strBorrowerLName) > 0 and _
                   instr(objMailTable.ChildItem(iMail,iColumn,"WebElement",0).GetROProperty("innertext"),eType) Then
                    isFoundMail = true
					'If strBrowser = "T" Then
					'	objMailTable.ChildItem(iMail,1,"WebCheckBox",0).Set "ON"
					'	wait 1
					'	objGmail.WebButton("name:=Delete","index:=0").Click
				    'ElseIf strBrowser = "F" Then		
					'	objMailTable.ChildItem(iMail,iColumn,"WebElement",0).RightClick
					'	wait 1
					'	objGmail.WebElement("innertext:=Delete","index:=0").Click
					'End If	

                    Exit For
                End If
               End If
            Next
            If isFoundMail Then
                Exit For    
            End If
        Next    
        If isFoundMail Then
            Exit For    
        End If
        wait 10
        GUI_Browser_Refresh
        'Browser("name:=.*Gmail.*").Refresh
    Next
    
    If  NOT isFoundMail Then        
        For iMail = 1 To intEMailRows
            For iColumn = 3 To intEMailsColumns
               If instr(objMailTable.GetCellData(iMail,iColumn),strBorrowerLName) > 0 Then
                If instr(objMailTable.ChildItem(iMail,iColumn,"WebElement",0).GetROProperty("innertext"),strBorrowerLName) > 0 and _
                   instr(objMailTable.ChildItem(iMail,iColumn,"WebElement",0).GetROProperty("innertext"),eType) Then
                    isFoundMail = true
					'If strBrowser = "T" Then
					'	objMailTable.ChildItem(iMail,1,"WebCheckBox",0).Set "ON"
					'	wait 1
					'	objGmail.WebButton("name:=Delete","index:=0").Click
				    'ElseIf strBrowser = "F" Then		
					'	objMailTable.ChildItem(iMail,iColumn,"WebElement",0).RightClick
					'	wait 1
					'	objGmail.WebElement("innertext:=Delete","index:=0").Click
					'End If	
                    Exit For
                End If
               End If
            Next
            If isFoundMail Then
                Exit For    
            End If
        Next    
    End If
    'GUI_Browser_CloseAll
    UTIL_Win_CloseProcesses "chrome.exe"
    UTIL_Win_CloseProcesses "iexplore.exe"
    UTIL_Win_CloseProcesses  "firefox.exe"
    If isFoundMail Then
        FRM_Logger_ReportPassEvent "E-Mail triggered and received: " &eType , "EMail triggered asking " & eType , null 
		'FRM_Logger_ReportInfoEvent "E-Mail Deleted: " &eType , "EMail Deleted for Borrower: " & strBorrowerLName & ". In order to find it, check Deleted items" , null 
    Else
        FRM_Logger_ReportFailEvent "E-Mail is Not received: " &eType, "User did not receive email ", null  
    End If
    Set objMailTable = Nothing
    Set objGmail = Nothing
    
End Function



'This function is used to open document in webcenter loan detail page for single borrower
'@code
'    BIZ_Webcenter_OpenDocumentInDetailPage(strDocSubject)
'@endcode
'@param strDocSubject - subject from e-mail sent from encompass or other description for link
Function BIZ_Webcenter_OpenDocumentInDetailPage(strDocSubject)
 
    FRM_Logger_ReportInfoEvent strDocSubject, "Open document" , null  
    Set objWebPage = Browser("name:=.*", "index:=0").Page("title:=.*", "index:=0")
    Set objTable = objWebPage.WebTable("class:=table_BottomLine","index:=0")
    intRows = objTable.RowCount
    For z = 1 To intRows
        If objTable.ChildItem(z,1,"Link",0).GetROProperty("text")= strDocSubject Then
            objTable.ChildItem(z,1,"Link",0).click
            wait 1
            objTable.ChildItem(z + 1,1,"Link",0).click
            FRM_Logger_ReportInfoEvent "Clicked Link", objTable.ChildItem(z + 1,1,"Link",0).GetROProperty("text"), null
            wait 1
            objTable.ChildItem(z + 1,1,"Link",1).click
            FRM_Logger_ReportInfoEvent "Clicked Button", objTable.ChildItem(z + 1,1,"Link",1).GetROProperty("text"), null
            Exit for
        End If 
    Next
End Function 
 
 
 
 'This function is used to get to webcenter loan detail page if account has multiple borrowers listed and each borrower has its own loan
'@code
'    BIZ_WebCenter_OpenDetailPageByBorrName(strBorrName)
'@endcode
'@param strBorrName- can be partial if unique
 
 Function BIZ_WebCenter_OpenDetailPageByBorrName(strBorrName)
 
    Set objAccountPage = Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*")
    'GUI_Object_WaitTillExistX objAccountPage.WebElement("html id:=.*pageNameLabel.*","innertext:=.*Check Loan Status.*","index:=0"),60
    If objAccountPage.WebElement("html id:=.*lbBorrowerName.*","innertext:=.*"& strBorrName & ".*").Exist(30) Then
        objAccountPage.WebElement("html id:=.*lbBorrowerName.*","innertext:=.*"& strBorrName & ".*").Click  
        FRM_Logger_ReportInfoEvent "Open Loan Detail", "Borrower selected: " & strBorrName, null
    End If
    Set objAccountPage = Nothing    
    
End Function



'This function is used to verify if user got to Check Status page
'@code
'    BIZ_WebCenter_VerifyCheckLoanStatusPage
'@endcode
Function BIZ_WebCenter_VerifyCheckLoanStatusPage()
 
    Set objAccountPage = Browser("name:=.*Ellie Mae.*").Page("title:=.*Ellie Mae.*")
    GUI_Object_WaitTillExistX objAccountPage.WebElement("html id:=.*pageNameLabel.*","innertext:=.*Check Loan Status.*","index:=0"),60
    If objAccountPage.WebElement("html id:=.*pageNameLabel.*","innertext:=.*Check Loan Status.*","index:=0").Exist(1)  Then
        FRM_Logger_ReportPassEvent "'Check Loan status' page", "User is on 'Check Loan status' page" , null 
    Else
        FRM_Logger_ReportFailEvent "'Check Loan status' page", "User is on 'Check Loan status' page", null 
    End If  
    Set objAccountPage = Nothing
    
End Function
 

 
'This function is used to to create document if not exists in environment for WebCenter tests. 
'@code
'    BIZ_WebCenter_CreateDocumentIfNotExists(strDocumentType,strDocName)
'@endcode 
'@param strDocumentType - document type
'@param  strDocName - document name

Function BIZ_WebCenter_CreateDocumentIfNotExists(strDocumentType,strDocName)
 
    FRM_Logger_ReportInfoEvent "Pre-conditions: Create Document if not exists", "Create Document: "& strDocName, null  
    BIZ_Settings_ExpandTreeView "eFolder Setup"
    BIZ_Nav_HierarchyTree "eFolder Setup", "Documents"
    Set objMainDocument = SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfWindow("swfname:=DocumentTemplateDialog")
    BIZ_Settings_Documents_ClickNew
    
    strDocumentName = BIZ_Settings_Documents_Create(strDocumentType) 
    GUI_SwfEdit_Set objMainDocument.SwfEdit("swfname:=txtName"),strDocName
    GUI_SwfComboBox_Select objMainDocument.SwfComboBox("swfname:=cboType"), strDocumentType
    If strDocumentType = "Standard Form" OR  strDocumentType = "Custom Form" Then
        GUI_SwfComboBox_Select objMainDocument.SwfComboBox("swfname:=cboSource"), 0
    End If
    GUI_SwfButton_Click objMainDocument.SwfButton("swfname:=btnOK")

    If objMainDocument.Dialog("index:=0").Static("text:=.*name has been used already.*","index:=0").Exist(5) Then
        objMainDocument.Dialog("index:=0").WinButton("text:=OK","index:=0").Click
        objMainDocument.SwfButton("swfname:=btnCancel").Click
    End If
    SwfWindow("swfname:=MainForm").SwfWindow("swfname:=SetUpContainer").SwfButton("swfname:=btnClose").Click
    Set objMainDocument = Nothing   
     
End Function   



'This function is used by a borrower to act on a doc
'@code
'    BIZ_WebCenter_BorrActOnDocumentInDetailPage(strDocSubject,strBorrName,strButton)
'@endcode 
'@param strDocSubject - string that reflects name/type of document to open. Could be subject of e-mail sent from Encompass
'@param  strBorrName - Borrower partial or full name to whom document should be opened
'@param strButton - expected button to click. eSign or Print

Function BIZ_WebCenter_BorrActOnDocumentInDetailPage(strDocSubject,strBorrName,strButton)
	
	FRM_Logger_ReportInfoEvent strDocSubject, "Open document" , null 
    On error resume next	
    boolBorrFound = False
    boolButtonFound = False
    Set objWebPage = Browser("name:=.*", "index:=0").Page("title:=.*", "index:=0")
    Set objTableProd = objWebPage.WebTable("class:=table_BottomLine","index:=0")
    Set objTableQA = objWebPage.WebTable("class:=loandetail-content","index:=0")
	boolBorrFound = False
    boolButtonFound = False
    If objTableQA.Exist(5) Then
	    Set objTable = objTableQA
		intRows = objTable.RowCount
		myHeadRow = 0
		myRow = 0
		strLinkText = ""
		boolExit = false
		For z = 1 To intRows  
            If Not z = 3 Then		
				intLinks = objTable.ChildItemCount(z,1,"Link") 
				For j = 0 to intLinks - 1
					strLinkText =  trim(objTable.ChildItem(z,1,"Link",j).GetROProperty("text")) 
					If trim(strLinkText) = strDocSubject Then
						If objWebPage.Image("class:=expandCollapseImage","file name:=loandetailexpand.png","index:=0").exist(2) Then
							objTable.ChildItem(z,1,"Link",j).click	
						End If
						myHeadRow = z
						FRM_Logger_ReportInfoEvent "Clicked Link", strDocSubject,null 
						boolExit = true
						Exit For
					End If
				Next 
			End If	
			If boolexit Then
				Exit For	
			End If        
		Next
		boolExit = False
		For p = myHeadRow To intRows 
			intWebElements = objTable.ChildItemCount(p,1,"WebElement") 
			
			For j = 0 to intWebElements	
				strWebElementText = objTable.ChildItem(p,1,"WebElement",j).GetROProperty("innertext")
				If myHeadRow > 0 and p > myHeadRow Then 
				   If instr(strWebElementText,strBorrName) > 0 Then        	
						boolBorrFound = True
						myRow = p
						boolExit = true
						Exit For
					End If
				 End If 
			 Next
			 If boolexit Then
				Exit For	
			 End If 
		 Next
		 intLinksinRow = objTable.ChildItemCount(myRow,1,"Link") 
		 For j = 0 To intLinksinRow
			 strLinkTextInRow =  trim(objTable.ChildItem(myRow,1,"Link",j).GetROProperty("text")) 
			 If trim(strLinkTextInRow) = strButton Then
						boolButtonFound = True
						objTable.ChildItem(myRow,1,"Link",j).click
						boolButtonFound = true
						Exit For
			  End If 
		  Next
	End If

    If objTableProd.Exist(5) Then
        Set objTable = objTableProd 
		intRows = objTable.RowCount
		myHeadRow = 0
		myRow = 0
		strLinkText = ""
		For z = 1 To intRows
		    If Not z = 3 Then
				intLinks = objTable.ChildItemCount(z,1,"Link")         
				For j = 0 to intLinks - 1
					strLinkText =  trim(objTable.ChildItem(z,1,"Link",j).GetROProperty("text"))  
					If trim(strLinkText) = strDocSubject Then
						objTable.ChildItem(z,1,"Link",j).click
						myHeadRow = z
						FRM_Logger_ReportInfoEvent "Clicked Link", strDocSubject,null 
					End If 
					
					If myHeadRow > 0 and z >= myHeadRow Then         
						If instr(strLinkText,strBorrName) > 0 Then
							boolBorrFound = True
							objTable.ChildItem(z,1,"Link",j).click 
							myRow = z
						End If 
						If trim(strLinkText) = strButton and z = myRow Then
							boolButtonFound = True
							objTable.ChildItem(z,1,"Link",j).click
							Exit For
						End If 
					End If  
             					
				Next
			End If	
			If boolBorrFound Then
				Exit For    
			End If 
		Next
	End If	
    If boolBorrFound Then
        FRM_Logger_ReportPassEvent "Expected Borrower Found to open document", strBorrName,null     
    Else
        FRM_Logger_ReportFailEvent "Expected Borrower NOT Found to open document", strBorrName,null
    End If
    If boolButtonFound Then
        FRM_Logger_ReportPassEvent "Expected Button Found and clicked", strButton,null  
    Else
        FRM_Logger_ReportFailEvent "Expected Button NOT Found", strButton & "- reasons could be: wrong page dispalyed; wrong borrower name in a section is displayed, etc" ,null 
    End If
    Set objWebPage = Nothing
    Set objTable = Nothing
    Set objTableProd = Nothing
	Set objTableQA = Nothing
 End Function
 
 
 
'This function is used by a borrower to eSign a doc. 
'@code 
'   BIZ_WebCenter_BorrESignDocumentInDetailPage(strDocSubject,strBorrName)
'@endcode 

Function BIZ_WebCenter_BorrESignDocumentInDetailPage(strDocSubject,strBorrName)

	BIZ_WebCenter_BorrActOnDocumentInDetailPage strDocSubject,strBorrName, "eSign"
	
End Function



'This function is used to verify if webelement or link exists in the table for any borrower
'@code
'    BIZ_Webcenter_VerifyIfObjectExistsForBorrower(strDocSubject,strBorrName,strObjectTextProperty, strObjClass, isExpected)
'@endcode 
'@param strDocSubject - string that reflects name/type of document to open. Could be subject of e-mail sent from Encompass
'@param  strBorrName - Borrower partial or full name to whom document should be opened
'@param strObjectTextProperty - text to find and compare
'@param strButton - expected button/webelement/link to click

Function BIZ_Webcenter_VerifyIfObjectExistsForBorrower(strDocSubject,strBorrName,strObjectTextProperty, strObjClass, isExpected)
    
	On Error Resume Next	
	FRM_Logger_ReportInfoEvent strDocSubject, "Confirm " & strObjClass & " exists for Borrower " & strBorrName , null  
    boolBorrFound = False
    boolObjFound = False
	Set objWebPage = Browser("name:=.*", "index:=0").Page("title:=.*", "index:=0")
	Set objTableProd = objWebPage.WebTable("class:=table_BottomLine","index:=0")
    Set objTableQA = objWebPage.WebTable("class:=loandetail-content","index:=0")
	
    If objTableQA.Exist(5) Then 

		Set objTable = objTableQA
		intRows = objTable.RowCount
		myHeadRow = 0
		myRow = 0
		boolExit = false   
		For z = 1 To intRows
		    If NOT z = 3 Then
				intLinks = objTable.ChildItemCount(z,1,"Link")	 
				For j = 0 to intLinks - 1
				   strLinkText =  trim(objTable.ChildItem(z,1,"Link",j).GetROProperty("text"))
				   If trim(strLinkText) = strDocSubject Then
					  objTable.ChildItem(z,1,"Link",j).click
					  myHeadRow = z
					  boolExit = true
					  FRM_Logger_ReportInfoEvent "Clicked Link", strDocSubject,null 
					  Exit for
				   End If	
				 Next
			End If	 
			If boolExit Then
				Exit for
			End If
		Next	

		 boolExit = False
		 For p = myHeadRow To intRows 
				intWebElements = objTable.ChildItemCount(p,1,"WebElement") 		
				For j = 0 to intWebElements
						strWebElementText = objTable.ChildItem(p,1,"WebElement",j).GetROProperty("innertext")
								 
					If myHeadRow > 0 and p > myHeadRow Then 
					   If instr(strWebElementText,strBorrName) > 0 Then        	
							boolBorrFound = True
							myRow = p
							boolExit = true
							Exit For
						End If
					 End If 
				 Next
				 If boolexit Then
					Exit For	
				 End If 
			Next
		   
		intObjects = objTable.ChildItemCount(myRow,1,strObjClass)	
		For j = 0 to intObjects - 1
			 strObjText = trim(objTable.ChildItem(myRow,1,strObjClass,j).GetROProperty("innertext")) 
			 If trim(strObjText) = strObjectTextProperty then
					 boolObjFound = True
					 Exit For
			 End If
		Next
	End If
	
	
    If objTableProd.Exist(5) Then 
		Set objTable = objTableProd	
	
		intRows = objTable.RowCount
		myHeadRow = 0
		myRow = 0
		   
		For z = 1 To intRows
		    If NOT z = 3 Then
				intLinks = objTable.ChildItemCount(z,1,"Link")	 
				For j = 0 to intLinks - 1
				   strLinkText =  trim(objTable.ChildItem(z,1,"Link",j).GetROProperty("text"))
				   If trim(strLinkText) = strDocSubject Then
					  objTable.ChildItem(z,1,"Link",j).click
					  myHeadRow = z
					  FRM_Logger_ReportInfoEvent "Clicked Link", strDocSubject,null 
				   End If	
				   If myHeadRow > 0 and z >= myHeadRow Then
					 If instr(strLinkText,strBorrName) > 0 Then
						  boolBorrFound = True
						  objTable.ChildItem(z,1,"Link",j).click 
						  myRow = z
						  Exit For
					 End If 
				   End If 	          
				Next
			End If	
			If boolBorrFound then
			   Exit For
			End If
		Next
		   
		intObjects = objTable.ChildItemCount(myRow,1,strObjClass)	
		For j = 0 to intObjects - 1
			 strObjText = trim(objTable.ChildItem(myRow,1,strObjClass,j).GetROProperty("innertext")) 
			 If trim(strObjText) = strObjectTextProperty then
					 boolObjFound = True
					 Exit For
			 End If
		Next
	End If
	If boolBorrFound Then
		FRM_Logger_ReportPassEvent "Expected Borrower Found to open document", strBorrName,null 	
	Else
	    FRM_Logger_ReportFailEvent "Expected Borrower NOT Found to open document", strBorrName,null
	End If
	If isExpected Then
		If boolObjFound Then
			FRM_Logger_ReportPassEvent "Expected " & strObjClass & " Found", strObjectTextProperty,null 	
		Else
			FRM_Logger_ReportFailEvent "Expected " & strObjClass & " NOT Found", strObjectTextProperty,null 
		End If
	Else
		If boolObjFound Then
			FRM_Logger_ReportFailEvent "Not Expected " & strObjClass & " Found", strObjectTextProperty,null 	
		Else
			FRM_Logger_ReportPassEvent "Not Expected " & strObjClass & " NOT Found", strObjectTextProperty,null 
		End If
    End If	
	BIZ_Webcenter_VerifyIfObjectExistsForBorrower = boolObjFound
        Set objWebPage = Nothing
	Set objTable = Nothing
	Set objTableProd = Nothing
    Set objTableQA = Nothing
 End Function

 
'To setup environment before starting test
Function BIZ_WebCenter_Setup()
	FRM_RT_SetupTest(null)
	'GUI_Browser_CloseAll
	UTIL_Win_CloseProcesses "chrome.exe"
    UTIL_Win_CloseProcesses "iexplore.exe"
    UTIL_Win_CloseProcesses  "firefox.exe"
End Function	




Function BIZ_WebCenter_DocuSignSignDocument()
        FRM_Logger_ReportInfoEvent "eSign Document", "User is going to sign DocuSign document",null 
	    If Browser("name:=.*").Page("title:=.*").WebButton("html id:=action-bar-btn-continue","innertext:=Next","index:=0").Exist(20) Then
			Browser("name:=.*").Page("title:=.*").WebButton("html id:=action-bar-btn-continue","innertext:=Next","index:=0").Click
		End If
		If Browser("name:=.*").Page("title:=.*").WebButton("html id:=.*navnexttext.*","innertext:=START","index:=0").Exist(10) Then
			Browser("name:=.*").Page("title:=.*").WebButton("html id:=.*navnexttext.*","innertext:=START","index:=0").Click
		End If
			
		k = 0
		n = 0
		Do
'			If Browser("name:=.*").Page("title:=.*").Frame("html id:=signingIframe").Image("title:=Sign Here","index:=" & k).Exist(4) Then
'				Browser("name:=.*").Page("title:=.*").Frame("html id:=signingIframe").Image("title:=Sign Here","index:=" & k).Click
			If Browser("name:=.*").Page("title:=.*").WebButton("html id:=tab-form-element.*","innertext:=.*SignRequired - Sign Here.*").Exist(10) Then
				Browser("name:=.*").Page("title:=.*").WebButton("html id:=tab-form-element.*","innertext:=.*SignRequired - Sign Here.*").Click
				wait 3
				k = k + 1
			Else
                Exit Do	
			End If	

            If Browser("name:=.*").Page("title:=.*").WebButton("name:=ADOPT AND SIGN","index:=0").Exist(4) Then
            	Browser("name:=.*").Page("title:=.*").WebButton("name:=ADOPT AND SIGN","index:=0").Click
   			    wait 3	
            End If
			
			If Browser("name:=.*").Page("title:=.*").WebButton("html id:=action-bar-btn-finish","innertext:=Finish").Exist(10) Then	
				Browser("name:=.*").Page("title:=.*").WebButton("html id:=action-bar-btn-finish","innertext:=Finish").Click    
		        FRM_Logger_ReportPassEvent "eSign Document", "DocuSign Document Signed",null 
			Else
				If n > 13 then
					FRM_Logger_ReportFailEvent "eSign Document", "DocuSign Document NOT Signed",null 
                End If					
			End If	
		    n = n + 1
		    If n > 15  Then
		    	Exit do
		    End If
		Loop 
	
		
 

End Function

'@}
